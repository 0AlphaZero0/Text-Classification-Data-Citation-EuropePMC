<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4970815</article-id><article-id pub-id-type="pmid">27482905</article-id><article-id pub-id-type="publisher-id">PONE-D-15-39908</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0157338</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Database and Informatics Methods</subject><subj-group><subject>Biological Databases</subject><subj-group><subject>Sequence Databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Molecular Biology</subject><subj-group><subject>Molecular Biology Techniques</subject><subj-group><subject>Sequencing Techniques</subject><subj-group><subject>Sequence Analysis</subject><subj-group><subject>Sequence Databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Molecular Biology Techniques</subject><subj-group><subject>Sequencing Techniques</subject><subj-group><subject>Sequence Analysis</subject><subj-group><subject>Sequence Databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Database and Informatics Methods</subject><subj-group><subject>Database Searching</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive Science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and Memory</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Database and Informatics Methods</subject><subj-group><subject>Database Searching</subject><subj-group><subject>Sequence Similarity Searching</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>BLAST algorithm</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>BLAST algorithm</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Software-aided sequence analysis</subject><subj-group><subject>BLAST algorithm</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Computer Architecture</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Metagenomics</subject></subj-group></subj-group></subj-group></subj-group></article-categories><title-group><article-title><SecTag type="TITLE"><text><SENT sid="0" pm="."><plain>GPU-Acceleration of Sequence Homology Searches with Database Subsequence Clustering </plain></SENT>
</text></SecTag></article-title><alt-title alt-title-type="running-head">GPU-Acceleration of Sequence Homology Searches</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Suzuki</surname><given-names>Shuji</given-names></name><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="aff" rid="aff002"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Kakuta</surname><given-names>Masanori</given-names></name><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Ishida</surname><given-names>Takashi</given-names></name><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="aff" rid="aff002"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Akiyama</surname><given-names>Yutaka</given-names></name><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="aff" rid="aff002"><sup>2</sup></xref><xref ref-type="corresp" rid="cor001">*</xref></contrib></contrib-group><aff id="aff001">
<label>1</label>
<addr-line>Graduate School of Information Science and Engineering, Tokyo Institute of Technology, Meguro-ku, Tokyo, Japan</addr-line>
</aff><aff id="aff002">
<label>2</label>
<addr-line>Education Academy of Computational Life Sciences (ACLS), Tokyo Institute of Technology, Meguro-ku, Tokyo, Japan</addr-line>
</aff><contrib-group><contrib contrib-type="editor"><name><surname>von Haeseler</surname><given-names>Arndt</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">
<addr-line>Max F. Perutz Laboratories, AUSTRIA</addr-line>
</aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><text><SENT sid="1" pm="."><plain>Competing Interests: The authors have declared that no competing interests exist. </plain></SENT>
</text></p></fn><fn fn-type="con"><p><text><SENT sid="2" pm="."><plain>Conceived and designed the experiments: SS MK TI YA.Performed the experiments: SS.Analyzed the data: SS.Contributed reagents/materials/analysis tools: SS MK.Wrote the paper: SS MK TI YA. </plain></SENT>
</text></p></fn><corresp id="cor001">* E-mail: <email>akiyama@cs.titech.ac.jp</email></corresp></author-notes><pub-date pub-type="collection"><year>2016</year></pub-date><pub-date pub-type="epub"><day>2</day><month>8</month><year>2016</year></pub-date><volume>11</volume><issue>8</issue><elocation-id>e0157338</elocation-id><history><date date-type="received"><day>9</day><month>9</month><year>2015</year></date><date date-type="accepted"><day>27</day><month>5</month><year>2016</year></date></history><permissions><copyright-statement>© 2016 Suzuki et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Suzuki et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0157338.pdf"/><abstract><p><SecTag type="ABS"><text><SENT sid="3" pm="."><plain>Sequence homology searches are used in various fields and require large amounts of computation time, especially for metagenomic analysis, owing to the large number of queries and the database size. </plain></SENT>
<SENT sid="4" pm="."><plain>To accelerate computing analyses, graphics processing units (GPUs) are widely used as a low-cost, high-performance computing platform. </plain></SENT>
<SENT sid="5" pm="."><plain>Therefore, we mapped the time-consuming steps involved in GHOSTZ, which is a state-of-the-art homology search algorithm for protein sequences, onto a GPU and implemented it as GHOSTZ-GPU. </plain></SENT>
<SENT sid="6" pm="."><plain>In addition, we optimized memory access for GPU calculations and for communication between the CPU and GPU. </plain></SENT>
<SENT sid="7" pm="."><plain>As per results of the evaluation test involving metagenomic data, GHOSTZ-GPU with 12 CPU threads and 1 GPU was approximately 3.0- to 4.1-fold faster than GHOSTZ with 12 CPU threads. </plain></SENT>
<SENT sid="8" pm="."><plain>Moreover, GHOSTZ-GPU with 12 CPU threads and 3 GPUs was approximately 5.8- to 7.7-fold faster than GHOSTZ with 12 CPU threads. </plain></SENT>
</text></SecTag></p></abstract><funding-group><award-group id="award001"><funding-source><institution-wrap><institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001691</institution-id><institution>Japan Society for the Promotion of Science</institution></institution-wrap></funding-source><award-id>248766</award-id><principal-award-recipient><name><surname>Suzuki</surname><given-names>Shuji</given-names></name></principal-award-recipient></award-group><award-group id="award002"><funding-source><institution>MEXT SPIRE Supercomputational Life Science</institution></funding-source><principal-award-recipient><name><surname>Akiyama</surname><given-names>Yutaka</given-names></name></principal-award-recipient></award-group><award-group id="award003"><funding-source><institution>National Cancer Center</institution></funding-source><principal-award-recipient><name><surname>Akiyama</surname><given-names>Yutaka</given-names></name></principal-award-recipient></award-group><funding-statement>This work was supported by a Grant-in-Aid for the Japan Society for the Promotion of Science Fellows (Grant number 248766) to SS, the Strategic Programs for Innovative Research Field 1 Supercomputational Life Science of the Ministry of Education, Culture, Sports, Science and Technology of Japan to YA, and Cancer Research Development funding from the National Cancer Center of Japan to YA.</funding-statement></funding-group><counts><fig-count count="13"/><table-count count="5"/><page-count count="22"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>Sequencing data of soil metagenome and marine metagenome are available from International Nucleotide Sequence Database Collaboration partners (DDBJ (<ext-link ext-link-type="uri" xlink:href="http://www.ddbj.nig.ac.jp/">http://www.ddbj.nig.ac.jp/</ext-link>), EMBL-EBI (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/">https://www.ebi.ac.uk/</ext-link>), and NCBI (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/)">http://www.ncbi.nlm.nih.gov/)</ext-link>) with accession numbers SRR407548 and ERR315856. Sequencing data of human metagenome is available from HMP-DACC (<ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/">http://hmpdacc.org/</ext-link>) with accession number SRS011098.</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>Sequencing data of soil metagenome and marine metagenome are available from International Nucleotide Sequence Database Collaboration partners (DDBJ (<ext-link ext-link-type="uri" xlink:href="http://www.ddbj.nig.ac.jp/">http://www.ddbj.nig.ac.jp/</ext-link>), EMBL-EBI (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/">https://www.ebi.ac.uk/</ext-link>), and NCBI (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/)">http://www.ncbi.nlm.nih.gov/)</ext-link>) with accession numbers SRR407548 and ERR315856. Sequencing data of human metagenome is available from HMP-DACC (<ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/">http://hmpdacc.org/</ext-link>) with accession number SRS011098.</p></notes></front><body><SecTag type="INTRO"><sec sec-type="intro" id="sec001"><title><text><SENT sid="9" pm="."><plain>Introduction </plain></SENT>
</text></title><p><text><SENT sid="10" pm="."><plain>Sequence homology search is widely used in bioinformatics. </plain></SENT>
<SENT sid="11" pm="."><plain>This method is needed to identify evolutionary relations among sequences. </plain></SENT>
<SENT sid="12" pm="."><plain>It can also be used to estimate possible functions and structures of DNA and proteins. </plain></SENT>
<SENT sid="13" pm="."><plain>Nonetheless, sequence homology searches have become a major bottleneck of such analyses, especially metagenomic analyses, because of the increasing number of queries and database size. </plain></SENT>
</text></p><p><text><SENT sid="14" pm="."><plain>In a metagenomic analysis, environmental samples frequently include DNA sequences from several species, and the reference database often does not contain closely related homologous sequences. </plain></SENT>
<SENT sid="15" pm="."><plain>Therefore, a sequence homology search is used to identify novel genes in these samples. </plain></SENT>
<SENT sid="16" pm="."><plain>In a typical metagenomic analysis, reads are translated into protein-coding sequences and assigned to protein families by means of a homology search in publicly available databases such as the Kyoto Encyclopedia of Genes and Genomes (KEGG) [1, 2], COG [3, 4] and Pfam [5]. </plain></SENT>
<SENT sid="17" pm="."><plain>The BLASTX software [6, 7] is commonly used for such binning and classification searches. </plain></SENT>
<SENT sid="18" pm="."><plain>To identify homologs that may not have high identity of nucleotide sequences, BLASTX translates nucleotide sequences into protein sequences because such sequences are often more similar than the original nucleotide sequences [8, 9]. </plain></SENT>
<SENT sid="19" pm="."><plain>Nonetheless, the search speed of BLASTX is insufficient for analysis of large quantities of sequence data now available. </plain></SENT>
<SENT sid="20" pm="."><plain>For instance, sequence homology searches for metagenomic data produced by HiSeq2500, which is one of the latest DNA sequencers, require approximately 100,000 days with BLASTX on a single workstation containing 12 CPU cores. </plain></SENT>
</text></p><p><text><SENT sid="21" pm="."><plain>Developers of several homology search tools currently available, such as RAPSearch [10, 11], GHOSTX [12], GHOSTZ [13], and DIAMOND[14], claim that their tools search faster than BLASTX, without a significant decrease in search sensitivity. </plain></SENT>
<SENT sid="22" pm="."><plain>GHOSTZ is one of the fastest homology search tools. </plain></SENT>
<SENT sid="23" pm="."><plain>It uses the database subsequence clustering method. </plain></SENT>
<SENT sid="24" pm="."><plain>This method clusters similar subsequences from a database to perform an efficient seed search and ungapped extension by reducing the number of alignment candidates on the basis of triangle inequality. </plain></SENT>
<SENT sid="25" pm="."><plain>GHOSTZ achieved a 2-fold increase in speed, without a substantial decrease in search sensitivity, as compared to GHOSTZ without the database subsequence clustering method. </plain></SENT>
<SENT sid="26" pm="."><plain>Originally, GHOSTZ was approximately 2.2–2.8 times faster than RAPSearch and approximately 185–261 times faster than BLASTX. </plain></SENT>
<SENT sid="27" pm="."><plain>Nevertheless, the sequencing technology has since improved and bigger sequence data can now be obtained. </plain></SENT>
<SENT sid="28" pm="."><plain>Therefore, the speed of homology searches needs a further increase to facilitate efficient metagenomic analysis. </plain></SENT>
</text></p><p><text><SENT sid="29" pm="."><plain>To accelerate computing analyses, graphics processing units (GPUs) are widely used as a low-cost high-performance computing platform. </plain></SENT>
<SENT sid="30" pm="."><plain>Among top-level supercomputers worldwide, several systems incorporate multiple CPU cores and GPUs within a node, as in TSUBAME 2.5 of the Tokyo Institute of Technology. </plain></SENT>
<SENT sid="31" pm="."><plain>GPUs have greater computational power and memory bandwidth than CPUs do. </plain></SENT>
<SENT sid="32" pm="."><plain>Recently, several bioinformatic tools have been enhanced by means of GPUs [15–17]. </plain></SENT>
</text></p><p><text><SENT sid="33" pm="."><plain>Several tools for sequence homology searches on the basis of GPUs have also been developed. </plain></SENT>
<SENT sid="34" pm="."><plain>They are roughly classified into 2 types: implementation of the Smith-Waterman algorithm [18] and a seed-and-extend algorithm such as BLAST. </plain></SENT>
<SENT sid="35" pm="."><plain>GPU accelerated Smith-Waterman algorithms [19–21] and seed-and-extend algorithms for DNA sequences [22, 23] were several times faster than those of implementation for CPU with multiple CPU cores. </plain></SENT>
<SENT sid="36" pm="."><plain>SW#db [20] is one of the GPU-based Smith-Waterman algorithms, and showed that when it is based on 1 GPU, it works 4- to 5-fold faster than does SSEARCH [24], which is a CPU-based Smith-Waterman algorithm, with 4 CPU cores. </plain></SENT>
<SENT sid="37" pm="."><plain>G-BLASTN [22] is one of the GPU-based BLAST with 1 GPU achieves 7.2-fold acceleration relative to the MEGABLAST mode of NCBI-BLAST [25] with 4 CPU cores and 1.6-fold acceleration relative to the BLASTN mode of NCBI-BLAST with 4 CPU cores. </plain></SENT>
<SENT sid="38" pm="."><plain>On the other hand, GPU accelerated seed-and-extend algorithms for protein sequences, such as GPU-BLAST [26] and CUDA-BLASTP[27], achieved limited success. </plain></SENT>
<SENT sid="39" pm="."><plain>GPU-BLAST [26] and CUDA-BLASTP[27] with 1 GPU achieve 6-fold and 5- to 6-fold acceleration, respectively, relative to the BLASTP mode of NCBI-BLAST with a single CPU core. </plain></SENT>
<SENT sid="40" pm="."><plain>These results mean that the acceleration of GPU-BLAST or CUDA-BLASTP with 1 GPU is estimated to be less than 1.5-fold as compared to NCBI-BLAST with a single CPU socket with 4 CPU cores. </plain></SENT>
<SENT sid="41" pm="."><plain>Therefore, mapping an algorithm of a protein sequence homology search onto GPUs is still a challenging task. </plain></SENT>
<SENT sid="42" pm="."><plain>In addition, faster algorithms of protein sequence homology searches than BLAST have not yet been mapped onto GPUs. </plain></SENT>
</text></p><p><text><SENT sid="43" pm="."><plain>In this study, we mapped the GHOSTZ algorithm onto GPUs to accelerate sequence homology searches. </plain></SENT>
<SENT sid="44" pm="."><plain>This task was more challenging than GPU implementation of BLASTX because GHOSTZ is faster than BLASTX. </plain></SENT>
<SENT sid="45" pm="."><plain>We introduced several speed-up methods in addition to simple GPU mapping of the algorithm. </plain></SENT>
<SENT sid="46" pm="."><plain>To accelerate a sequence homology search on GPUs, we optimized access of the data in the GPU memory. </plain></SENT>
<SENT sid="47" pm="."><plain>Moreover, we reduced the waiting time for synchronization to attain full use of a computing environment by setting up GHOSTZ-GPU to reduce inactive threads in gapped extension and to use asynchronous execution on CPU and GPU. </plain></SENT>
<SENT sid="48" pm="."><plain>GHOSTZ-GPU was implemented in C++ and CUDA 6.0. </plain></SENT>
<SENT sid="49" pm="."><plain>It is distributed under the BSD 2-clause license and is available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/akiyamalab/ghostz-gpu">https://github.com/akiyamalab/ghostz-gpu</ext-link>. </plain></SENT>
</text></p></sec></SecTag><SecTag type="METHODS"><sec sec-type="materials|methods" id="sec002"><title><text><SENT sid="50" pm="."><plain>Methods </plain></SENT>
</text></title><sec id="sec003"><title><text><SENT sid="51" pm="."><plain>GHOSTZ </plain></SENT>
</text></title><p><text><SENT sid="52" pm="."><plain>The workflow of GHOSTZ is shown in Fig 1. </plain></SENT>
<SENT sid="53" pm="."><plain>The GHOSTZ protocol consists of 5 main steps: seed search, similarity filtering, ungapped extension, chain filtering, and gapped extension. </plain></SENT>
<SENT sid="54" pm="."><plain>To accelerate the sequence homology search with the GHOSTZ algorithm, subsequences are extracted from database sequences and similar subsequences are clustered during preprocessing for the sequence homology search. </plain></SENT>
<SENT sid="55" pm="."><plain>Subsequently, hash tables are constructed containing indexes for the subsequences within database sequences. </plain></SENT>
<SENT sid="56" pm="."><plain>GHOSTZ uses the hash tables to select seeds for the alignments from representative sequences in the clusters. </plain></SENT>
<SENT sid="57" pm="."><plain>In the sequence homology search, the seed search process selects seeds that are subsequences of database sequences similar to those of the query sequence. </plain></SENT>
<SENT sid="58" pm="."><plain>Similarity filtering is then performed to reduce the number of seeds, whereby the distance between a query subsequence and the cluster representative is calculated, and the lower bounds of the distance between the query subsequence and other members of the cluster are computed on the basis of triangle inequality. </plain></SENT>
<SENT sid="59" pm="."><plain>If the computed lower bound is lower than or equal to the distance threshold, then the seed is taken to the next step, that is, the ungapped extension, to assess the homology between the query and the member sequences of the cluster. </plain></SENT>
<SENT sid="60" pm="."><plain>Finally, chain filtering is used to bring similar extended seeds together, and gapped extension is performed to obtain an alignment from the extended seed that contains gaps. </plain></SENT>
</text></p><SecTag type="FIG"><fig id="pone.0157338.g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0157338.g001</object-id><label>Fig 1</label><caption><title><text><SENT sid="61" pm="."><plain>The workflow of GHOSTZ. </plain></SENT>
</text></title></caption><graphic xlink:href="pone.0157338.g001"/></fig></SecTag><p><text><SENT sid="62" pm="."><plain>The GHOSTZ system has several limitations. Table 1 shows the ratio of calculation time for each step of GHOSTZ. </plain></SENT>
<SENT sid="63" pm="."><plain>The ungapped-extension step requires most (44.3%) of the total calculation time. </plain></SENT>
<SENT sid="64" pm="."><plain>Nonetheless, mapping of an ungapped extension onto GPUs by itself is insufficient for improvement of the search speed. </plain></SENT>
<SENT sid="65" pm="."><plain>This is because other calculations also require considerable time, for example, gapped extension and the distance calculation, which is a subprocess of similarity filtering. </plain></SENT>
</text></p><SecTag type="TABLE"></SecTag></sec></sec></SecTag><SecTag type="DISCUSS"><sec sec-type="conclusions" id="sec017"><title><text><SENT sid="462" pm="."><plain>Discussion </plain></SENT>
</text></title><p><text><SENT sid="463" pm="."><plain>In this study, we mapped distance calculation, ungapped extension, and gapped extension of GHOSTZ onto a GPU. </plain></SENT>
<SENT sid="464" pm="."><plain>GHOSTZ-GPU with 2 GPUs is approximately 6 times faster than GHOSTZ with 2 CPU sockets. </plain></SENT>
<SENT sid="465" pm="."><plain>The accelerated GPU-BLAST and CUDA-BLASTP with 1 GPU are estimated to be equivalent to twice NCBI-BLAST with a single CPU socket or less [26, 27]. </plain></SENT>
<SENT sid="466" pm="."><plain>Therefore, GHOSTZ-GPU showed a greater increase in speed than GPU-based BLAST tools. </plain></SENT>
<SENT sid="467" pm="."><plain>One of the reasons for acceleration of calculations with GPUs is the use of seed search in GHOSTZ. </plain></SENT>
<SENT sid="468" pm="."><plain>BLAST searches consist of 3 main steps: a seed search, ungapped extension, and gapped extension; the bottleneck in BLAST is the seed search. </plain></SENT>
<SENT sid="469" pm="."><plain>Therefore, the seed search is mapped onto a GPU in these tools. </plain></SENT>
<SENT sid="470" pm="."><plain>On the other hand, a seed search in BLAST requires several random memory accesses. </plain></SENT>
<SENT sid="471" pm="."><plain>Random memory access decreases computing speed on a GPU. </plain></SENT>
<SENT sid="472" pm="."><plain>Accordingly, this step does not utilize sufficient computing resources of GPUs. </plain></SENT>
<SENT sid="473" pm="."><plain>A seed search by means of other tools also requires random memory access. </plain></SENT>
<SENT sid="474" pm="."><plain>In contrast, in GHOSTZ, a seed search does not take much computation time, and GHSOTZ is one of the fastest tools for searches for protein sequence homology. </plain></SENT>
<SENT sid="475" pm="."><plain>Thus, GHOSTZ-GPU showed a significant increase in speed. </plain></SENT>
<SENT sid="476" pm="."><plain>If we run a distance calculation, ungapped extension, and gapped extension in GHOSTZ on GPUs, the remaining steps become new bottlenecks. </plain></SENT>
<SENT sid="477" pm="."><plain>For a CPU calculation in GHOSTZ-GPU, the most time-consuming step is the seed search. </plain></SENT>
<SENT sid="478" pm="."><plain>Nonetheless, this step overlaps with distance calculation and ungapped extension on GPUs. </plain></SENT>
<SENT sid="479" pm="."><plain>Therefore, the true computation time of the seed search was hidden by that of distance calculation and of ungapped extension on GPUs. </plain></SENT>
<SENT sid="480" pm="."><plain>Nevertheless, the file I/O in a database accounts for a greater fraction of the computing time for GHOSTZ-GPU. </plain></SENT>
<SENT sid="481" pm="."><plain>Therefore, GHOSTZ-GPU should be executed with a large amount of queries concurrently to optimize the performance. </plain></SENT>
<SENT sid="482" pm="."><plain>On the other hand, a greater amount of memory is required than that for execution of a small number of queries. </plain></SENT>
<SENT sid="483" pm="."><plain>When we used 1,000,000 randomly selected short DNA reads from SRR407548 and the KEGG GENES database, GHOSTZ-GPU required approximately 50 GB of CPU memory for the homology search proper. </plain></SENT>
<SENT sid="484" pm="."><plain>Thus, the memory size of current typical computing systems may be insufficient for GHOSTZ-GPU. </plain></SENT>
<SENT sid="485" pm="."><plain>For instance, a node in Titan, which is a supercomputer at the Oak Ridge National Laboratory, has only 32 GB of memory. </plain></SENT>
<SENT sid="486" pm="."><plain>Therefore, big query data cannot be analyzed by GHOSTZ-GPU at once on this computing system. </plain></SENT>
<SENT sid="487" pm="."><plain>On the other hand, computer systems with larger memory, e.g., TSUBAME 2.5, are under development and the memory size is increasing. </plain></SENT>
<SENT sid="488" pm="."><plain>Therefore, GHOSTZ-GPU should soon be available in common computing environments. </plain></SENT>
</text></p><p><text><SENT sid="489" pm="."><plain>GHOSTZ-GPU is developed for homology search of metagenome short reads, but it would be more valuable if it can be used for general protein sequence homology search. </plain></SENT>
<SENT sid="490" pm="."><plain>To check the point, we compared the sensitivity of GHOSTZ-GPU, RAPSearch, DIAMOND to BLASTP mode of NCBI-BLAST (2.2.28+) using proteins sequences as queries. </plain></SENT>
<SENT sid="491" pm="."><plain>We employed a method used in a research by Boratyn et al. [20] to evaluate the performance of remote homologue detection of sequence homology search tools. </plain></SENT>
<SENT sid="492" pm="."><plain>We used ASTRAL40 subset (version 2.06) [29] of the Structural Classification of Proteins (SCOP) [30] database in this evaluation. S1 Fig shows the curves denoting the number of true positives vs. the number of false positives for each tool. </plain></SENT>
<SENT sid="493" pm="."><plain>The performances of all metagenome homology search tools, GHOSTZ-GPU, RAPSearch and DIAMOND, are clearly less than that of BLAST in general protein sequence homology search, while the tools are much faster than BLAST and has enough search sensitivity for metagenome short reads. </plain></SENT>
<SENT sid="494" pm="."><plain>The lower search sensitivity of those tools would mainly come from the longer seed length than BLAST. </plain></SENT>
<SENT sid="495" pm="."><plain>The results indicate that the search sensitivity of GHOSTZ-GPU is insufficient for remote homologue detection, and thus the use of GHOSTZ-GPU is limited in homology search of general protein sequences. </plain></SENT>
</text></p><p><text><SENT sid="496" pm="."><plain>In summary, we developed a GPU version of GHOSTZ, which is the fastest tool for searches for protein sequence homology. </plain></SENT>
<SENT sid="497" pm="."><plain>Several calculations, distance calculation, ungapped extension, and gapped extension, are bottlenecks in GHOSTZ. </plain></SENT>
<SENT sid="498" pm="."><plain>We mapped these processes onto GPUs and optimized memory access in the GPU calculation. </plain></SENT>
<SENT sid="499" pm="."><plain>GHOSTZ-GPU with 12 CPU threads and 1 GPU retains sufficient search sensitivity for practical analyses and is 3.0–4.1 times faster than GHOSTZ with 12 CPU threads. </plain></SENT>
<SENT sid="500" pm="."><plain>Moreover, GHOSTZ-GPU with 12 CPU threads and 3 GPUs maintains sufficient search sensitivity for practical analyses and is 5.8–7.7 times faster than GHOSTZ with 12 CPU threads. </plain></SENT>
<SENT sid="501" pm="."><plain>GHOSTZ-GPU on 12 CPU cores and 3 GPUs is estimated to achieve an 1073- to 2010-fold increase in processing speed relative to BLASTX on 12 CPU cores because GHOSTZ was estimated to be approximately 185- to 261-fold faster than BLASTX. </plain></SENT>
<SENT sid="502" pm="."><plain>If we use GHOSTZ-GPU to analyze the data produced by HiSeq2500 and stored in the KEGG GENES database and approximately 50–100 nodes on TSUBAME 2.5 in metagenomic analysis, the required time is estimated to be only 1 day. </plain></SENT>
<SENT sid="503" pm="."><plain>On the basis of these estimates, we could perform metagenomic analysis of all data produced by the latest DNA sequencer in real time. </plain></SENT>
<SENT sid="504" pm="."><plain>At present, the sequencing technology continues to be improved, and the size of sequence data is on the rise. </plain></SENT>
<SENT sid="505" pm="."><plain>GHOSTZ-GPU and computers with GPUs could be a suitable alternative. </plain></SENT>
</text></p></sec></SecTag><SecTag type="SUPPL"><sec sec-type="supplementary-material" id="sec018"><title><text><SENT sid="506" pm="."><plain>Supporting Information </plain></SENT>
</text></title><supplementary-material content-type="local-data" id="pone.0157338.s001"><label>S1 Fig</label><caption><title><text><SENT sid="507" pm="."><plain>Number of true positives vs number of false positives for different search methods on the ASTRAL. </plain></SENT>
</text></title><p><text><SENT sid="508" pm="."><plain>The query set was created by sorting the SCOP domains in a lexicographic order and selecting even numbered sequences without queries that are the sole member of the superfamily in ASTRAL 40. </plain></SENT>
<SENT sid="509" pm="."><plain>In the evaluation, self-hits were ignored. </plain></SENT>
<SENT sid="510" pm="."><plain>If a hit of a search belongs to the same SCOP superfamily of the query, it was considered as a true positive. </plain></SENT>
<SENT sid="511" pm="."><plain>And if a hit belongs to the different SCOP fold of the query, it was considered as a false positive. </plain></SENT>
<SENT sid="512" pm="."><plain>The gapped extension of GHOSTZ-GPU was performed on CPU because gapped extension of GHOSTZ-GPU is designed for short sequence and the size of GPU memory is insufficient for sequences in ASTRAL 40. </plain></SENT>
</text></p><p><text><SENT sid="513" pm="."><plain>(PDF) </plain></SENT>
</text></p></caption><media xlink:href="pone.0157338.s001.pdf"><caption><p><text><SENT sid="514" pm="."><plain>Click here for additional data file. </plain></SENT>
</text></p></caption></media></supplementary-material></sec></SecTag></body><back><SecTag type="ACK_FUND"><ack><p><text4fund><text><SENT sid="515" pm="."><plain>The authors thank Prof. </plain></SENT>
<SENT sid="516" pm="."><plain>Ken Kurokawa and Dr. Takuji Yamada for their helpful discussion on metagenomic analysis. </plain></SENT>
<SENT sid="517" pm="."><plain>The authors also thank Mr. </plain></SENT>
<SENT sid="518" pm="."><plain>Brent Oster, Mr. </plain></SENT>
<SENT sid="519" pm="."><plain>Marc Hamilton, Mr. </plain></SENT>
<SENT sid="520" pm="."><plain>Mark Berger, Mr. </plain></SENT>
<SENT sid="521" pm="."><plain>Nuno Subtil, Mr. </plain></SENT>
<SENT sid="522" pm="."><plain>Jonathan Cohen, and Mr. </plain></SENT>
<SENT sid="523" pm="."><plain>Jacopo Pantaleoni at NVIDIA Corporation for providing us with an excellent research environment, insightful comments, and suggestions for this study. </plain></SENT>
</text></text4fund></p></ack></SecTag><SecTag type="REF"><ref-list><title>References</title><ref id="pone.0157338.ref001"><text><SENT sid="524" pm="."><plain>1 KanehisaM, GotoS. KEGG: Kyoto Encyclopedia of Genes and Genomes. Nucleic Acids Research. 2000;28(1):27–30. 10.1093/nar/28.1.27 <?supplied-pmid 10592173?>10592173 </plain></SENT>
</text></ref><ref id="pone.0157338.ref002"><text><SENT sid="525" pm="."><plain>2 KanehisaM, GotoS, SatoY, FurumichiM, TanabeM. KEGG for integration and interpretation of large-scale molecular data sets. Nucleic Acids Research. 2012;40(D1):D109–D114. 10.1093/nar/gkr988 <?supplied-pmid 22080510?>22080510 </plain></SENT>
</text></ref><ref id="pone.0157338.ref003"><text><SENT sid="526" pm="."><plain>3 TatusovRL, KooninEV, LipmanDJ. A Genomic Perspective on Protein Families. Science. 1997;278(5338):631–637. 10.1126/science.278.5338.631 <?supplied-pmid 9381173?>9381173 </plain></SENT>
</text></ref><ref id="pone.0157338.ref004"><text><SENT sid="527" pm="."><plain>4 TatusovR, FedorovaN, JacksonJ, JacobsA, KiryutinB, KooninE, et al The COG database: an updated version includes eukaryotes. BMC Bioinformatics. 2003;4(1):41 10.1186/1471-2105-4-41 <?supplied-pmid 12969510?>12969510 </plain></SENT>
</text></ref><ref id="pone.0157338.ref005"><text><SENT sid="528" pm="."><plain>5 FinnRD, MistryJ, TateJ, CoggillP, HegerA, PollingtonJE, et al The Pfam protein families database. Nucleic Acids Research. 2010;38(suppl 1):D211–D222. 10.1093/nar/gkp985 <?supplied-pmid 19920124?>19920124 </plain></SENT>
</text></ref><ref id="pone.0157338.ref006"><text><SENT sid="529" pm="."><plain>6 AltschulSF, GishW, MillerW, MyersEW, LipmanDJ. Basic local alignment search tool. Journal of Molecular Biology. 1990;215(3):403–410. 10.1016/S0022-2836(05)80360-2 <?supplied-pmid 2231712?>2231712 </plain></SENT>
</text></ref><ref id="pone.0157338.ref007"><text><SENT sid="530" pm="."><plain>7 AltschulSF, MaddenTL, SchäfferAA, ZhangJ, ZhangZ, MillerW, et al Gapped BLAST and PSI-BLAST: a new generation of protein database search programs. Nucleic Acids Research. 1997;25(17):3389–3402. 10.1093/nar/25.17.3389 <?supplied-pmid 9254694?>9254694 </plain></SENT>
</text></ref><ref id="pone.0157338.ref008"><text><SENT sid="531" pm="."><plain>8 TurnbaughPJ, LeyRE, MahowaldMA, MagriniV, MardisER, GordonJI. An obesity-associated gut microbiome with increased capacity for energy harvest. Nature. 2006;444(7122):1027–131. 10.1038/nature05414 <?supplied-pmid 17183312?>17183312 </plain></SENT>
</text></ref><ref id="pone.0157338.ref009"><text><SENT sid="532" pm="."><plain>9 KurokawaK, ItohT, KuwaharaT, OshimaK, TohH, ToyodaA, et al Comparative Metagenomics Revealed Commonly Enriched Gene Sets in Human Gut Microbiomes. DNA Research. 2007;14(4):169–181. 10.1093/dnares/dsm018 <?supplied-pmid 17916580?>17916580 </plain></SENT>
</text></ref><ref id="pone.0157338.ref010"><text><SENT sid="533" pm="."><plain>10 YeY, ChoiJH, TangH. RAPSearch: a fast protein similarity search tool for short reads. BMC Bioinformatics. 2011;12(1):159 10.1186/1471-2105-12-159 <?supplied-pmid 21575167?>21575167 </plain></SENT>
</text></ref><ref id="pone.0157338.ref011"><text><SENT sid="534" pm="."><plain>11 ZhaoY, TangH, YeY. RAPSearch2: a fast and memory-efficient protein similarity search tool for next-generation sequencing data. Bioinformatics. 2012;28(1):125–126. 10.1093/bioinformatics/btr595 <?supplied-pmid 22039206?>22039206 </plain></SENT>
</text></ref><ref id="pone.0157338.ref012"><text><SENT sid="535" pm="."><plain>12 SuzukiS, KakutaM, IshidaT, AkiyamaY. GHOSTX: An Improved Sequence Homology Search Algorithm Using a Query Suffix Array and a Database Suffix Array. PLoS ONE. 2014;9(8):e103833 10.1371/journal.pone.0103833 <?supplied-pmid 25099887?>25099887 </plain></SENT>
</text></ref><ref id="pone.0157338.ref013"><text><SENT sid="536" pm="."><plain>13 SuzukiS, KakutaM, IshidaT, AkiyamaY. Faster sequence homology searches by clustering subsequences. Bioinformatics. 2015;31(8):1183–1190. 10.1093/bioinformatics/btu780 <?supplied-pmid 25432166?>25432166 </plain></SENT>
</text></ref><ref id="pone.0157338.ref014"><text><SENT sid="537" pm="."><plain>14 BuchfinkB, XieC, HusonDH. Fast and Sensitive Protein Alignment using DIAMOND. Nature Methods. 2015;12(1):59–60. 10.1038/nmeth.3176 <?supplied-pmid 25402007?>25402007 </plain></SENT>
</text></ref><ref id="pone.0157338.ref015"><text><SENT sid="538" pm="."><plain>15 LuoR, WongT, ZhuJ, LiuCM, ZhuX, WuE, et al SOAP3-dp: Fast, Accurate and Sensitive GPU-Based Short Read Aligner. PLoS ONE. 2013;8(5):e65632 10.1371/journal.pone.0065632 <?supplied-pmid 23741504?>23741504 </plain></SENT>
</text></ref><ref id="pone.0157338.ref016"><text><SENT sid="539" pm="."><plain>16Shimoda T, Ishida T, Suzuki S, Ohue M, Akiyama Y. MEGADOCK-GPU: Acceleration of Protein-Protein Docking Calculation on GPUs. </plain></SENT>
<SENT sid="541" pm="."><plain>In: Proceedings of the International Conference on Bioinformatics, Computational Biology and Biomedical Informatics. </plain></SENT>
<SENT sid="542" pm="."><plain>BCB’13. </plain></SENT>
<SENT sid="543" pm="."><plain>New York, NY, USA: ACM; 2013. p. 883:883–883:889. </plain></SENT>
<SENT sid="545" pm="."><plain>Available from: <ext-link ext-link-type="uri" xlink:href="http://doi.acm.org/10.1145/2506583.2506693">http://doi.acm.org/10.1145/2506583.2506693</ext-link> </plain></SENT>
</text></ref><ref id="pone.0157338.ref017"><text><SENT sid="546" pm="."><plain>17 GoudeyB, RawlinsonD, WangQ, ShiF, FerraH, CampbellR, et al GWIS—model-free, fast and exhaustive search for epistatic interactions in case-control GWAS. BMC Genomics. 2013;14(Suppl 3):S10 10.1186/1471-2164-14-S3-S10 <?supplied-pmid 23819779?>23819779 </plain></SENT>
</text></ref><ref id="pone.0157338.ref018"><text><SENT sid="547" pm="."><plain>18 SmithTF, WatermanMS. Identification of common molecular subsequences. Journal of Molecular Biology. 1981;147(1):195–197. 10.1016/0022-2836(81)90087-5 <?supplied-pmid 7265238?>7265238 </plain></SENT>
</text></ref><ref id="pone.0157338.ref019"><text><SENT sid="548" pm="."><plain>19 LiuY, WirawanA, SchmidtB. CUDASW++ 3.0: accelerating Smith-Waterman protein database search by coupling CPU and GPU SIMD instructions. BMC Bioinformatics. 2013;14(1):117 10.1186/1471-2105-14-117 <?supplied-pmid 23557111?>23557111 </plain></SENT>
</text></ref><ref id="pone.0157338.ref020"><text><SENT sid="549" pm="."><plain>20 KorparM, SosicM, BlazekaD, SikicM. SW#db: GPU-Accelerated Exact Sequence Similarity Database Search. PLoS ONE. 2016;10(12):1–11. </plain></SENT>
</text></ref><ref id="pone.0157338.ref021"><text><SENT sid="550" pm="."><plain>21 LiuY, HongY, LinCY, HungCL. Accelerating Smith-Waterman Alignment for Protein Database Search Using Frequency Distance Filtration Scheme Based on CPU-GPU Collaborative System. International Journal of Genomics. 2015;2015(761063):1–12. 10.1155/2015/761063 </plain></SENT>
</text></ref><ref id="pone.0157338.ref022"><text><SENT sid="551" pm="."><plain>22 ZhaoK, ChuX. G-BLASTN: accelerating nucleotide alignment by graphics processors. Bioinformatics. 2014;30(10):1384–1391. 10.1093/bioinformatics/btu047 <?supplied-pmid 24463183?>24463183 </plain></SENT>
</text></ref><ref id="pone.0157338.ref023"><text><SENT sid="552" pm="."><plain>23 LiuY, SchmidtB. CUSHAW2-GPU: Empowering Faster Gapped Short-Read Alignment Using GPU Computing. Design Test, IEEE. 2014;31(1):31–39. 10.1109/MDAT.2013.2284198 </plain></SENT>
</text></ref><ref id="pone.0157338.ref024"><text><SENT sid="553" pm="."><plain>24 PearsonWR. Searching protein sequence libraries: Comparison of the sensitivity and selectivity of the Smith-Waterman and FASTA algorithms. Genomics. 1991;11(3):635–650. 10.1016/0888-7543(91)90071-L <?supplied-pmid 1774068?>1774068 </plain></SENT>
</text></ref><ref id="pone.0157338.ref025"><text><SENT sid="554" pm="."><plain>25 MorgulisA, CoulourisG, RaytselisY, MaddenTL, AgarwalaR, SchäfferAA. Database indexing for production MegaBLAST searches. Bioinformatics. 2008;24(16):1757–1764. 10.1093/bioinformatics/btn322 <?supplied-pmid 18567917?>18567917 </plain></SENT>
</text></ref><ref id="pone.0157338.ref026"><text><SENT sid="555" pm="."><plain>26 VouzisPD, SahinidisNV. GPU-BLAST: using graphics processors to accelerate protein sequence alignment. Bioinformatics. 2011;27(2):182–188. 10.1093/bioinformatics/btq644 <?supplied-pmid 21088027?>21088027 </plain></SENT>
</text></ref><ref id="pone.0157338.ref027"><text><SENT sid="556" pm="."><plain>27 LiuW, SchmidtB, Muller-WittigW. CUDA-BLASTP: Accelerating BLASTP on CUDA-Enabled Graphics Hardware. IEEE/ACM Trans Comput Biol Bioinformatics. 2011;8(6):1678–1684. 10.1109/TCBB.2011.33 </plain></SENT>
</text></ref><ref id="pone.0157338.ref028"><text><SENT sid="557" pm="."><plain>28 FuL, NiuB, ZhuZ, WuS, LiW. CD-HIT: accelerated for clustering the next-generation sequencing data. Bioinformatics. 2012;28(23):3150–3152. 10.1093/bioinformatics/bts565 <?supplied-pmid 23060610?>23060610 </plain></SENT>
</text></ref><ref id="pone.0157338.ref029"><text><SENT sid="558" pm="."><plain>29 ChandoniaJ, HonG, WalkerNS, Lo ConteL, KoehlP, LevittM, et al The ASTRAL Compendium in 2004. Nucleic Acids Research. 2004;32(suppl 1):D189–D192. 10.1093/nar/gkh034 <?supplied-pmid 14681391?>14681391 </plain></SENT>
</text></ref><ref id="pone.0157338.ref030"><text><SENT sid="559" pm="."><plain>30 MurzinAG, BrennerSE, HubbardT, ChothiaC. SCOP: A structural classification of proteins database for the investigation of sequences and structures. Journal of Molecular Biology. 1995;247(4):536–540. 10.1016/S0022-2836(05)80134-2 <?supplied-pmid 7723011?>7723011 </plain></SENT>
</text></ref></ref-list></SecTag></back></article>
