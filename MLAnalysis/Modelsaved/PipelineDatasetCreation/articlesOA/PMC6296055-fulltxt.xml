<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Genome Biol</journal-id><journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id><journal-title-group><journal-title>Genome Biology</journal-title></journal-title-group><issn pub-type="ppub">1474-7596</issn><issn pub-type="epub">1474-760X</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6296055</article-id><article-id pub-id-type="publisher-id">1595</article-id><article-id pub-id-type="doi">10.1186/s13059-018-1595-x</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software</subject></subj-group></article-categories><title-group><article-title>FORGe: prioritizing variants for graph genomes</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Pritt</surname><given-names>Jacob</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Chen</surname><given-names>Nae-Chyun</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2437-1976</contrib-id><name><surname>Langmead</surname><given-names>Ben</given-names></name><address><email>langmea@cs.jhu.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Department of Computer Science, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2171 9311</institution-id><institution-id institution-id-type="GRID">grid.21107.35</institution-id><institution>Center for Computational Biology, </institution><institution>Johns Hopkins University, </institution></institution-wrap>Baltimore, USA </aff></contrib-group><pub-date pub-type="epub"><day>17</day><month>12</month><year>2018</year></pub-date><pub-date pub-type="pmc-release"><day>17</day><month>12</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>19</volume><elocation-id>220</elocation-id><history><date date-type="received"><day>12</day><month>5</month><year>2018</year></date><date date-type="accepted"><day>26</day><month>11</month><year>2018</year></date></history><permissions><copyright-statement>&#169; The Author(s) 2018</copyright-statement><license license-type="OpenAccess"><license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><p>There is growing interest in using genetic variants to augment the reference genome into a graph genome, with alternative sequences, to improve read alignment accuracy and reduce allelic bias. While adding a variant has the positive effect of removing an undesirable alignment score penalty, it also increases both the ambiguity of the reference genome and the cost of storing and querying the genome index. We introduce methods and a software tool called FORGe for modeling these effects and prioritizing variants accordingly. We show that FORGe enables a range of advantageous and measurable trade-offs between accuracy and computational overhead.</p><sec><title>Electronic supplementary material</title><p>The online version of this article (10.1186/s13059-018-1595-x) contains supplementary material, which is available to authorized users.</p></sec></abstract><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01GM118568</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000145</institution-id><institution>Division of Information and Intelligent Systems</institution></institution-wrap></funding-source><award-id>IIS-1349906</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#169; The Author(s) 2018</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Introduction</title><p>Assembled genomes are typically stored and understood as strings, simple sequences of base pairs. High-throughput technologies have brought an explosion of population genetics information, including from projects like HapMap [<xref ref-type="bibr" rid="CR1">1</xref>], the 1000 Genomes Project [<xref ref-type="bibr" rid="CR3">3</xref>], and UK10K [<xref ref-type="bibr" rid="CR52">52</xref>]. The question is emerging: how can we use population genetics information to improve accuracy of genomic analyses? This has fueled interest in techniques that depart from a linear string as point of reference for all individuals and toward pan-genome representations [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR50">50</xref>] more inclusive of genetic variation.</p><p>While methods for including variants in the reference are growing in number [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR43">43</xref>, <xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR49">49</xref>], there is little or no work on how to choose which variants to include. Past studies have made such decisions in ad hoc ways, with some filtering according to allele frequency [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR31">31</xref>], ethnicity [<xref ref-type="bibr" rid="CR43">43</xref>], or both [<xref ref-type="bibr" rid="CR49">49</xref>].</p><p>Here, we examine the advantages and disadvantages of adding variants to the reference. We show that the disadvantages are important to measure, since simply adding more variation to the reference eventually reduces alignment accuracy. We suggest efficient models for scoring variants according to the effect on accuracy and &#8220;blowup&#8221; (computational overhead), and further show that these scores can be used to achieve a balance of accuracy and overhead superior to current approaches. For example, extrapolating to a whole-human DNA sequencing experiment at 40-fold average coverage, we estimate that a well-engineered augmented reference can yield about 4.8 M more correctly aligned reads and 1.2 M fewer incorrectly aligned compared to the linear reference. Our methods for selecting variants also reduce reference bias, a chief goal of graph genomes. Finally, we compare the accuracy yielded by our methods to that achieved using an ideal personalized graph genome. We show that our methods approach the ideal much more closely than both linear genomes&#8212;even when they are modified to contain only major alleles&#8212;and graph genomes built on different sets of variants.</p><p>These methods are implemented in a new open source software tool called FORGe. We demonstrate FORGe in conjunction with the HISAT2 [<xref ref-type="bibr" rid="CR25">25</xref>] graph aligner and with another aligner based on the Enhanced Reference Genome [<xref ref-type="bibr" rid="CR43">43</xref>]. But FORGe&#8217;s models and methods are suitable for any aligner that can include variants in the reference.</p><sec id="Sec2"><title>Read alignment with variants</title><p>Read alignment is the process of determining each read&#8217;s point of origin with respect to a reference genome. The origin can be ambiguous, and reported alignments can be incorrect [<xref ref-type="bibr" rid="CR29">29</xref>]. Repetitive genomes and sequencing errors contribute to this problem [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. Importantly, genetic differences between donor and reference genomes also contribute. Alignments overlapping positions where the genomes differ&#8212;i.e., where the donor genome has a non-reference allele&#8212;are systematically penalized. This can (a) reduce the correct alignment&#8217;s score below the threshold considered significant by the aligner, (b) cause the aligner&#8217;s heuristics to miss the correct alignment, and (c) cause the correct alignment&#8217;s score to fall below the score at a different, incorrect location. The problem is magnified in hyper-variable regions such as the major histocompatibility complex (MHC) [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. It is also problematic when individuals differ dramatically, e.g., if they are from distinct inbred strains [<xref ref-type="bibr" rid="CR44">44</xref>], or when downstream analyses are vulnerable to allelic bias, such as when detecting allele-specific expression [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR43">43</xref>] or calling heterozygous variants [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR15">15</xref>].</p><p>Augmenting the reference genome with known variants helps in two major ways. First, it reduces the genetic distance between donor and reference genomes, removing the tendency to penalize correct alignments that overlap non-reference alleles. Second, it avoids the allelic bias, also called &#8220;reference bias,&#8221; [<xref ref-type="bibr" rid="CR9">9</xref>] that results when one donor haplotype resembles the reference more closely than the other(s).</p><p>There are many proposals for how to include and index genetic variants along with the reference genome. Two early approaches were GenomeMapper [<xref ref-type="bibr" rid="CR44">44</xref>] and the Enhanced Reference Genome [<xref ref-type="bibr" rid="CR43">43</xref>]. GenomeMapper came from a project to sequence many inbred strains of <italic>Arabidopsis thaliana</italic>, and it used a graph representation and an accompanying <italic>k</italic>-mer index to represent and align to a graph representing all strains. The Enhanced Reference Genome [<xref ref-type="bibr" rid="CR43">43</xref>], which specifically addresses reference bias for allele-specific expression, included variants by taking the non-reference allele along with flanking bases and appending these &#8220;enhanced segments&#8221; to the linear reference genome. Since the resulting reference is linear, a typical read aligner like Bowtie [<xref ref-type="bibr" rid="CR27">27</xref>] can be used.</p><p>Several studies have expanded on these ideas. deBGA [<xref ref-type="bibr" rid="CR30">30</xref>] uses a colored De Bruijn graph [<xref ref-type="bibr" rid="CR22">22</xref>] and accompanying hash-table index. BWBBLE [<xref ref-type="bibr" rid="CR21">21</xref>] and gramtools [<xref ref-type="bibr" rid="CR31">31</xref>] use an FM Index [<xref ref-type="bibr" rid="CR16">16</xref>] with an expanded alphabet and modified backward-search algorithm to account for variants. GCSA [<xref ref-type="bibr" rid="CR49">49</xref>] generalizes the compressed suffix array to index not a single reference but a multiple alignment of several references. HISAT2 [<xref ref-type="bibr" rid="CR25">25</xref>] combines GCSA with the hierarchical FM Index implemented in HISAT [<xref ref-type="bibr" rid="CR24">24</xref>]. GCSA2 [<xref ref-type="bibr" rid="CR48">48</xref>] indexes paths in arbitrary graphs and is implemented in the VG software tool [<xref ref-type="bibr" rid="CR18">18</xref>] which can align reads to such indexes. MuGI [<xref ref-type="bibr" rid="CR8">8</xref>] and GraphTyper [<xref ref-type="bibr" rid="CR15">15</xref>] use <italic>k</italic>-mer-based indexes.</p><p>Genome assemblies are also evolving along these lines. The GRCh37 and GRCh38 human assemblies [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>] include &#8220;alt loci,&#8221; alternate assemblies of hypervariable regions including MHC. Other studies suggest modifying the linear genome by replacing each non-major allele with its major alternative [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. This leverages population-level information while keeping a linear representation.</p><p>While including variants in the reference incurs a computational cost, the nature and magnitude of the cost depends on the method. For some methods, the most direct manifestation is in the size of the reference genome and index. The Enhanced Reference Genome [<xref ref-type="bibr" rid="CR43">43</xref>] and its index both grow with the number and length of the &#8220;enhanced segments&#8221; added to cover all windows containing non-reference alleles. The number of segments required to cover a set of <italic>k</italic> variants within the span of a single read is 2<sup><italic>k</italic></sup>&#8722;1. Even if this phenomenon is isolated in a few areas of the genome (e.g., hypervariable regions), the appearance of <italic>k</italic> in the exponent means it can be very significant. The GCSA method [<xref ref-type="bibr" rid="CR49">49</xref>] used in HISAT2 [<xref ref-type="bibr" rid="CR25">25</xref>] incurs similar blowup in its &#8220;path doubling&#8221; step. We elaborate in Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Note S1, Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S1, and Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S2, including specific discussions of how the cost manifests in different methods, how it leads to more ambiguity in the reference genome which can ultimately lead to reduced accuracy, and how it can be controlled.</p></sec><sec id="Sec3"><title>Variant selection and evaluation</title><p>Past efforts that evaluated graph aligners have been selective about what variants to include in the graph, but without a clear rationale. Some included all variants from a defined subset of strains or haplotypes [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR44">44</xref>] or from a database such as the 1000 Genomes Project callset [<xref ref-type="bibr" rid="CR3">3</xref>] or dbSNP [<xref ref-type="bibr" rid="CR46">46</xref>]. In some cases, variants were filtered according to ethnicity, e.g., keeping just the Finnish 1000 Genomes individuals [<xref ref-type="bibr" rid="CR49">49</xref>] or the Yoruban HapMap [<xref ref-type="bibr" rid="CR1">1</xref>] individuals [<xref ref-type="bibr" rid="CR43">43</xref>]. The ERG study (concerned with allele-specific expression) excluded variants outside annotated genes. The gramtools study [<xref ref-type="bibr" rid="CR31">31</xref>] used 1000 Genomes variants but excluded those with observed allele frequency less than 5%. GraphTyper [<xref ref-type="bibr" rid="CR15">15</xref>] used dbSNP variants in one experiment, excluding single-nucleotide variants (SNVs) with under 1% frequency in all populations. HISAT2&#8217;s software for selecting variants to include filters out SNVs with an allele frequency of under 10% in some cases [<xref ref-type="bibr" rid="CR25">25</xref>].</p><p>Here we explicitly model the variants according to their effects on alignment, and we provide methods for choosing an optimal set based on those models. We apply these methods in combination with two different augmented-reference alignment methods and compare to a range of relevant competing methods, including a linear reference with reference alleles, a linear reference with all-major alleles, and an ideal &#8220;personalized&#8221; reference that customized to fit the donor individual&#8217;s alleles (including at heterozygous positions) as closely as possible. This experimental design allows us to make statements about how our methods affect accuracy, how those effects vary with genomic region, how close the methods come to achieving ideal accuracy, and how practical current graph alignment methods are overall.</p></sec></sec><sec id="Sec4" sec-type="results"><title>Results</title><sec id="Sec5"><title>Strategy</title><p>FORGe works in cooperation with a variant-aware read aligner (<italic>graph aligner</italic>) such as HISAT2 [<xref ref-type="bibr" rid="CR25">25</xref>]. Consider the alignment process as being divided into <italic>offline</italic> (index building) and <italic>online</italic> (alignment) stages. FORGe operates in the offline stage. Specifically, FORGe takes a reference genome (FASTA format) and catalog of variants and their frequencies in the population (Variant Call Format). FORGe can also use phasing information when provided in the VCF. FORGe then uses a mathematical model to score each variant according to its expected positive and negative impacts on alignment accuracy and computational overhead. The model could consider factors such as the variant&#8217;s frequency in a population, its proximity to other variants, and how its inclusion affects the repetitiveness of the graph genome. Using these scores&#8212;together with a parameter for the overall percentage or number of variants to include&#8212;FORGe outputs the top-scoring subset of variants, which can then be fed to the index-building component of a graph alignment tool like HISAT2&#8217;s hisat2-build program. In the online stage, the aligner uses this FORGe-customized index to align the sequencing reads.</p></sec><sec id="Sec6"><title>Simulation</title><p>We used Mason 0.1.2 [<xref ref-type="bibr" rid="CR20">20</xref>] to simulate reads (details in Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Note S2). Mason simulates sequencing errors and base quality values. Mason also annotates each read with information about its true point of origin. We disabled Mason&#8217;s facility for adding genetic variants, since we simulate from already-individualized references. We classify an alignment as correct if its aligned position in the reference is within 10 nt of the true point of origin. If the aligner reports several alignments for a read, we consider only the primary alignment&#8212;of which there is exactly one per aligned read, usually with alignment score equal to or greater than all the others&#8212;when determining correctness.</p></sec><sec id="Sec7"><title>Alignment</title><p>We tested FORGe with two read alignment strategies capable of including variants in the reference: HISAT2 [<xref ref-type="bibr" rid="CR25">25</xref>] and the Enhanced Reference Genome (ERG) [<xref ref-type="bibr" rid="CR43">43</xref>]. HISAT2 is a practical graph aligner that we hypothesized would benefit from careful selection of genetic variants to include. The ERG is simple and compatible with linear aligners like Bowtie. We use ERG only with short unpaired reads (25 nt) to test the hypothesis that the seed-finding step of an aligner can benefit from including FORGe-selected variants. Adapting the ERG approach to paired-end alignment is probably not practical (see the &#8220;<xref rid="Sec30" ref-type="sec">Discussion</xref>&#8221; section).</p><p>In its offline stage, HISAT2 takes a linear reference genome and a VCF file with single-nucleotide variants and indels. HISAT2 uses GCSA indexing [<xref ref-type="bibr" rid="CR49">49</xref>] to build a graph-genome index. The resulting graph is the generating graph for all combinations of reference (REF) and included alternate (ALT) alleles. HISAT2 also provides software that, starting from a VCF file (or the UCSC &#8220;Common SNPs&#8221; track, derived from dbSNP [<xref ref-type="bibr" rid="CR46">46</xref>]), selects a subset of variants to include. It filters in two ways. First, it excludes variants with allele frequency under 10%. Second, where variants are densely packed, it imposes artificial haplotype constraints to avoid the exponential blowup that results from considering all combinations of REF and ALT alleles. We call this the <italic>HISAT2 auto</italic> method.</p><p>We also tested FORGe with our implementation of the ERG [<xref ref-type="bibr" rid="CR43">43</xref>]. ERG&#8217;s offline phase starts with a linear reference genome and a variant file. It builds an augmented reference genome by adding <italic>enhanced segments</italic>: reference substrings that include ALTS and flanking context. The amount of context depends on a user-specified window size, <italic>r</italic>, which typically equals the maximum read length. When <italic>n</italic> variants co-occur in a window, 2<sup><italic>n</italic></sup>&#8722;1 enhanced segments are added to cover all combinations of ALT and REF alleles. The original ERG study limited growth by considering only the leftmost <italic>k</italic> variants per length-<italic>r</italic> window, with <italic>k</italic>=5 in practice. We use a variation on this limit: if a window contains more than <italic>k</italic> variants, we consider (a) the leftmost variant, and (b) the <italic>k</italic>&#8722;1 other variants with highest allele frequency according to the input VCF. Including the leftmost guarantees that each variant has its ALT included in at least one of the overlapping enhanced segments. We also set the limit higher (<italic>k</italic>=15) by default. While <italic>k</italic> is configurable, we used the default in all experiments here. After adding enhanced segments to the reference, we indexed it with Bowtie [<xref ref-type="bibr" rid="CR27">27</xref>]. In the online stage, we used Bowtie to align to the enhanced reference. Details on our ERG implementation are in Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Note S3.</p><p>In all experiments, we ran HISAT2 with the -k 10, &#8212;no-spliced-alignment, and &#8212;no-temp-splicesite options. In the ERG experiments, we ran Bowtie with the -v 1 option to allow alignments with up to one mismatch. Note that HISAT2 is able to find alignments with mismatches, insertions, or deletions, whereas Bowtie can only find alignments with mismatches. In all cases, we used Python&#8217;s rusage module to measure peak resident memory usage and we used the Linux time utility to measure real (&#8220;wall clock&#8221;) running times. All tools were run using a single thread.</p></sec><sec id="Sec8"><title>Variant models</title><p>As detailed in the &#8220;<xref rid="Sec20" ref-type="sec">Methods</xref>&#8221; section, FORGe has two main models for ranking and selecting variants to include in the reference. First is <italic>Population Coverage</italic> (<italic>Pop Cov</italic>), which scores variants according to allele frequency. Second is <italic>Hybrid</italic>, which weighs both a variant&#8217;s allele frequency and the degree to which its addition would make the reference more repetitive. Additionally, we evaluated versions of these two models enhanced with a <italic>blowup avoidance</italic> strategy that, at variant adding time, dynamically down-weights candidates that are close to already-added variants. These versions are called <italic>Pop Cov+</italic> and <italic>Hybrid+</italic>. All of these strategies are detailed in the &#8220;<xref rid="Sec20" ref-type="sec">Methods</xref>&#8221; section.</p><sec id="Sec9"><title>Chromosome 9 simulation</title><p>We tested FORGe in a series of simulation experiments. We used human chromosome 9 from the GRCh37 assembly [<xref ref-type="bibr" rid="CR6">6</xref>]. GRCh37 was chosen to match the coordinates for the official 1000 Genomes Project Phase-3 variants [<xref ref-type="bibr" rid="CR3">3</xref>]. We simulated sequencing reads from chromosome 9 of NA12878, a female from the CEPH (Utah residents with Northern and Western European ancestry) group studied in the 1000 Genomes Project. Specifically, we generated 10 million unpaired Illumina-like reads from each haplotype of NA12878 for a total of 20 million reads. Each read comes from one of the two haplotypes. We created a VCF file containing all single-nucleotide variants (SNVs) appearing in chromosome 9 in at least one 1000-Genomes individual, excluding NA12878 and family members. The resulting file contained 3.4 million SNVs. Details on how this set of SNVs was obtained are presented in Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Note S4. We used the <italic>Pop Cov</italic>, <italic>Hybrid</italic>, <italic>Pop Cov+</italic>, and <italic>Hybrid+</italic> models to score the 3.4 M SNVs. The <italic>Hybrid</italic> and <italic>Hybrid+</italic> models used phasing information, whereas the <italic>Pop Cov</italic> and <italic>Pop Cov+</italic> models did not (explained in <xref rid="Sec20" ref-type="sec">Methods</xref>). We compiled subsets of SNVs consisting of the top-scoring 0%, 2%, 4%, 6%, 8%, 10%, 15%, and 20% up to 100% in 10 point increments.</p><sec id="Sec10"><title>HISAT2</title><p>Figure&#160;<xref rid="Fig1" ref-type="fig">1</xref> shows alignment rate and accuracy when using HISAT2 to align our simulated 100 nt reads to the genome indexes created with hisat2-build. The leftmost point (or in the case of Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>c, the point labeled 0%) corresponds to a HISAT2 index with no SNVs added, i.e., a linear reference genome. The diamond labeled <italic>Major Allele</italic> corresponds to a linear reference with all major alleles; i.e., with every SNV set to the allele that was most most frequent among CEU individuals in the filtered callset. The diamond labeled <italic>HISAT2 auto</italic> corresponds to the pruned set obtained by running HISAT2&#8217;s scripts. The diamond-labeled <italic>Personalized</italic> shows results when aligning to a personalized NA12878 genome with all non-reference homozygous (HOM) alleles replaced by their ALT versions and all heterozygous (HET) SNVs added as variants, so that neither REF nor ALT are penalized at alignment time. This is not a realistic scenario, but helpful for assessing how close the tested methods come to the personalized-genome ideal. Plotted lines show results obtained when adding progressively larger subsets of SNVs to the graph genome, prioritized by model score.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Results from NA12878 simulation for GRCh37 Chromosome 9. 100 nt unpaired reads were simulated from Chromosome 9 with NA12878&#8217;s variants included. FORGe and HISAT2 created and indexed augmented reference genomes with various variant sets. Besides the <italic>Pop Cov</italic> and <italic>Hybrid</italic> rankings, we also included a strategy that gave variants random ranks (&#8220;Random&#8221;). <bold>a</bold> and <bold>d</bold> show the fraction of reads aligned. <bold>b</bold> and <bold>e</bold> show the fraction that aligned correctly to the simulated point of origin. <bold>c</bold> plots a parametric curve of the fraction of reads with a correct alignment (vertical) versus the fraction with an incorrect alignment (horizontal). Lines follow measurements made over a range of fractions of SNVs, with points for 0%, 2%, 4%, 6%, 8%, 10%, 15%, and 20% up to 100% in 10 point increments. The diamond labeled <italic>HISAT2 auto</italic> is an augmented genome produced using HISAT2&#8217;s pruning scripts. The diamond labeled <italic>Major allele ref</italic> is a linear reference with all positions set to the most frequent allele. Other diamonds indicate the SNV fraction maximizing <italic>y</italic>&#8722;<italic>x</italic>, where <italic>y</italic> is the fraction of reads aligned correctly and <italic>x</italic> is the fraction aligned incorrectly. The <italic>HISAT2</italic> and <italic>Major allele</italic> diamonds are excluded from panels <bold>a</bold>, <bold>b</bold>, and <bold>f</bold> because there is no clear way to measure the fraction of variants included by these methods. The black filled circle and square in panel <bold>c</bold> represent measurements when 0% and 100% of variants are included, respectively</p></caption><graphic xlink:href="13059_2018_1595_Fig1_HTML" id="MO1"/></fig>
</p><p>Figure&#160;<xref rid="Fig1" ref-type="fig">1</xref>a, b shows alignment rate and fraction of alignments that are correct (henceforth &#8220;correctness&#8221;) as a function of the number of SNVs included in the genome. For all models except <italic>Hybrid+</italic>, peak alignment rate and correctness occur in the 8&#8211;12% range of SNVs included. All the FORGe models at their peak achieve higher alignment rate and correctness than the major-allele and HISAT2 methods. When greater fractions of variants are included&#8212;more than around 12%&#8212;alignment rate and correctness generally decrease. Correctness eventually decreases to a level only somewhat higher than that achieved by the linear reference, showing that alignment suffers when too many variants are included. Figure&#160;<xref rid="Fig1" ref-type="fig">1</xref>d, e is similar to a and b but show alignment rate and correctness as a function of HISAT2&#8217;s memory footprint at alignment time. While FORGe&#8217;s models at their peak have a roughly 50% larger memory footprint than the linear references (both major-allele and reference-allele), they use roughly half the memory of the &#8220;HISAT2 auto&#8221; method.</p><p>Figure&#160;<xref rid="Fig1" ref-type="fig">1</xref>c plots a point or a parametric curve for each indexing strategy and model. The vertical axis is the fraction of reads (not alignments) that aligned correctly, and the horizontal axis is the fraction of reads that aligned incorrectly. Notable points on the curves are labeled with the fraction of SNVs included. Diamonds mark points on the curves with maximal <italic>y</italic>&#8722;<italic>x</italic>, where <italic>y</italic> is fraction correct and <italic>x</italic> is fraction incorrect. This is a combined measure for alignment rate and accuracy, and maximal values are reached in the 8&#8211;10% range of SNVs included (except <italic>Hybrid+</italic>, which peaked at 30%). The best performing are superior to (above and to the left of) the linear-genome methods, the &#8220;HISAT2 auto&#8221; method, and to the genome obtained by adding all of the SNVs (labeled 100%). The best-performing graph genomes come much closer to the personalized-genome ideal than the other methods.</p><p>It is notable that the alignment rate curves in Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>a, b, d and e eventually trend downward. Like most read aligners, HISAT2 uses heuristics to limit the effort spent aligning reads to many repetitive regions of the same reference genome. HISAT2 is unusual in that when a read has too many repetitive alignments, it will abort and leave the read unaligned. Bowtie does not have this heuristic; rather, Bowtie chooses one best-scoring alignment to report even when the read has many repetitive alignments. Because of this, HISAT2&#8217;s alignment rate decreases as more variants are included and the genome becomes more repetitive.</p><p>A known drawback of graph aligners is that accuracy and overhead can suffer when many variants co-occur in a small window of the genome. To measure the impact this has on FORGe&#8217;s models, we also plotted results using <italic>blowup avoiding</italic> versions of the <italic>Pop Cov</italic> and <italic>Hybrid</italic> models (Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>, dotted lines), called <italic>Pop Cov+</italic> and <italic>Hybrid+</italic>. These versions will, when selecting variants to add, deprioritize variants that are near already-added variants. We observed that blowup avoidance had a minimal impact on the shape of the <italic>Pop Cov</italic> curve; e.g., Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>d, e shows the solid and dotted lines for <italic>Pop Cov</italic> on top of each other. Notably, blowup avoidance did cause the alignment memory to increase more slowly with respect to the number of added variants for the <italic>Pop Cov</italic> ranking (Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>f). For the <italic>Hybrid</italic> model, blowup avoidance did not change the relationship between memory footprint and number of variants added (Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>f) and had an adverse effect on alignment rate and correctness. This is likely because the <italic>Hybrid</italic> model already takes clustered variants into account in its <italic>k</italic>-mer counts.</p><p>We repeated these experiments for paired-end reads (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S3) and the results closely followed those in Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>. Alignment rate and accuracy both increased when using paired-end reads, since an accurate alignment for one end can &#8220;rescue&#8221; the other in the presence of ambiguity. Peak accuracy (maximal <italic>y</italic>&#8722;<italic>x</italic>) was achieved at the same SNV fraction except in the case of the Hybrid ranking, which peaked at 15% rather than at 10%.</p><p>We also repeated these experiments for reads simulated from Yoruban (YRI) individual NA19238, also sequenced in the 1000 Genomes Project (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). As we did for NA12878, we excluded variant calls for NA19238 and family members before providing variants to the model for scoring. These results also closely followed those in Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>, with accuracy and recall peaking at a somewhat higher percentage of variants included (15% for YRI compared to 8&#8211;10% for CEU), likely due to YRI&#8217;s greater divergence from the reference. We return to this in the &#8220;<xref rid="Sec30" ref-type="sec">Discussion</xref>&#8221; section.</p><p>Finally, we repeated the unpaired NA12878 experiment including both SNVs and indels in the FORGe analysis (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). Whereas previous experiments modeled and scored 3.4 M SNVs, here we modeled and scored 3.4 M SNVs and 131k indels, composed of 49k insertions ranging in length up to 411 nt and 82k deletions up to 92 nt. Given these variant scores, we selected top-scoring fractions, built indexes, simulated reads from NA12878 (both SNVs and indels included) and performed alignments as before. When assessing correctness of the resulting read alignments, we took coordinate shifts due to indels into account. Overall the results are similar to those in Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>. While there is a slight drop in peak alignment and correctness rate, the rates varied over a wider range of percentages relative to the SNV-only experiment. Maximal <italic>y</italic>&#8722;<italic>x</italic> occurred at slightly higher variant fractions relative to the SNV-only experiment: 10% for <italic>Pop Cov</italic> and <italic>Pop Cov+</italic>, 15% for <italic>Hybrid</italic> and 30% for <italic>Hybrid+</italic>.</p></sec><sec id="Sec11"><title>Enhanced Reference Genome</title><p>Figure&#160;<xref rid="Fig2" ref-type="fig">2</xref> shows alignment rate and correctness when using Bowtie [<xref ref-type="bibr" rid="CR27">27</xref>] to align simulated 25 nt reads to enhanced references constructed with the ERG method [<xref ref-type="bibr" rid="CR43">43</xref>]. We used shorter reads and configured Bowtie to find alignments with up to 1 mismatch (-v 1) to mimic the seed alignment step of seed-and-extend aligners.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Results from aligning simulated 25 nt unpaired reads to GRCh37 chromosome 9 using the ERG+Bowtie approach. Panels and plots have the same meaning as for Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref> except that <italic>HISAT2 auto</italic> and <italic>Major allele ref</italic> diamonds are omitted here</p></caption><graphic xlink:href="13059_2018_1595_Fig2_HTML" id="MO2"/></fig>
</p><p>Unlike HISAT2, Bowtie always reports an alignment if one is found, regardless of how repetitively the read aligns. Consequently, the alignment rate shown in Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>a and d strictly increases as variants are added to the graph. Apart from that, the results reinforce those from Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>. Peak correctness occurs at a relatively small fraction of SNVs (6&#8211;20%). As more variants are added, correctness eventually decreases, though the <italic>Hybrid</italic> ranking does not suffer this drop until over 70% of SNVs are included. The alignment-time memory footprint of the best-performing FORGe indexes is higher than that of the linear reference; e.g., including the top 6% of <italic>Pop Cov+</italic>-scored SNVs increases the footprint 29%, from 127.9 MB to 165.0 MB. But it is a fraction of the size of the index when 100% of variants are included (1.87 GB). Blowup avoidance (Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>, dotted lines) had a somewhat minor effect on alignment rate and correctness for <italic>Pop Cov</italic>, and a clear negative effect for <italic>Hybrid</italic>. On the other hand, it slowed the rate of index growth for both models at low and intermediate fractions of SNVs (Fig.&#160;<xref rid="Fig2" ref-type="fig">2</xref>f).</p></sec></sec><sec id="Sec12"><title>Stratification by variant density, variant rarity, and repetitiveness</title><p>Figure&#160;<xref rid="Fig1" ref-type="fig">1</xref>c showed that when we move from 0 to 8% of variants included in the augmented reference, the number of correct alignments increases by about 0.4 percentage points (as a fraction of reads) and the number of incorrect decreases by about 0.1 points. Though these may seem like small differences, in a study with 1.2 billion reads&#8212;approximately the number of unpaired 100 nt unpaired reads required to cover the human genome to 40-fold average depth&#8212;this would yield about 4.8 M more correctly aligned reads and 1.2 M fewer incorrectly aligned.</p><p>Still, we hypothesized that certain read subsets might be affected more dramatically by the inclusion of variants. To this end, we measured alignment rate and correctness when we varied the number of alternate alleles overlapped by a read (Fig.&#160;<xref rid="Fig3" ref-type="fig">3</xref>a&#8211;c), whether the alternate allele was common or rare (Fig.&#160;<xref rid="Fig3" ref-type="fig">3</xref>d&#8211;f) and what kind of genomic region or repeat the read originated from Fig.&#160;<xref rid="Fig3" ref-type="fig">3</xref>g&#8211;i. The measurements studied here are the same as those presented in Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>, but filtered as described below.
<fig id="Fig3"><label>Fig. 3</label><caption><p>First row: Results for simulated reads stratified by the number of SNV alternate alternate alleles overlapped by the read. Reads overlapping regions with high DangerTrack [<xref ref-type="bibr" rid="CR13">13</xref>] score&#8212;indicating the regions are difficult to align to&#8212;are omitted. Second row: Results for simulated reads overlapping exactly one common alternate allele (and no other alternate alleles) and reads overlapping exactly one rare allele. Reads overlapping regions with high DangerTrack [<xref ref-type="bibr" rid="CR13">13</xref>] score, indicating the regions are difficult to align to. Third row: Results for simulated reads stratified by region of origin. Regions examined are regions labeled with the &#8220;Alu&#8221; family by RepeatMasker, regions captured by the Nextera exome sequencing protocol (&#8220;Exome&#8221;), and regions labeled with any repeat family by RepeatMasker (&#8220;Rep&#8221;)</p></caption><graphic xlink:href="13059_2018_1595_Fig3_HTML" id="MO3"/></fig>
</p><p>Figure&#160;<xref rid="Fig3" ref-type="fig">3</xref>a&#8211;c shows alignment rate and correctness stratified by the number of non-reference SNVs overlapped by a read. To obtain these subsets, we first removed reads originating from reference-genome regions deemed repetitive by DangerTrack [<xref ref-type="bibr" rid="CR13">13</xref>] (score over 250). We did this after finding that these regions had a combination of low SNV density and repetitive content that caused the 0-SNV stratum to behave very differently from the others. Reads containing 1 or more SNVs undergo a rapid increase in alignment rate and correctness from 0 to 10% of SNVs. Beyond 10%, all strata experience a slow decrease in alignment rate and correctness up to 100% of SNVs added. The 0-SNV stratum has decreasing alignment rate and correctness across the whole range, as expected since the addition of variants cannot help (since the reads lack alternate alleles) but can harm alignment by increasing the repetitiveness of the reference. Strata with more SNVs experience a more dramatic rising-and-falling pattern; for the 3-SNV stratum, alignment rate varies from about 80&#8211;98%. While curves for the various strata have different shapes, all peak at a relatively low SNV fraction: 20% or lower.</p><p>Figure&#160;<xref rid="Fig3" ref-type="fig">3</xref>d&#8211;f show alignment rate and correctness for reads containing a single rare SNV allele (1000 Genomes frequency &lt;0.5) versus reads containing a single common SNV allele (&#8805;0.5). In both cases, we considered only reads with a single non-reference allele. Rare-SNV reads peak lower and at a higher SNV fraction than common-SNV reads for both alignment rate and correctness (Fig.&#160;<xref rid="Fig3" ref-type="fig">3</xref>d&#8211;f). This is expected, since the <italic>Pop cov</italic> model prioritizes common over rare SNVs. In other words, by the time a rare variant is added, many common variants have already been added, making the genome more repetitive.</p><p>Figure&#160;<xref rid="Fig3" ref-type="fig">3</xref>h&#8211;j shows alignment rate and correctness for reads stratified by feature of origin. We analyzed reads originating from (a) RepeatMasker-annotated repetitive regions (<ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org">http://www.repeatmasker.org</ext-link>), (b) RepeatMasker-annotated &#8220;Alu&#8221; repeats, (c) regions captured by the Nextera exome sequencing protocol, and (d) all reads.</p><p>Reads from repetitive regions generally had lower alignment rate and correctness compared to all reads. As before, alignment rate and correctness curves peaked at low SNV fractions: 10% or lower. Reads from more repetitive features were more sensitive to the number of variants included in the reference, as evidenced by the vertical spans of the curves.</p><p>In a related experiment, we examined the graph genome&#8217;s effect specifically on the hypervariable MHC region. We simulated reads from NA12878 Chromosome 6 and used HISAT2 to align to both a linear and a graph genome augmented with the top-scoring 10% of SNVs. We visualized the read-alignment pileup in the hypervariable MHC region using IGV [<xref ref-type="bibr" rid="CR51">51</xref>] (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). Qualitatively, the pileup for the augmented reference looks superior&#8212;with more coverage in variant-dense regions and with more even overall coverage&#8212;to the pileup for the linear reference.</p></sec><sec id="Sec13"><title>Ethnicity specificity</title><p>We also studied how ethnicity-specific augmented references, advocated in other studies [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR47">47</xref>], can improve alignment. We used FORGe to select variants from two lists: one with variants drawn from and scored with respect to the overall 1000-Genomes phase-3 callset, and another drawn from and scored for just the CEU individuals. In both cases, variants private to NA12878 and family members were excluded and reads were simulated from NA12878.</p><p>Figure&#160;<xref rid="Fig4" ref-type="fig">4</xref> shows alignment rate and correctness when aligning to CEU-specific and pan-ethnic references. As expected, the CEU-specific reference yielded higher alignment rate and correctness. CEU-specific curves also peaked at lower numbers of SNVs compared to pan-ethnic. However, the differences were only a few hundredths of a percentage point and cover only a small fraction of the remaining distance to the ideal point. Looking at this another way, if we extrapolate the results to a whole-genome DNA sequencing experiment with 40-fold average coverage, around 250,000 alignments would be affected. We return to these small differences in the &#8220;<xref rid="Sec30" ref-type="sec">Discussion</xref>&#8221; section.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Results from chromosome-9 NA12878 simulation when using an ethnicity-specific (&#8220;CEU&#8221;) versus a pan-ethnic (&#8220;All&#8221;) augmented reference. Reads are 100 nt and unpaired and the plots have similar axes as the plots in Fig. 1 panels <bold>a</bold>&#8211;<bold>c</bold>. Since we are assessing two ethnicities, each with a different total number of variants, the horizontal axes in panels <bold>a</bold> and <bold>b</bold> and the peak points in panel (<bold>c</bold>) are labeled with absolute number of variants included rather than percentages</p></caption><graphic xlink:href="13059_2018_1595_Fig4_HTML" id="MO4"/></fig>
</p></sec><sec id="Sec14"><title>Whole human genome</title><sec id="Sec15"><title>Simulated reads</title><p>To show our methods generalize to whole genomes, we repeated experiments like those presented in Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref> using the full GRCh37 reference. We gathered 80.0 million SNVs from the Phase-3 callset of the 1000 Genomes Project [<xref ref-type="bibr" rid="CR3">3</xref>]. We used FORGe&#8217;s <italic>Pop Cov+</italic> model to score SNVs and compiled subsets consisting of the top-scoring 2%, 4%, 6%, 8%, 10%, 15%, and 20% up to 100% in 10 point increments. We built graph-genome indexes for each using HISAT2.</p><p>We used the <italic>Pop Cov+</italic> model because the others required excessive time and/or memory; specifically, the <italic>Pop Cov</italic> model (without blowup avoidance) produced a set of variants that HISAT2 was unable to index in a practical time and space budget (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Note S5) and the <italic>Hybrid</italic> and <italic>Hybrid+</italic> models required excessive time for the step that generates the FASTA file for <italic>G</italic>&#8727; due to exponential blowup (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Note S6).</p><p>Figure&#160;<xref rid="Fig5" ref-type="fig">5</xref>a, b plots HISAT2 alignment rate and correctness as a function of the SNV fraction. We aligned 20 million 100 nt unpaired reads from simulated from NA12878. We omitted NA12878 and family members from variant selection. Results using the ideal personalized index are also shown for comparison. Maximal <italic>y</italic>&#8722;<italic>x</italic>, where <italic>y</italic> is the fraction of reads aligned correctly and <italic>x</italic> is the fraction aligned incorrectly, occurred at 10% of SNVs (Fig.&#160;<xref rid="Fig5" ref-type="fig">5</xref>c). Interestingly, the maximal point does not approach the personalized-genome ideal point as closely here as it did for the chromosome-9 experiment (Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>). This seems to be due to the added ambiguity that comes when variants in all non-chromosome-9 portions of the genome are added (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S7).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Results from aligning NA12878-simulated reads to HISAT2 graph genome for the whole GRCh37 genome. Variants were selected using FORGe&#8217;s <italic>Pop Cov+</italic> model. Plots have the same axes as the plots in Fig. 1 panels <bold>a</bold>&#8211;<bold>c</bold>. The green diamond in panel (<bold>c</bold>) shows the result when aligning to a personalized graph genome with exactly the individual&#8217;s variants</p></caption><graphic xlink:href="13059_2018_1595_Fig5_HTML" id="MO5"/></fig>
</p></sec><sec id="Sec16"><title>Platinum reads, SNVs</title><p>We conducted further experiments using a set of 1.57 billion real 100 nt unpaired sequencing reads from the Platinum Genomes Project [<xref ref-type="bibr" rid="CR14">14</xref>] (accession: ERR194147). Like the simulated reads, these also come from NA12878. We gathered a set of 80.0 million SNVs from the 1000 Genomes phase-3 callset, omitting variants private to NA12878 and family members. We again used the <italic>Pop Cov+</italic> model to select variants.</p><p>We cannot assess correctness since the reads were not simulated. Following a prior study [<xref ref-type="bibr" rid="CR34">34</xref>], we measured the number of reads that align uniquely&#8212;where HISAT2 reported exactly one alignment&#8212;versus the number that aligned perfectly, matching the reference exactly with no differences. The goal was to capture the variant-inclusion trade-off; we hypothesized that adding more variants will remove the alignment-score penalty associated with known genetic variants (increasing the number of perfect matches) without increasing reference ambiguity (decreasing the number of unique alignments). As shown in Fig.&#160;<xref rid="Fig6" ref-type="fig">6</xref>a, the points that achieved the peak number of unique plus perfect alignments corresponded to 30% of the SNVs. This fraction is higher than most of our simulated results, perhaps due to the fact that unique-plus-perfect is an imperfect proxy for correct-minus-incorrect (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S8).
<fig id="Fig6"><label>Fig. 6</label><caption><p><bold>a</bold> Perfect/unique alignment results when aligning real reads. The blue curve is parametric, as a function of the fraction of variants included from 0% (bottom left) to 80% (top). The green diamond marks the number perfect and unique mappings for HISAT2&#8217;s custom variant pruning script applied to the set of SNVs and Indels. Graph genomes were built for SNVs alone (red) and for SNVs and Indels (blue), both ranked with the <italic>Pop Cov+</italic> strategy. Blue and red diamonds mark the fractions that achieved the highest sum of unique and perfect alignments. <bold>b</bold> Allelic bias for the 2.07 M heterozygous SNVs that met a minimum coverage threshold of 25 in all experiments. Whiskers show the 5th-to-95th percentile range</p></caption><graphic xlink:href="13059_2018_1595_Fig6_HTML" id="MO6"/></fig>
</p></sec><sec id="Sec17"><title>Platinum reads, SNVs, and indels</title><p>To highlight the effect of including indels in the reference, we repeated the previous experiment but using both SNVs and indels from the 1000 Genomes phase-3 callset. Specifically, we gathered 83.1 million variants, both SNVs and indels, but omitting variants private to NA12878 and family members. We again used the <italic>Pop Cov+</italic> model to select variants. We again plotted the number of reads that aligned uniquely versus the number that aligned perfectly (Fig.&#160;<xref rid="Fig6" ref-type="fig">6</xref>a). The graph genome built from both SNVs and indels achieved peak unique+perfect at 30% of variants, like the graph built from SNVs alone. However, at every percentage it yields more unique and perfect alignments.</p></sec><sec id="Sec18"><title>Reference bias</title><p>We measured how reference bias varies with the fraction of variants included. We analyzed the alignments of the ERR194147 reads to the whole human genome with both SNVs and indels included in in reference. Figure&#160;<xref rid="Fig6" ref-type="fig">6</xref>b shows a series of boxplots summarizing bias at a set of 2.07 million HET SNVs called in NA12878 by the Platinum Genomes Project [<xref ref-type="bibr" rid="CR14">14</xref>]. The set of 2.07M HETs was chosen by taking all HETs covered by at least 25 reads in all of our experiments. Each boxplot summarizes the fraction of REF alleles (<italic>R</italic><italic>E</italic><italic>F</italic>/(<italic>R</italic><italic>E</italic><italic>F</italic>+<italic>A</italic><italic>L</italic><italic>T</italic>)) at the HET site for all 2.07M HETs. As expected, bias decreased as more variants were included. The decrease plateaued at 10&#8211;20% of variants. Beyond 20%, including more variants did further reduce bias, but only slightly. From 20 to 70% of variants the mean decreased by only 0.00011.</p><p>This is consistent with previous results showing that most of the benefit is achieved at a small fraction of variants.</p></sec><sec id="Sec19"><title>HLA typing accuracy</title><p>Finally, to measure FORGe&#8217;s effect on downstream results, we measured how HLA typing recall vary with the fraction of variants included in the reference. We used the same NA12878/ERR194147 alignments evaluated in previous sections, extracted alignments in the MHC region, then provided those alignments to the Kourami [<xref ref-type="bibr" rid="CR28">28</xref>] HLA typing tool to make HLA calls. We repeated this with indexes for all the same variant-inclusion fractions evaluated previously. More details on the HLA typing methodology are described in Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Note S7. In comparison with linear genome, HLA typing recall and accuracy increased substantially when the highest-scoring 10% of SNVs were included in the augmented reference. Recall and average coverage plateaued at larger SNV fractions (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S9). Overall, we see that&#8212;as we observed in other results&#8212;HLA allele recall benefits from the addition of a carefully-chosen fraction of variants, and that a fraction of only 10% is sufficient to achieve peak recall.</p></sec></sec></sec></sec><sec id="Sec20"><title>Methods</title><p>FORGe works in cooperation with a variant-aware read aligner such as HISAT2 [<xref ref-type="bibr" rid="CR25">25</xref>] or the ERG [<xref ref-type="bibr" rid="CR43">43</xref>]. The strategy has two stages. In the <italic>offline</italic> stage, FORGe selects variants to include in the augmented reference based on a variant model &#8212; which predicts the pros and cons of including a variant &#8212; and a variant limit. The model and limit together constitute a <italic>variant inclusion strategy</italic> (VIS) that aims for a balance between accuracy and overhead. Once variants have been selected, the aligner software is used to create an index of the augmented reference. The second stage is an <italic>online</italic> stage where the read aligner aligns reads to the augmented reference using the index.</p><sec id="Sec21"><title>Offline stage</title><p>Inputs to the offline stage consist of (a) a reference genome, (b) variants in VCF format, (c) a VIS, and (d) a window size <italic>s</italic>. The variant inclusion strategy (VIS) consists of a variant model and a limit on the number or fraction of variants to include. The VIS is the user&#8217;s most direct means for balancing blowup and alignment accuracy in the augmented reference. We now propose multiple variant models, each aiming to give higher scores to variants that will impart a greater net benefit when considering accuracy and blowup. The window size <italic>s</italic> is used in three separate places in the software (described below) and should typically be set to the maximum read length.</p><sec id="Sec22"><title>Variant models</title><p>Let <italic>G</italic><sub><italic>ref</italic></sub> denote the linear reference genome and <italic>G</italic><sup>&#8727;</sup> the complete augmented genome including all variants in the population. Let <italic>G</italic> be a possible result of a VIS, i.e., an augmented genome that includes a subset of population variants. For simplicity, assume all variants are SNVs (substitutions). Let a <italic>localized s-mer</italic> &#9001;<italic>s</italic>,<italic>l</italic>&#9002; be a string of length <italic>s</italic> (the configurable windows size) that matches some combination of alleles in an augmented genome <italic>G</italic> starting at offset <italic>l</italic>; we also call these simply &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mers. For instance, if <italic>G</italic> is GATYACA, where Y can be either C or T, then &#9001;GAT,0&#9002;, &#9001;TCA,2&#9002;, and &#9001;TTA,2&#9002; are all &#9001;3,<italic>l</italic>&#9002;-mers of <italic>G</italic>.</p><p>For an &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mer <italic>&#963;</italic>, let <italic>p</italic>(<italic>&#963;</italic>) be the probability a random &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mer drawn from a random individual in the population equals <italic>&#963;</italic>.</p><p>This can be calculated as: 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$p(\langle s, l \rangle) = p_{l}(l) \cdot p_{s}(\langle s, l \rangle) \approx \frac{p_{s}(\langle s, l \rangle)}{|G_{ref}|} $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>&#183;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo><mml:mo>&#8776;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ref</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2018_1595_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>p</italic><sub><italic>l</italic></sub>(<italic>&#963;</italic>) is the probability a random <italic>s</italic>-mer begins at <italic>&#963;</italic>&#8217;s offset, which we approximate by <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {1}{|G_{ref}|}$\end{document}</tex-math><mml:math id="M4"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ref</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2018_1595_Article_IEq1.gif"/></alternatives></inline-formula>. <italic>p</italic><sub><italic>s</italic></sub>(<italic>&#963;</italic>) is the probability a localized <italic>s</italic>-mer starting at <italic>l</italic> has alleles matching <italic>&#963;</italic>&#8217;s.</p><p>We approximate <italic>p</italic><sub><italic>s</italic></sub>(<italic>&#963;</italic>) by assuming independence and multiplying the frequencies of each allele, or, if phasing information is available, by using allele co-occurrence frequencies.</p><sec id="Sec23"><title>Population coverage</title><p>The <italic>population coverage</italic>
<italic>C</italic>(<italic>G</italic>) of an augmented reference <italic>G</italic> is proportional to the population variation included, weighted by allele frequency. Specifically: 
<disp-formula id="Equb"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$C(G) = \sum_{\langle s, l \rangle \in G} p(\langle s, l \rangle) $$ \end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>&#8712;</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2018_1595_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p><p>Note that <italic>C</italic>(<italic>G</italic><sub><italic>ref</italic></sub>)&#8804;<italic>C</italic>(<italic>G</italic>)&#8804;<italic>C</italic>(<italic>G</italic><sup>&#8727;</sup>)=1.</p><p>We want to prioritize alleles according to how much they increase <italic>C</italic>(<italic>G</italic>). To do so accurately, each variant&#8217;s effect on <italic>C</italic>(<italic>G</italic>) must be calculated according to which nearby variants (within <italic>s</italic>&#8722;1 positions) are already in <italic>G</italic>. While this is possible, it requires much recalculation of scores as variants are added to <italic>G</italic>. It also means there is no way to produce a single, static list of per-variant model scores. For these reasons, we instead compute each variant&#8217;s effect on <italic>C</italic>(<italic>G</italic>) assuming that all surrounding variants are already in <italic>G</italic>; in other words, we compute the decrease in <italic>C</italic>(<italic>G</italic>) caused by removing the variant from <italic>G</italic>&#8727;. We call this the <italic>complete graph</italic> assumption.</p><p>Although FORGe is capable of using phasing data&#8212;describing which alleles co-occur on the same haplotype&#8212;the complete graph assumption makes this irrelevant for our calculation here. We do make (optional) use of phasing data in the <italic>Hybrid</italic> model, discussed below.</p></sec><sec id="Sec24"><title>Uniqueness</title><p>The <italic>uniqueness</italic>
<italic>U</italic>(<italic>G</italic>) of a genome <italic>G</italic> decreases as the multiplicities of its <italic>k</italic>-mers increase, i.e., as the genome becomes more repetitive. Let <italic>f</italic><sub><italic>G</italic></sub>(<italic>s</italic>) be the number of &#9001;<italic>s</italic><sup>&#8242;</sup>,<italic>l</italic><sup>&#8242;</sup>&#9002;-mers in genome <italic>G</italic> with <italic>s</italic>=<italic>s</italic><sup>&#8242;</sup>. We define uniqueness of the genome as: 
<disp-formula id="Equc"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$U(G) = \sum_{\langle s, l \rangle \in G} \frac{1}{f_{G}(s)} $$ \end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>U</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>&#8712;</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2018_1595_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> Adding a variant to the genome can either increase or decrease <italic>U</italic>(<italic>G</italic>). Specifically, an &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mer overlapping the variant increases <italic>U</italic>(<italic>G</italic>) if there is no other &#9001;<italic>s</italic><sup>&#8242;</sup>,<italic>l</italic><sup>&#8242;</sup>&#9002;-mers with <italic>s</italic>=<italic>s</italic><sup>&#8242;</sup>. Alternately, an &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mer overlapping the variant decreases <italic>U</italic>(<italic>G</italic>) if there are any other &#9001;<italic>s</italic><sup>&#8242;</sup>,<italic>l</italic><sup>&#8242;</sup>&#9002;-mers with <italic>s</italic>=<italic>s</italic><sup>&#8242;</sup>.</p><p>While we rely on this definition below, we do not expect uniqueness alone to be an effective variant model. This is because for most variants all the added (overlapping) &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mers are unique. All such variants therefore receive an identical score. The hybrid measure, presented next, effectively breaks ties by also considering allele frequency.</p></sec><sec id="Sec25"><title>Hybrid score</title><p>The <italic>hybrid score</italic>
<italic>H</italic>(<italic>G</italic>) of a genome <italic>G</italic> considers both population coverage and uniqueness.</p><p>Again let <italic>f</italic><sub><italic>G</italic></sub>(<italic>s</italic>) be the number of &#9001;<italic>s</italic><sup>&#8242;</sup>,<italic>l</italic><sup>&#8242;</sup>&#9002;-mers in <italic>G</italic> with <italic>s</italic>=<italic>s</italic><sup>&#8242;</sup> and let <italic>p</italic>(&#9001;<italic>s</italic><sup>&#8242;</sup>,<italic>l</italic><sup>&#8242;</sup>&#9002;) be the probability a random &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mer drawn from a random individual equals &#9001;<italic>s</italic><sup>&#8242;</sup>,<italic>l</italic><sup>&#8242;</sup>&#9002;. We define the hybrid measure <italic>H</italic>(<italic>G</italic>) of an augmented reference <italic>G</italic> as 
<disp-formula id="Equd"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$H(G) = \sum_{\langle s, l \rangle \in G} \frac{p(\langle s, l \rangle)}{f_{G}(s)} $$ \end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>&#8712;</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2018_1595_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> Note that this is simply the dot product of the terms from the <italic>C</italic>(<italic>G</italic>) and <italic>U</italic>(<italic>G</italic>) sums.</p><p>For a variant <italic>v</italic>, we wish to compute the increase in <italic>H</italic>(<italic>G</italic>) caused by adding <italic>v</italic>. For each &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mer overlapping <italic>v</italic> and containing the alternate allele, let &#9001;<italic>s</italic>,<italic>l</italic><sub>1</sub>&#9002;,&#9001;<italic>s</italic>,<italic>l</italic><sub>2</sub>&#9002;,...,&#9001;<italic>s</italic>,<italic>l</italic><sub><italic>n</italic></sub>&#9002; be all other &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mers with the same sequence <italic>s</italic>. Before adding <italic>v</italic>, the hybrid score can be written as 
<disp-formula id="Eque"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$C + \sum_{i=1}^{n} \frac{p(\langle s, l_{i} \rangle)}{n} $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2018_1595_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> where <italic>C</italic> is the hybrid-score portion due to the &#9001;<italic>s</italic><sup>&#8242;</sup>,<italic>l</italic>&#9002;-mers with <italic>s</italic><sup>&#8242;</sup>&#8800;<italic>s</italic>. After adding &#9001;<italic>s</italic>,<italic>l</italic>&#9002; to <italic>G</italic>, the score becomes 
<disp-formula id="Equf"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$C + \sum_{i=1}^{n} \frac{p(\langle s, l_{i} \rangle)}{n+1} + \frac{p(\langle s, l \rangle)}{n+1} $$ \end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>C</mml:mi><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2018_1595_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> The change in hybrid score due to the addition of &#9001;<italic>s</italic>,<italic>l</italic>&#9002; is 
<disp-formula id="Equg"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \Delta H_{s,l} &amp;= \sum_{i=1}^{n} \frac{p(\langle s, l_{i} \rangle)}{n+1} + \frac{p(\langle s, l \rangle)}{n+1} - \sum_{i=1}^{n} \frac{p(\langle s, l_{i} \rangle)}{n}\\ &amp;= \frac{p(\langle s, l \rangle) - \frac{1}{n}\sum_{i=1}^{n} p(\langle s, l_{i} \rangle)}{n+1} \end{array} $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>&#916;</mml:mi><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>&#8722;</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2018_1595_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p><p>Assuming each &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mer overlapping variant <italic>v</italic> has a distinct sequence <italic>s</italic>, their <italic>&#916;</italic><italic>H</italic><sub><italic>s</italic>,<italic>l</italic></sub> terms are independent. Thus the total change in hybrid score due to the addition of <italic>v</italic> is the sum of the <italic>&#916;</italic><italic>H</italic><sub><italic>s</italic>,<italic>l</italic></sub>&#8217;s for each &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mer overlapping and including <italic>v</italic>.</p><p>There are a couple caveats to how FORGe implements the hybrid model. First, As with the <italic>Pop Cov</italic> model, we make the complete graph assumption, allowing us to produce a scored variant list without dynamic re-scoring of variants as they are added.</p><p>Second, computing <italic>&#916;</italic><italic>H</italic><sub><italic>s</italic>,<italic>l</italic></sub>&#8217;s for all variants is expensive, since it involves calculating the read probability for each other occurrence of sequence <italic>s</italic> for every overlapping &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mer.</p><p>Instead, we approximate it using average probabilities. Specifically, we pre-calculate <inline-formula id="IEq2"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {p}_{ref}$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ref</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1595_Article_IEq2.gif"/></alternatives></inline-formula>, the average <italic>p</italic>(&#9001;<italic>s</italic>,<italic>l</italic>&#9002;) for all &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mers in <italic>G</italic><sub><italic>ref</italic></sub>, and <inline-formula id="IEq3"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {p}_{*}$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>&#8727;</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1595_Article_IEq3.gif"/></alternatives></inline-formula>, the average <italic>p</italic>(&#9001;<italic>s</italic>,<italic>l</italic>&#9002;) for all &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mers in <italic>G</italic><sup>&#8727;</sup> but not in <italic>G</italic><sub><italic>ref</italic></sub>. We approximate the summation with a weighted average: 
<disp-formula id="Equh"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} \frac{1}{n} \sum_{i=1}^{n} p(\langle s, l_{i} \rangle) \approx \frac{1}{f_{G^{*}}(s)} \left\lbrack (f_{G^{*}}(s) - f_{G_{ref}}(s)) \cdot \bar{p}_{*} + f_{G_{ref}}(s) \cdot \bar{p}_{ref} \right\rbrack \end{aligned} $$ \end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#8721;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>&#9001;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#9002;</mml:mo><mml:mo>)</mml:mo><mml:mo>&#8776;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>&#8727;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>&#8727;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>&#8722;</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ref</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>&#183;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>&#8727;</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ref</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>&#183;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ref</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2018_1595_Article_Equh.gif" position="anchor"/></alternatives></disp-formula> Whereas the complete graph assumption rendered phasing data irrelevant to the <italic>Pop Cov</italic> model, we can use phasing data in the <italic>Hybrid</italic> model. This is because the <italic>Hybrid</italic> model weights the terms of the sum according to their frequency in the genome. By default, FORGe uses phasing information when it is available.</p></sec><sec id="Sec26"><title>Hybrid score implementation</title><p>The Uniqueness and Hybrid models are concerned with <italic>s</italic>-mer counts both in the linear reference genome (<italic>G</italic><sub><italic>ref</italic></sub>) and in the complete augmented reference (<italic>G</italic><sup>&#8727;</sup>). FORGe uses Jellyfish v2.2.6 [<xref ref-type="bibr" rid="CR32">32</xref>] to calculate these counts. Since Jellyfish counts <italic>s</italic>-mers in a FASTA input file, FORGe must first construct an augmented FASTA such that &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mers in this FASTA map one-to-one to &#9001;<italic>s</italic>,<italic>l</italic>&#9002;-mers in <italic>G</italic><sup>&#8727;</sup>. This is also the goal of the Enhanced Reference Genome [<xref ref-type="bibr" rid="CR43">43</xref>] representation, which accomplishes this by adding 2<sup><italic>k</italic></sup>&#8722;1 &#8220;enhanced segments&#8221; for every length-<italic>s</italic> window containing <italic>k</italic> variants. Thus, to obtain <italic>s</italic>-mer counts for <italic>G</italic>&#8727;, we first constructed such as FASTA file using our implementation of the ERG, then counted <italic>s</italic>-mers using Jellyfish.</p><p>Once <italic>s</italic>-mers have been counted, FORGe computes the average probability for reads in the linear reference (<inline-formula id="IEq4"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {p}_{ref}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ref</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1595_Article_IEq4.gif"/></alternatives></inline-formula>) and in the complete augmented reference (<inline-formula id="IEq5"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {p}_{*}$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>&#175;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>&#8727;</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2018_1595_Article_IEq5.gif"/></alternatives></inline-formula>), for use in the <italic>Hybrid</italic> model formula. Finally, we compute the change in <italic>H</italic>(<italic>G</italic>) for each <italic>s</italic>-mer in both and update the <italic>Hybrid</italic> model scores for every variant with an alternate allele in that read. After this, we have the full set of <italic>Hybrid</italic> model scores for all variants.</p></sec><sec id="Sec27"><title>Considering blowup</title><p>Adding variants to the augmented reference increases computational costs, including (a) size of the index on disk, (b) memory footprint during read alignment, and (c) time required for read alignment. We collectively refer to these as &#8220;blowup.&#8221; Blowup is most drastic in genomic regions where variants are densely clustered, driving a exponential increase in the number of allelic combinations possible. A model based purely on minimizing blowup would prioritize isolated variants over those in clusters. We do not expect such a model to perform well on its own, though, since (like the <italic>Uniqueness</italic> model described above) it would fail to prioritize among the isolated variants. For this reason, we sought a way to combine a blowup avoidance strategy with the models already described above.</p></sec><sec id="Sec28"><title>Selecting variants with blowup avoidance</title><p>After ranking variants, FORGe selects the subset of variants to include in the augmented reference. The user specifies either a number or a fraction of all variants to include.</p><p>In the simplest case, variants are chosen in order, starting with the highest-scoring variant, until the desired number have been included.</p><p>As an additional defense against blowup, we also propose a dynamic re-scoring scheme that can be added to an existing model. In this scheme, when a variant is added to the reference, FORGe searches for other variants within <italic>s</italic> nt (the window length) of the added variant that have not yet been selected for addition. These nearby variants are re-scored by multiplying their score by a penalty factor <italic>w</italic>, where 0&lt;<italic>w</italic>&#8804;1. By letting <italic>w</italic> be variable, FORGe can trade off between maximizing the model score and minimizing blowup. <italic>w</italic>=1 maintains the original scores, whereas a penalty near <italic>w</italic>=0 would ensure all isolated variants were added before any neighboring variants. We found that a penalty of <italic>w</italic>=0.5 performed well in practice, and this is FORGe&#8217;s default, used in all experiments performed here. <italic>Pop Cov+</italic> and <italic>Hybrid+</italic> are how we refer to those models when they are combined with this dynamic re-scoring scheme.</p></sec><sec id="Sec29"><title>Breaking ties</title><p>Variants can be given identical scores using these models. For instance, variants with the same allele frequency will receive the same score by the <italic>Pop Cov</italic> model. These ties are broken according to the variants&#8217; position on the genome. We define variant A to be upstream of (and higher priority than) variant B if it is on a lower-numbered chromosome or if its offset is to the left of B&#8217;s.</p></sec></sec></sec></sec><sec id="Sec30" sec-type="discussion"><title>Discussion</title><p>FORGe&#8217;s modeling of positive and negative effects of including genetic variants in an augmented reference yields accuracy-blowup tradeoffs superior to current approaches. We proposed models for prioritizing variants with distinct rationales and strengths. We found repeatedly that the most advantageous set of variants consisted of a fraction (6&#8211;30%) of the variants called in the 1000 Genomes project. This was true across a variety of alignment scenarios: for two different graph alignment methods (HISAT2 and ERG), for both unpaired and paired-end alignment modes, when just SNVs and when both SNVs and indels are included, for both a single human chromosome and for the whole human genome, and for both CEPH and YRI individuals. We also showed that FORGe&#8217;s modeling can substantially improve downstream results related to reference bias and HLA typing, also at relatively low variants-inclusion fractions.</p><p>To test if FORGe&#8217;s results yield a simple filtering rule, we can translate the peak-performing variant inclusion fractions for the <italic>Pop Cov</italic> model into allele frequency thresholds. For the Chromosome-9 NA12878 experiments, the 8% variant inclusion fraction performed best in both the unpaired (Fig.&#160;<xref rid="Fig1" ref-type="fig">1</xref>) and paired-end (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S3) experiments. This translates to an allele frequency threshold of &#8805; 7.42%. For the Chromosome-9 YRI experiment (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S4), the best-performing fraction of 10% translated to an allele frequency threshold of &#8805; 3.76%. While these fall on either side of the 5% threshold used in at least one prior study [<xref ref-type="bibr" rid="CR31">31</xref>], further work is needed to establish whether that or any other simple threshold is justifiable in general. A finer-grained sweep over variant inclusion fractions would yield a sharper threshold, for example. For now, our strategy of gradually introducing variants in the context of a simulation study is both principled and practical.</p><p>FORGe and HISAT2 combine to make a practical graph aligner that works with human data with large variant databases like the 1000 Genomes Phase 3 call set. Using hisat2-build to index a GRCh37-based graph genome with the top 8% of variants from Phase-3 set required 4 h and 165 GB of memory. Aligning 20 million reads to this graph required 19 min and 6.5 GB of memory, about 50% more time and 50% more memory than HISAT2 requires to align to the linear GRCh37 genome. (To prioritize the variants prior to indexing, FORGe required about 110 min on a single processor.) This is competitive with the performance of aligners like Bowtie 2 and BWA-MEM when aligning to the linear reference, suggesting graph-based tools are ready for broader use.</p><p>Though we estimate that the overall improvement in alignment accuracy for a 40 &#215; whole-genome DNA sequencing experiment would lead to 4.8M more correctly aligned reads and 1.2M fewer incorrectly aligned reads, the magnitude of the improvement imparted by modeling variants depends on the genomic region. For some regions and variant classes (rare, isolated SNVs), the benefit is small.</p><p>To improve alignment to these regions might require an iterative approach that aligns to a graph containing known variants, calls donor-specific variants, then realigns to a graph that includes both. Strategies like this are implemented in the GATK HaplotypeCaller [<xref ref-type="bibr" rid="CR10">10</xref>], GraphTyper [<xref ref-type="bibr" rid="CR15">15</xref>] and other tools [<xref ref-type="bibr" rid="CR35">35</xref>]. Better variant models might also benefit these hard cases. Even so, the effects we measured translate into substantial net increases in the number of correctly aligned reads, and the results are pronounced in regions such as MHC as shown by Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figures S6 and S9.</p><p>An ethnicity-specific reference conferred a slight accuracy improvement compared to a pan-ethnic reference with a similar number of variants. This is notable in light of proposals to use ethnicity-specific references [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]. It suggests that the advantages of an inclusive reference, applicable regardless of the donor individual&#8217;s ethnicity, might outweigh the slight accuracy gain that comes with ethnicity-specificity. Also, ethnicity-specific references could be counterproductive or misleading in cases where donor ethnicity is reported incorrectly or where the donor is admixed [<xref ref-type="bibr" rid="CR19">19</xref>].</p><p>The accuracy achieved at relatively small fractions of the 1000 Genomes variants has implications for the design of graph aligners. A central challenge for these tools is to operate efficiently even when variants are densely clustered, causing local explosion in the number of allelic combinations. But our observations that peak accuracy occurs at a relatively small fraction of variants, and that memory footprint increases by a factor of 2 or less at peak accuracy, suggests that this is not a major barrier to practical graph-genome alignment as long as variants are chosen carefully.</p><p>It should also be possible to adapt FORGe to study how including structural variants can improve alignment. A common observation of studies that have assembled human genomes from long reads is that the assemblies contain many megabases of sequence not present in the standard human reference [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. The models we propose are equally applicable to structural variants, assuming the variants are called in enough individuals to estimate allele frequencies accurately.</p><p>While we primarily investigated unpaired alignment here, we also showed that the chromosome-9 results generalized to paired-end alignment (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Generally speaking, this work can be adapted to paired-end alignment, with the main issue being how to adjust the method&#8217;s window lengths as a function of the paired-end dataset&#8217;s read and fragment lengths. The windows in question are (a) the <italic>s</italic>-mer length used in the model, (b) the maximum window length used when forming enhanced segments for ERG-based alignment, and (c) for blowup avoidance in the <italic>Pop Cov+</italic> and <italic>Hybrid+</italic> models, the radius to look within when seeking nearby variants to deprioritize. While one option is to simply increase the window size to the maximum fragment length, that can easily lead to an unacceptable blowup penalty. For this reason, we suspect that there is no practical way to adapt our ERG-based to paired-end alignment; rather, as we explain, we think it is best viewed as a model for the seed-finding step of a seed-and-extend aligner that might itself handle paired ends. Initial experiments suggest that it is practical to leave the window lengths relatively short&#8212;the length of a read rather than a fragment&#8212;when using HISAT2 for paired-end alignment (Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Further exploration is needed to more fully characterize the relationship between FORGe window length and fragment and read lengths for paired-end reads.</p><p>While we found that including FORGe-selected variants improved results for a downstream HLA-typing method, we also found the method failed to achieve perfect accuracy based only on HISAT2+FORGe&#8217;s alignments. This was likely because one of NA12878&#8217;s HLA alleles (DQB1*02:01) was so different from the reference&#8212;even after including the FORGe-selected variants&#8212;that its identifying reads failed to align (see Additional file&#160;<xref rid="MOESM1" ref-type="media">1</xref>: Note S7). This highlights the continued importance of other alignment methods that use alternate assemblies such as the GRCh38 ALT loci [<xref ref-type="bibr" rid="CR7">7</xref>] or that can align to graphs that include larger-scale variation [<xref ref-type="bibr" rid="CR18">18</xref>] in addition to relatively small variants studied here and in the 1000 Genomes Project.</p></sec><sec sec-type="supplementary-material"><title>Additional file</title><sec id="Sec31"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="13059_2018_1595_MOESM1_ESM.pdf"><label>Additional file 1</label><caption><p>Supplementary information. Contains Notes S1&#8211;S7 and Figures S1&#8211;S9. (PDF 620 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><fn-group><fn><p><bold>Availability of data and materials</bold></p><p>The FORGe software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/langmead-lab/FORGe/releases/tag/v1.1">https://github.com/langmead-lab/FORGe/releases/tag/v1.1</ext-link>
under the open source MIT license. It is written in Python and was tested on Linux and Mac operating systems. An archival version of the software evaluated here is at 10.5281/zenodo.1482926
[<xref ref-type="bibr" rid="CR40">40</xref>]. The FORGe repo also includes our implementation of the Enhanced Reference Genome, originally proposed by Satya et al. [<xref ref-type="bibr" rid="CR43">43</xref>]. The experiments described in this paper are open source under the open source MIT license and available at <ext-link ext-link-type="uri" xlink:href="https://github.com/langmead-lab/FORGe-experiments">https://github.com/langmead-lab/FORGe-experiments</ext-link>. An archival version of this software is available at doi: 10.5281/zenodo.1482928 [<xref ref-type="bibr" rid="CR42">42</xref>]. We provide three variant datasets and HISAT2 indexes, available at <ext-link ext-link-type="uri" xlink:href="https://www.ftp://ftp.ccb.jhu.edu/pub/langmead/forge">ftp://ftp.ccb.jhu.edu/pub/langmead/forge</ext-link> and at the listed DOIs. These include the optimal graph genomes described above for chromosome 9 using only SNVs (NA12878_chr9 subdirectory or 10.6084/m9.figshare.7325831
[<xref ref-type="bibr" rid="CR38">38</xref>]), for chromosome 9 using SNVs and indels (NA12878_chr9_indels subdirectory or 10.6084/m9.figshare.7325837
[<xref ref-type="bibr" rid="CR37">37</xref>]), and for the full genome (NA12878_full_genome subdirectory or 10.6084/m9.figshare.7325840
[<xref ref-type="bibr" rid="CR39">39</xref>]), all with NA12878 and family members withheld. We also provide what we consider the best full genome graph, derived from all 1000 Genomes SNVs and indels from all individuals and all populations using the <italic>Pop Cov+</italic> strategy and taking the top 10% of variants (best_full_genome subdirectory or 10.6084/m9.figshare.7327016
[<xref ref-type="bibr" rid="CR41">41</xref>]). The variants and index files in the (best_full_genome subdirectory) are the ones we suggest others use for future studies.</p></fn></fn-group><ack><title>Acknowledgements</title><p>We thank Daehwan Kim and Michael Schatz for their helpful comments on a draft of this manuscript.</p><sec id="d29e3285"><title>Funding</title><p>JP and BL were supported by National Science Foundation grant IIS-1349906 and National Institutes of Health/National Institute of General Medical Sciences grant R01GM118568.</p></sec></ack><notes notes-type="author-contribution"><title>Authors&#8217; contributions</title><p>JP and BL designed the method and wrote the software. NC designed and executed the HLA typing experiment. JP, BL, and NC wrote the manuscript. All authors read and approved the final manuscript.</p></notes><notes notes-type="COI-statement"><sec><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec><title>Consent for publication</title><p>Not applicable.</p></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Publisher&#8217;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altshuler</surname><given-names>DM</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Peltonen</surname><given-names>L</given-names></name><name><surname>Altshuler</surname><given-names>DM</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Peltonen</surname><given-names>L</given-names></name><name><surname>Dermitzakis</surname><given-names>E</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Yu</surname><given-names>F</given-names></name><name><surname>Peltonen</surname><given-names>L</given-names></name><name><surname>Dermitzakis</surname><given-names>E</given-names></name><name><surname>Bonnen</surname><given-names>PE</given-names></name><name><surname>Altshuler</surname><given-names>DM</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>de Bakker</surname><given-names>PI</given-names></name><name><surname>Deloukas</surname><given-names>P</given-names></name><name><surname>Gabriel</surname><given-names>SB</given-names></name><name><surname>Gwilliam</surname><given-names>R</given-names></name><name><surname>Hunt</surname><given-names>S</given-names></name><name><surname>Inouye</surname><given-names>M</given-names></name><name><surname>Jia</surname><given-names>X</given-names></name><name><surname>Palotie</surname><given-names>A</given-names></name><name><surname>Parkin</surname><given-names>M</given-names></name><name><surname>Whittaker</surname><given-names>P</given-names></name><name><surname>Yu</surname><given-names>F</given-names></name><name><surname>Chang</surname><given-names>K</given-names></name><name><surname>Hawes</surname><given-names>A</given-names></name><name><surname>Lewis</surname><given-names>LR</given-names></name><name><surname>Ren</surname><given-names>Y</given-names></name><name><surname>Wheeler</surname><given-names>D</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Muzny</surname><given-names>DM</given-names></name><name><surname>Barnes</surname><given-names>C</given-names></name><name><surname>Darvishi</surname><given-names>K</given-names></name><name><surname>Hurles</surname><given-names>M</given-names></name><name><surname>Korn</surname><given-names>JM</given-names></name><name><surname>Kristiansson</surname><given-names>K</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>McCarrol</surname><given-names>SA</given-names></name><name><surname>Nemesh</surname><given-names>J</given-names></name><name><surname>Dermitzakis</surname><given-names>E</given-names></name><name><surname>Keinan</surname><given-names>A</given-names></name><name><surname>Montgomery</surname><given-names>SB</given-names></name><name><surname>Pollack</surname><given-names>S</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Soranzo</surname><given-names>N</given-names></name><name><surname>Bonnen</surname><given-names>PE</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Gonzaga-Jauregui</surname><given-names>C</given-names></name><name><surname>Keinan</surname><given-names>A</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Yu</surname><given-names>F</given-names></name><name><surname>Anttila</surname><given-names>V</given-names></name><name><surname>Brodeur</surname><given-names>W</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name><name><surname>Leslie</surname><given-names>S</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name><name><surname>Moutsianas</surname><given-names>L</given-names></name><name><surname>Nguyen</surname><given-names>H</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Ghori</surname><given-names>MJ</given-names></name><name><surname>McGinnis</surname><given-names>R</given-names></name><name><surname>McLaren</surname><given-names>W</given-names></name><name><surname>Pollack</surname><given-names>S</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Schaffner</surname><given-names>SF</given-names></name><name><surname>Takeuchi</surname><given-names>F</given-names></name><name><surname>Grossman</surname><given-names>SR</given-names></name><name><surname>Shlyakhter</surname><given-names>I</given-names></name><name><surname>Hostetter</surname><given-names>EB</given-names></name><name><surname>Sabeti</surname><given-names>PC</given-names></name><name><surname>Adebamowo</surname><given-names>CA</given-names></name><name><surname>Foster</surname><given-names>MW</given-names></name><name><surname>Gordon</surname><given-names>DR</given-names></name><name><surname>Licinio</surname><given-names>J</given-names></name><name><surname>Manca</surname><given-names>MC</given-names></name><name><surname>Marshall</surname><given-names>PA</given-names></name><name><surname>Matsuda</surname><given-names>I</given-names></name><name><surname>Ngare</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>VO</given-names></name><name><surname>Reddy</surname><given-names>D</given-names></name><name><surname>Rotimi</surname><given-names>CN</given-names></name><name><surname>Royal</surname><given-names>CD</given-names></name><name><surname>Sharp</surname><given-names>RR</given-names></name><name><surname>Zeng</surname><given-names>C</given-names></name><name><surname>Brooks</surname><given-names>LD</given-names></name><name><surname>McEwen</surname><given-names>JE</given-names></name></person-group><article-title>Integrating common and rare genetic variation in diverse human populations</article-title><source>Nature</source><year>2010</year><volume>467</volume><issue>7311</issue><fpage>52</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/nature09298</pub-id><pub-id pub-id-type="pmid">20811451</pub-id></element-citation></ref><ref id="CR2"><label>2</label><mixed-citation publication-type="other">Ameur A, Che H, Martin M, Bunikis I, Dahlberg J, H&#246;ijer I, H&#228;ggqvist S, Vezzi F, Nordlund J, Olason P, Feuk L, Gyllensten U. De novo assembly of two swedish genomes reveals missing segments from the human grch38 reference and improves variant calling of population-scale sequencing data. 2018.</mixed-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Auton</surname><given-names>AEA</given-names></name></person-group><article-title>A global reference for human genetic variation</article-title><source>Nature</source><year>2015</year><volume>526</volume><issue>7571</issue><fpage>68</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1038/nature15393</pub-id><pub-id pub-id-type="pmid">26432245</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brandt</surname><given-names>DY</given-names></name><name><surname>Aguiar</surname><given-names>VR</given-names></name><name><surname>Bitarello</surname><given-names>BD</given-names></name><name><surname>Nunes</surname><given-names>K</given-names></name><name><surname>Goudet</surname><given-names>J</given-names></name><name><surname>Meyer</surname><given-names>D</given-names></name></person-group><article-title>Mapping bias overestimates reference allele frequencies at the HLA Genes in the 1000 Genomes Project Phase I Data</article-title><source>G3 (Bethesda)</source><year>2015</year><volume>5</volume><issue>5</issue><fpage>931</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.1534/g3.114.015784</pub-id><pub-id pub-id-type="pmid">25787242</pub-id></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chaisson</surname><given-names>MJ</given-names></name><name><surname>Huddleston</surname><given-names>J</given-names></name><name><surname>Dennis</surname><given-names>MY</given-names></name><name><surname>Sudmant</surname><given-names>PH</given-names></name><name><surname>Malig</surname><given-names>M</given-names></name><name><surname>Hormozdiari</surname><given-names>F</given-names></name><name><surname>Antonacci</surname><given-names>F</given-names></name><name><surname>Surti</surname><given-names>U</given-names></name><name><surname>Sandstrom</surname><given-names>R</given-names></name><name><surname>Boitano</surname><given-names>M</given-names></name><name><surname>Landolin</surname><given-names>JM</given-names></name><name><surname>Stamatoyannopoulos</surname><given-names>JA</given-names></name><name><surname>Hunkapiller</surname><given-names>MW</given-names></name><name><surname>Korlach</surname><given-names>J</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name></person-group><article-title>Resolving the complexity of the human genome using single-molecule sequencing</article-title><source>Nature</source><year>2015</year><volume>517</volume><issue>7536</issue><fpage>608</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1038/nature13907</pub-id><pub-id pub-id-type="pmid">25383537</pub-id></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Church</surname><given-names>DM</given-names></name><name><surname>Schneider</surname><given-names>VA</given-names></name><name><surname>Graves</surname><given-names>T</given-names></name><name><surname>Auger</surname><given-names>K</given-names></name><name><surname>Cunningham</surname><given-names>F</given-names></name><name><surname>Bouk</surname><given-names>N</given-names></name><name><surname>Chen</surname><given-names>HC</given-names></name><name><surname>Agarwala</surname><given-names>R</given-names></name><name><surname>McLaren</surname><given-names>WM</given-names></name><name><surname>Ritchie</surname><given-names>GR</given-names></name><name><surname>Albracht</surname><given-names>D</given-names></name><name><surname>Kremitzki</surname><given-names>M</given-names></name><name><surname>Rock</surname><given-names>S</given-names></name><name><surname>Kotkiewicz</surname><given-names>H</given-names></name><name><surname>Kremitzki</surname><given-names>C</given-names></name><name><surname>Wollam</surname><given-names>A</given-names></name><name><surname>Trani</surname><given-names>L</given-names></name><name><surname>Fulton</surname><given-names>L</given-names></name><name><surname>Fulton</surname><given-names>R</given-names></name><name><surname>Matthews</surname><given-names>L</given-names></name><name><surname>Whitehead</surname><given-names>S</given-names></name><name><surname>Chow</surname><given-names>W</given-names></name><name><surname>Torrance</surname><given-names>J</given-names></name><name><surname>Dunn</surname><given-names>M</given-names></name><name><surname>Harden</surname><given-names>G</given-names></name><name><surname>Threadgold</surname><given-names>G</given-names></name><name><surname>Wood</surname><given-names>J</given-names></name><name><surname>Collins</surname><given-names>J</given-names></name><name><surname>Heath</surname><given-names>P</given-names></name><name><surname>Griffiths</surname><given-names>G</given-names></name><name><surname>Pelan</surname><given-names>S</given-names></name><name><surname>Grafham</surname><given-names>D</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name><name><surname>Weinstock</surname><given-names>G</given-names></name><name><surname>Mardis</surname><given-names>ER</given-names></name><name><surname>Wilson</surname><given-names>RK</given-names></name><name><surname>Howe</surname><given-names>K</given-names></name><name><surname>Flicek</surname><given-names>P</given-names></name><name><surname>Hubbard</surname><given-names>T</given-names></name></person-group><article-title>Modernizing reference genome assemblies</article-title><source>PLoS Biol</source><year>2011</year><volume>9</volume><issue>7</issue><fpage>e1001091</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.1001091</pub-id><pub-id pub-id-type="pmid">21750661</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Church</surname><given-names>DM</given-names></name><name><surname>Schneider</surname><given-names>VA</given-names></name><name><surname>Steinberg</surname><given-names>KM</given-names></name><name><surname>Schatz</surname><given-names>MC</given-names></name><name><surname>Quinlan</surname><given-names>AR</given-names></name><name><surname>Chin</surname><given-names>CS</given-names></name><name><surname>Kitts</surname><given-names>PA</given-names></name><name><surname>Aken</surname><given-names>B</given-names></name><name><surname>Marth</surname><given-names>GT</given-names></name><name><surname>Hoffman</surname><given-names>MM</given-names></name><name><surname>Herrero</surname><given-names>J</given-names></name><name><surname>Mendoza</surname><given-names>ML</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name><name><surname>Flicek</surname><given-names>P</given-names></name></person-group><article-title>Extending reference assembly models</article-title><source>Genome Biol</source><year>2015</year><volume>16</volume><fpage>13</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0587-3</pub-id><pub-id pub-id-type="pmid">25651527</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danek</surname><given-names>A</given-names></name><name><surname>Deorowicz</surname><given-names>S</given-names></name><name><surname>Grabowski</surname><given-names>S</given-names></name></person-group><article-title>Indexes of large genome collections on a PC</article-title><source>PLoS ONE</source><year>2014</year><volume>9</volume><issue>10</issue><fpage>e109384</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0109384</pub-id><pub-id pub-id-type="pmid">25289699</pub-id></element-citation></ref><ref id="CR9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Degner</surname><given-names>JF</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Pai</surname><given-names>AA</given-names></name><name><surname>Pickrell</surname><given-names>JK</given-names></name><name><surname>Nkadori</surname><given-names>E</given-names></name><name><surname>Gilad</surname><given-names>Y</given-names></name><name><surname>Pritchard</surname><given-names>JK</given-names></name></person-group><article-title>Effect of read-mapping biases on detecting allele-specific expression from RNA-sequencing data</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>24</issue><fpage>3207</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp579</pub-id><pub-id pub-id-type="pmid">19808877</pub-id></element-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>Poplin</surname><given-names>R</given-names></name><name><surname>Garimella</surname><given-names>KV</given-names></name><name><surname>Maguire</surname><given-names>JR</given-names></name><name><surname>Hartl</surname><given-names>C</given-names></name><name><surname>Philippakis</surname><given-names>AA</given-names></name><name><surname>del Angel</surname><given-names>G</given-names></name><name><surname>Rivas</surname><given-names>MA</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Fennell</surname><given-names>TJ</given-names></name><name><surname>Kernytsky</surname><given-names>AM</given-names></name><name><surname>Sivachenko</surname><given-names>AY</given-names></name><name><surname>Cibulskis</surname><given-names>K</given-names></name><name><surname>Gabriel</surname><given-names>SB</given-names></name><name><surname>Altshuler</surname><given-names>D</given-names></name><name><surname>Daly</surname><given-names>MJ</given-names></name></person-group><article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title><source>Nat Genet</source><year>2011</year><volume>43</volume><issue>5</issue><fpage>491</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/ng.806</pub-id><pub-id pub-id-type="pmid">21478889</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dewey</surname><given-names>FE</given-names></name><name><surname>Chen</surname><given-names>R</given-names></name><name><surname>Cordero</surname><given-names>SP</given-names></name><name><surname>Ormond</surname><given-names>KE</given-names></name><name><surname>Caleshu</surname><given-names>C</given-names></name><name><surname>Karczewski</surname><given-names>KJ</given-names></name><name><surname>Whirl-Carrillo</surname><given-names>M</given-names></name><name><surname>Wheeler</surname><given-names>MT</given-names></name><name><surname>Dudley</surname><given-names>JT</given-names></name><name><surname>Byrnes</surname><given-names>JK</given-names></name><name><surname>Cornejo</surname><given-names>OE</given-names></name><name><surname>Knowles</surname><given-names>JW</given-names></name><name><surname>Woon</surname><given-names>M</given-names></name><name><surname>Sangkuhl</surname><given-names>K</given-names></name><name><surname>Gong</surname><given-names>L</given-names></name><name><surname>Thorn</surname><given-names>CF</given-names></name><name><surname>Hebert</surname><given-names>JM</given-names></name><name><surname>Capriotti</surname><given-names>E</given-names></name><name><surname>David</surname><given-names>SP</given-names></name><name><surname>Pavlovic</surname><given-names>A</given-names></name><name><surname>West</surname><given-names>A</given-names></name><name><surname>Thakuria</surname><given-names>JV</given-names></name><name><surname>Ball</surname><given-names>MP</given-names></name><name><surname>Zaranek</surname><given-names>AW</given-names></name><name><surname>Rehm</surname><given-names>HL</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name><name><surname>West</surname><given-names>JS</given-names></name><name><surname>Bustamante</surname><given-names>CD</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name><name><surname>Altman</surname><given-names>RB</given-names></name><name><surname>Klein</surname><given-names>TE</given-names></name><name><surname>Butte</surname><given-names>AJ</given-names></name><name><surname>Ashley</surname><given-names>EA</given-names></name></person-group><article-title>Phased whole-genome genetic risk in a family quartet using a major allele reference sequence</article-title><source>PLoS Genet</source><year>2011</year><volume>7</volume><issue>9</issue><fpage>e1002280</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1002280</pub-id><pub-id pub-id-type="pmid">21935354</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dilthey</surname><given-names>A</given-names></name><name><surname>Cox</surname><given-names>C</given-names></name><name><surname>Iqbal</surname><given-names>Z</given-names></name><name><surname>Nelson</surname><given-names>MR</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name></person-group><article-title>Improved genome inference in the MHC using a population reference graph</article-title><source>Nat Genet</source><year>2015</year><volume>47</volume><issue>6</issue><fpage>682</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/ng.3257</pub-id><pub-id pub-id-type="pmid">25915597</pub-id></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dolgalev</surname><given-names>I</given-names></name><name><surname>Sedlazeck</surname><given-names>F</given-names></name><name><surname>Busby</surname><given-names>B</given-names></name></person-group><article-title>DangerTrack: a scoring system to detect difficult-to-assess regions</article-title><source>F1000Res</source><year>2017</year><volume>6</volume><fpage>443</fpage><pub-id pub-id-type="doi">10.12688/f1000research.11254.1</pub-id><pub-id pub-id-type="pmid">28503299</pub-id></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eberle</surname><given-names>MA</given-names></name><name><surname>Fritzilas</surname><given-names>E</given-names></name><name><surname>Krusche</surname><given-names>P</given-names></name><name><surname>Kallberg</surname><given-names>M</given-names></name><name><surname>Moore</surname><given-names>BL</given-names></name><name><surname>Bekritsky</surname><given-names>MA</given-names></name><name><surname>Iqbal</surname><given-names>Z</given-names></name><name><surname>Chuang</surname><given-names>HY</given-names></name><name><surname>Humphray</surname><given-names>SJ</given-names></name><name><surname>Halpern</surname><given-names>AL</given-names></name><name><surname>Kruglyak</surname><given-names>S</given-names></name><name><surname>Margulies</surname><given-names>EH</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name><name><surname>Bentley</surname><given-names>DR</given-names></name></person-group><article-title>A reference data set of 5.4 million phased human variants validated by genetic inheritance from sequencing a three-generation 17-member pedigree</article-title><source>Genome Res</source><year>2017</year><volume>27</volume><issue>1</issue><fpage>157</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.1101/gr.210500.116</pub-id><pub-id pub-id-type="pmid">27903644</pub-id></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eggertsson</surname><given-names>HP</given-names></name><name><surname>Jonsson</surname><given-names>H</given-names></name><name><surname>Kristmundsdottir</surname><given-names>S</given-names></name><name><surname>Hjartarson</surname><given-names>E</given-names></name><name><surname>Kehr</surname><given-names>B</given-names></name><name><surname>Masson</surname><given-names>G</given-names></name><name><surname>Zink</surname><given-names>F</given-names></name><name><surname>Hjorleifsson</surname><given-names>KE</given-names></name><name><surname>Jonasdottir</surname><given-names>A</given-names></name><name><surname>Jonasdottir</surname><given-names>A</given-names></name><name><surname>Jonsdottir</surname><given-names>I</given-names></name><name><surname>Gudbjartsson</surname><given-names>DF</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><name><surname>Stefansson</surname><given-names>K</given-names></name><name><surname>Halldorsson</surname><given-names>BV</given-names></name></person-group><article-title>Graphtyper enables population-scale genotyping using pangenome graphs</article-title><source>Nat Genet</source><year>2017</year><volume>49</volume><issue>11</issue><fpage>1654</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1038/ng.3964</pub-id><pub-id pub-id-type="pmid">28945251</pub-id></element-citation></ref><ref id="CR16"><label>16</label><mixed-citation publication-type="other">Ferragina P, Manzini G. Opportunistic data structures with applications. In: Foundations of Computer Science, 2000. Proceedings. 41st Annual Symposium on. IEEE: 2000. p. 390&#8211;398.</mixed-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gan</surname><given-names>X</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Behr</surname><given-names>J</given-names></name><name><surname>Steffen</surname><given-names>JG</given-names></name><name><surname>Drewe</surname><given-names>P</given-names></name><name><surname>Hildebrand</surname><given-names>KL</given-names></name><name><surname>Lyngsoe</surname><given-names>R</given-names></name><name><surname>Schultheiss</surname><given-names>SJ</given-names></name><name><surname>Osborne</surname><given-names>EJ</given-names></name><name><surname>Sreedharan</surname><given-names>VT</given-names></name><name><surname>Kahles</surname><given-names>A</given-names></name><name><surname>Bohnert</surname><given-names>R</given-names></name><name><surname>Jean</surname><given-names>G</given-names></name><name><surname>Derwent</surname><given-names>P</given-names></name><name><surname>Kersey</surname><given-names>P</given-names></name><name><surname>Belfield</surname><given-names>EJ</given-names></name><name><surname>Harberd</surname><given-names>NP</given-names></name><name><surname>Kemen</surname><given-names>E</given-names></name><name><surname>Toomajian</surname><given-names>C</given-names></name><name><surname>Kover</surname><given-names>PX</given-names></name><name><surname>Clark</surname><given-names>RM</given-names></name><name><surname>Ratsch</surname><given-names>G</given-names></name><name><surname>Mott</surname><given-names>R</given-names></name></person-group><article-title>Multiple reference genomes and transcriptomes for Arabidopsis thaliana</article-title><source>Nature</source><year>2011</year><volume>477</volume><issue>7365</issue><fpage>419</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1038/nature10414</pub-id><pub-id pub-id-type="pmid">21874022</pub-id></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrison</surname><given-names>E</given-names></name><name><surname>Siren</surname><given-names>J</given-names></name><name><surname>Novak</surname><given-names>AM</given-names></name><name><surname>Hickey</surname><given-names>G</given-names></name><name><surname>Eizenga</surname><given-names>JM</given-names></name><name><surname>Dawson</surname><given-names>ET</given-names></name><name><surname>Jones</surname><given-names>W</given-names></name><name><surname>Garg</surname><given-names>S</given-names></name><name><surname>Markello</surname><given-names>C</given-names></name><name><surname>Lin</surname><given-names>MF</given-names></name><name><surname>Paten</surname><given-names>B</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Variation graph toolkit improves read mapping by representing genetic variation in the reference</article-title><source>Nat Biotechnol</source><year>2018</year><volume>36</volume><issue>9</issue><fpage>875</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1038/nbt.4227</pub-id><pub-id pub-id-type="pmid">30125266</pub-id></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Genovese</surname><given-names>G</given-names></name><name><surname>Handsaker</surname><given-names>RE</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Altemose</surname><given-names>N</given-names></name><name><surname>Lindgren</surname><given-names>AM</given-names></name><name><surname>Chambert</surname><given-names>K</given-names></name><name><surname>Pasaniuc</surname><given-names>B</given-names></name><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Reich</surname><given-names>D</given-names></name><name><surname>Morton</surname><given-names>CC</given-names></name><name><surname>Pollak</surname><given-names>MR</given-names></name><name><surname>Wilson</surname><given-names>JG</given-names></name><name><surname>McCarroll</surname><given-names>SA</given-names></name></person-group><article-title>Using population admixture to help complete maps of the human genome</article-title><source>Nat Genet</source><year>2013</year><volume>45</volume><issue>4</issue><fpage>406</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1038/ng.2565</pub-id><pub-id pub-id-type="pmid">23435088</pub-id></element-citation></ref><ref id="CR20"><label>20</label><mixed-citation publication-type="other">Holtgrewe M. Mason&#8211;a read simulator for second generation sequencing data. Technical Report FU Berlin. 2010.</mixed-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>L</given-names></name><name><surname>Popic</surname><given-names>V</given-names></name><name><surname>Batzoglou</surname><given-names>S</given-names></name></person-group><article-title>Short read alignment with populations of genomes</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><issue>13</issue><fpage>i361</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btt215</pub-id><pub-id pub-id-type="pmid">23813006</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iqbal</surname><given-names>Z</given-names></name><name><surname>Caccamo</surname><given-names>M</given-names></name><name><surname>Turner</surname><given-names>I</given-names></name><name><surname>Flicek</surname><given-names>P</given-names></name><name><surname>McVean</surname><given-names>G</given-names></name></person-group><article-title>De novo assembly and genotyping of variants using colored de Bruijn graphs</article-title><source>Nat Genet</source><year>2012</year><volume>44</volume><issue>2</issue><fpage>226</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1038/ng.1028</pub-id><pub-id pub-id-type="pmid">22231483</pub-id></element-citation></ref><ref id="CR23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karthikeyan</surname><given-names>S</given-names></name><name><surname>Bawa</surname><given-names>PS</given-names></name><name><surname>Srinivasan</surname><given-names>S</given-names></name></person-group><article-title>hg19K: addressing a significant lacuna in hg19-based variant calling</article-title><source>Mol Genet Genomic Med</source><year>2017</year><volume>5</volume><issue>1</issue><fpage>15</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1002/mgg3.251</pub-id><pub-id pub-id-type="pmid">28116326</pub-id></element-citation></ref><ref id="CR24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>HISAT: a fast spliced aligner with low memory requirements</article-title><source>Nat Methods</source><year>2015</year><volume>12</volume><issue>4</issue><fpage>357</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id><pub-id pub-id-type="pmid">25751142</pub-id></element-citation></ref><ref id="CR25"><label>25</label><mixed-citation publication-type="other">Kim D, Paggi J, Salzberg S. Hisat-genotype: next generation genomic analysis platform on a personal computer. bioRxiv. 2018.</mixed-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name></person-group><article-title>A tandem simulation framework for predicting mapping quality</article-title><source>Genome Biol</source><year>2017</year><volume>18</volume><issue>1</issue><fpage>152</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1290-3</pub-id><pub-id pub-id-type="pmid">28806977</pub-id></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Pop</surname><given-names>M</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title><source>Genome Biol</source><year>2009</year><volume>10</volume><issue>3</issue><fpage>R25</fpage><pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id><pub-id pub-id-type="pmid">19261174</pub-id></element-citation></ref><ref id="CR28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>H</given-names></name><name><surname>Kingsford</surname><given-names>C</given-names></name></person-group><article-title>Kourami: graph-guided assembly for novel human leukocyte antigen allele discovery</article-title><source>Genome Biol</source><year>2018</year><volume>19</volume><issue>1</issue><fpage>16</fpage><pub-id pub-id-type="doi">10.1186/s13059-018-1388-2</pub-id><pub-id pub-id-type="pmid">29415772</pub-id></element-citation></ref><ref id="CR29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title><source>Genome Res</source><year>2008</year><volume>18</volume><issue>11</issue><fpage>1851</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1101/gr.078212.108</pub-id><pub-id pub-id-type="pmid">18714091</pub-id></element-citation></ref><ref id="CR30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Guo</surname><given-names>H</given-names></name><name><surname>Brudno</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name></person-group><article-title>deBGA: read alignment with de Bruijn graph-based seed and extension</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><issue>21</issue><fpage>3224</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw371</pub-id><pub-id pub-id-type="pmid">27378303</pub-id></element-citation></ref><ref id="CR31"><label>31</label><mixed-citation publication-type="other">Maciuca S, del Ojo Elias C, McVean G, Iqbal Z. A natural encoding of genetic variation in a burrows-wheeler transform to enable mapping and genome inference. In: International Workshop on Algorithms in Bioinformatics. Springer: 2016. p. 222&#8211;33.</mixed-citation></ref><ref id="CR32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marcais</surname><given-names>G</given-names></name><name><surname>Kingsford</surname><given-names>C</given-names></name></person-group><article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><issue>6</issue><fpage>764</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr011</pub-id><pub-id pub-id-type="pmid">21217122</pub-id></element-citation></ref><ref id="CR33"><label>33</label><mixed-citation publication-type="other">Maretty L, Jensen JM, Petersen B, Sibbesen JA, Liu S, Villesen P, Skov L, Belling K, Theil Have C, Izarzugaza JMG, Grosjean M, Bork-Jensen J, Grove J, Als TD, Huang S, Chang Y, Xu R, Ye W, Rao J, Guo X, Sun J, Cao H, Ye C, van Beusekom J, Espeseth T, Flindt E, Friborg RM, Halager AE, Le Hellard S, Hultman CM, Lescai F, Li S, Lund O, L?ngren P, Mailund T, Matey-Hernandez ML, Mors O, Pedersen CNS, Sicheritz-Ponten T, Sullivan P, Syed A, Westergaard D, Yadav R, Li N, Xu X, Hansen T, Krogh A, Bolund L, S?rensen TIA, Pedersen O, Gupta R, Rasmussen S, Besenbacher S, B?rglum AD, Wang J, Eiberg H, Kristiansen K, Brunak S, Schierup MH. Sequencing and de novo assembly of 150 genomes from Denmark as a population reference. Nature. 2017; 548(7665):87&#8211;91.</mixed-citation></ref><ref id="CR34"><label>34</label><mixed-citation publication-type="other">Novak AM, Hickey G, Garrison E, Blum S, Connelly A, Dilthey A, Eizenga J, Elmohamed MAS, Guthrie S, Kahles A, Keenan S, Kelleher J, Kural D, Li H, Lin MF, Miga K, Ouyang N, Rakocevic G, Smuga-Otto M, Zaranek AW, Durbin R, McVean G, Haussler D, Paten B. Genome graphs. BioRxiv. 2017.</mixed-citation></ref><ref id="CR35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otto</surname><given-names>TD</given-names></name><name><surname>Sanders</surname><given-names>M</given-names></name><name><surname>Berriman</surname><given-names>M</given-names></name><name><surname>Newbold</surname><given-names>C</given-names></name></person-group><article-title>Iterative Correction of Reference Nucleotides (iCORN) using second generation sequencing technology</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><issue>14</issue><fpage>1704</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq269</pub-id><pub-id pub-id-type="pmid">20562415</pub-id></element-citation></ref><ref id="CR36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paten</surname><given-names>B</given-names></name><name><surname>Novak</surname><given-names>AM</given-names></name><name><surname>Eizenga</surname><given-names>JM</given-names></name><name><surname>Garrison</surname><given-names>E</given-names></name></person-group><article-title>Genome graphs and the evolution of genome inference</article-title><source>Genome Res</source><year>2017</year><volume>27</volume><issue>5</issue><fpage>665</fpage><lpage>76</lpage><pub-id pub-id-type="doi">10.1101/gr.214155.116</pub-id><pub-id pub-id-type="pmid">28360232</pub-id></element-citation></ref><ref id="CR37"><label>37</label><mixed-citation publication-type="other">Pritt J, Chen N, Langmead B. Best human chromosome 9 index with both snvs and indels used in forge study. 2018a. figshare. 10.6084/m9.figshare.7325837.</mixed-citation></ref><ref id="CR38"><label>38</label><mixed-citation publication-type="other">Pritt J, Chen N, Langmead B. Best human chromosome 9 index with snvs used in forge study. 2018b. figshare. 10.6084/m9.figshare.7325831.</mixed-citation></ref><ref id="CR39"><label>39</label><mixed-citation publication-type="other">Pritt J, Chen N, Langmead B. Best whole-human index with both snvs and indels used in forge study. 2018c. figshare. 10.6084/m9.figshare.7325840.</mixed-citation></ref><ref id="CR40"><label>40</label><mixed-citation publication-type="other">Pritt J, Chen N, Langmead B. Forge software. 2018d. Zenodo. 10.5281/zenodo.1482926.</mixed-citation></ref><ref id="CR41"><label>41</label><mixed-citation publication-type="other">Pritt J, Chen N, Langmead B. Recommended whole-human hisat2 index including top 10% of variants according to <italic>Pop Cov</italic>+ model. 2018e. figshare. 10.6084/m9.figshare.7327016.</mixed-citation></ref><ref id="CR42"><label>42</label><mixed-citation publication-type="other">Pritt J, Chen N, Langmead B. Software for forge study experiments. 2018f. Zenodo. 10.5281/zenodo.1482928.</mixed-citation></ref><ref id="CR43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Satya</surname><given-names>RV</given-names></name><name><surname>Zavaljevski</surname><given-names>N</given-names></name><name><surname>Reifman</surname><given-names>J</given-names></name></person-group><article-title>A new strategy to reduce allelic bias in RNA-Seq readmapping</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><issue>16</issue><fpage>e127</fpage><pub-id pub-id-type="doi">10.1093/nar/gks425</pub-id><pub-id pub-id-type="pmid">22584625</pub-id></element-citation></ref><ref id="CR44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneeberger</surname><given-names>K</given-names></name><name><surname>Hagmann</surname><given-names>J</given-names></name><name><surname>Ossowski</surname><given-names>S</given-names></name><name><surname>Warthmann</surname><given-names>N</given-names></name><name><surname>Gesing</surname><given-names>S</given-names></name><name><surname>Kohlbacher</surname><given-names>O</given-names></name><name><surname>Weigel</surname><given-names>D</given-names></name></person-group><article-title>Simultaneous alignment of short reads against multiple genomes</article-title><source>Genome Biol</source><year>2009</year><volume>10</volume><issue>9</issue><fpage>R98</fpage><pub-id pub-id-type="doi">10.1186/gb-2009-10-9-r98</pub-id><pub-id pub-id-type="pmid">19761611</pub-id></element-citation></ref><ref id="CR45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seo</surname><given-names>JS</given-names></name><name><surname>Rhie</surname><given-names>A</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>S</given-names></name><name><surname>Sohn</surname><given-names>MH</given-names></name><name><surname>Kim</surname><given-names>CU</given-names></name><name><surname>Hastie</surname><given-names>A</given-names></name><name><surname>Cao</surname><given-names>H</given-names></name><name><surname>Yun</surname><given-names>JY</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Kuk</surname><given-names>J</given-names></name><name><surname>Park</surname><given-names>GH</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Ryu</surname><given-names>H</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Roh</surname><given-names>M</given-names></name><name><surname>Baek</surname><given-names>J</given-names></name><name><surname>Hunkapiller</surname><given-names>MW</given-names></name><name><surname>Korlach</surname><given-names>J</given-names></name><name><surname>Shin</surname><given-names>JY</given-names></name><name><surname>Kim</surname><given-names>C</given-names></name></person-group><article-title>De novo assembly and phasing of a Korean human genome</article-title><source>Nature</source><year>2016</year><volume>538</volume><issue>7624</issue><fpage>243</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1038/nature20098</pub-id><pub-id pub-id-type="pmid">27706134</pub-id></element-citation></ref><ref id="CR46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherry</surname><given-names>ST</given-names></name><name><surname>Ward</surname><given-names>MH</given-names></name><name><surname>Kholodov</surname><given-names>M</given-names></name><name><surname>Baker</surname><given-names>J</given-names></name><name><surname>Phan</surname><given-names>L</given-names></name><name><surname>Smigielski</surname><given-names>EM</given-names></name><name><surname>Sirotkin</surname><given-names>K</given-names></name></person-group><article-title>dbSNP: the NCBI database of genetic variation</article-title><source>Nucleic Acids Res</source><year>2001</year><volume>29</volume><issue>1</issue><fpage>308</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1093/nar/29.1.308</pub-id><pub-id pub-id-type="pmid">11125122</pub-id></element-citation></ref><ref id="CR47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>L</given-names></name><name><surname>Guo</surname><given-names>Y</given-names></name><name><surname>Dong</surname><given-names>C</given-names></name><name><surname>Huddleston</surname><given-names>J</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Han</surname><given-names>X</given-names></name><name><surname>Fu</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Li</surname><given-names>N</given-names></name><name><surname>Gong</surname><given-names>S</given-names></name><name><surname>Lintner</surname><given-names>KE</given-names></name><name><surname>Ding</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Hu</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>F</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Lyon</surname><given-names>GJ</given-names></name><name><surname>Guan</surname><given-names>Y</given-names></name><name><surname>Shen</surname><given-names>Y</given-names></name><name><surname>Evgrafov</surname><given-names>OV</given-names></name><name><surname>Knowles</surname><given-names>JA</given-names></name><name><surname>Thibaud-Nissen</surname><given-names>F</given-names></name><name><surname>Schneider</surname><given-names>V</given-names></name><name><surname>Yu</surname><given-names>CY</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name><name><surname>So</surname><given-names>KF</given-names></name><name><surname>Wang</surname><given-names>K</given-names></name></person-group><article-title>Long-read sequencing and de novo assembly of a Chinese genome</article-title><source>Nat Commun</source><year>2016</year><volume>7</volume><fpage>12065</fpage><pub-id pub-id-type="doi">10.1038/ncomms12065</pub-id><pub-id pub-id-type="pmid">27356984</pub-id></element-citation></ref><ref id="CR48"><label>48</label><mixed-citation publication-type="other">Sir&#233;n J. Indexing variation graphs. In: 2017 Proceedings of the Ninteenth Workshop on Algorithm Engineering and Experiments (ALENEX). SIAM: 2017. p. 13&#8211;27.</mixed-citation></ref><ref id="CR49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sir&#233;n</surname><given-names>J</given-names></name><name><surname>V&#228;lim&#228;ki</surname><given-names>N</given-names></name><name><surname>M&#228;kinen</surname><given-names>V</given-names></name></person-group><article-title>Indexing graphs for path queries with applications in genome research</article-title><source>IEEE/ACM Trans Comput Biol Bioinforma</source><year>2014</year><volume>11</volume><issue>2</issue><fpage>375</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1109/TCBB.2013.2297101</pub-id></element-citation></ref><ref id="CR50"><label>50</label><mixed-citation publication-type="other">The Computational Pan-Genomics Consortium. Computational pan-genomics: status, promises and challenges. Brief Bioinformatics. 2016.</mixed-citation></ref><ref id="CR51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thorvaldsdottir</surname><given-names>H</given-names></name><name><surname>Robinson</surname><given-names>JT</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name></person-group><article-title>Integrative Genomics Viewer (IGV): high-performance genomics data visualization and exploration</article-title><source>Brief Bioinformatics</source><year>2013</year><volume>14</volume><issue>2</issue><fpage>178</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1093/bib/bbs017</pub-id><pub-id pub-id-type="pmid">22517427</pub-id></element-citation></ref><ref id="CR52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walter</surname><given-names>KEA</given-names></name></person-group><article-title>The UK10K project identifies rare variants in health and disease</article-title><source>Nature</source><year>2015</year><volume>526</volume><issue>7571</issue><fpage>82</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1038/nature14962</pub-id><pub-id pub-id-type="pmid">26367797</pub-id></element-citation></ref></ref-list></back></article>