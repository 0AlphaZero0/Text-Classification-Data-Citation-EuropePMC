<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?properties manuscript?><?ManuscriptPrefix new?><?iso-abbr Nat. Methods?><?submitter-system ukmss?><?submitter-canonical-name Nature Publishing Group?><?submitter-canonical-id NATURE-STRUCTUR?><?submitter-userid 1005?><?submitter-authority publisher?><?submitter-login NPG?><?submitter-name Nature Publishing Group?><?domain wtpa?><?origin ukpmcpa?><front><journal-meta><journal-id journal-id-type="nlm-journal-id">101215604</journal-id><journal-id journal-id-type="pubmed-jr-id">32338</journal-id><journal-id journal-id-type="nlm-ta">Nat Methods</journal-id><journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id><journal-title-group><journal-title>Nature methods</journal-title></journal-title-group><issn pub-type="ppub">1548-7091</issn><issn pub-type="epub">1548-7105</issn></journal-meta><article-meta><article-id pub-id-type="pmcid">5376499</article-id><article-id pub-id-type="pmid">28263961</article-id><article-id pub-id-type="doi">10.1038/nmeth.4220</article-id><article-id pub-id-type="manuscript">ems71488</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Power Analysis of Single Cell RNA-Sequencing Experiments</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Svensson</surname><given-names>Valentine</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Natarajan</surname><given-names>Kedar Nath</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Ly</surname><given-names>Lam-Ha</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Miragaia</surname><given-names>Ricardo J</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A5">5</xref></contrib><contrib contrib-type="author"><name><surname>Labalette</surname><given-names>Charlotte</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Macaulay</surname><given-names>Iain C</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Cvejic</surname><given-names>Ana</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Teichmann</surname><given-names>Sarah A</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib></contrib-group><aff id="A1"><label>1</label>European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Trust Genome Campus, Hinxton, Cambridge, UK</aff><aff id="A2"><label>2</label>Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Hinxton, Cambridge, UK</aff><aff id="A3"><label>3</label>Wellcome Trust &#8211; Medical Research Council Cambridge Stem Cell Institute, Cambridge, UK</aff><aff id="A4"><label>4</label>Department of Haematology, University of Cambridge, Cambridge, UK</aff><aff id="A5"><label>5</label>Centre of Biological Engineering, University of Minho, Campus de Gualtar, Braga, Portugal</aff><author-notes><corresp id="CR1">Correspondence should be addressed to VS (<email>vale@ebi.ac.uk</email>) or SAT (<email>st9@sanger.ac.uk</email>).</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>20</day><month>2</month><year>2017</year></pub-date><pub-date pub-type="epub"><day>06</day><month>3</month><year>2017</year></pub-date><pub-date pub-type="ppub"><month>4</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>06</day><month>9</month><year>2017</year></pub-date><volume>14</volume><issue>4</issue><fpage>381</fpage><lpage>387</lpage><!--elocation-id from pubmed: 10.1038/nmeth.4220--><permissions><license><license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p></license></permissions><abstract><p id="P1">Single cell RNA sequencing (scRNA-seq) has become an established and powerful method to investigate transcriptomic cell-to-cell variation, revealing new cell types, and providing insights into developmental processes and transcriptional stochasticity. The array of published scRNA-seq protocols allow one to sequence transcriptomes from minute amounts of starting material. A key question is how these various protocols compare in terms of sensitivity of detection of mRNA molecules, and accuracy of quantification of expression. Here, we present an assessment of sensitivity and accuracy of many published data sets by spike-in standards with uniform data processing, including development of a flexible Unique Molecular Identifier (UMI) counting tool (<ext-link ext-link-type="uri" xlink:href="https://github.com/vals/umis">https://github.com/vals/umis</ext-link>). We computationally compare 15 protocols, and experimentally assess 4 protocols on batch-matched cell populations, as well as investigating the impact of spike-in molecule degradation on two types of spike-ins. Our analysis provides an integrated framework for comparing different scRNA-seq protocols.</p></abstract></article-meta></front><body><sec sec-type="intro" id="S1"><title>Introduction</title><p id="P2">Recently, there has been an explosion in the development of protocols for RNA-sequencing of individual cells (scRNA-seq)<xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R2" ref-type="bibr">2</xref>, with different approaches to capture cells, amplify cDNA, minimise biases, and utilise liquid handling platforms. Due to the tiny amount of starting material, considerable amplification is an integral step of all of these protocols. Consequently, it is important to assess the sensitivity and accuracy of the protocols in terms of numbers of RNA molecules detected. An objective strategy to assess the technical variability in these methods is to add exogenous spike-in RNA of known abundances to the individual cell samples. In previous studies, biological features were compared on a limited number of protocols to assess performance<xref rid="R3" ref-type="bibr">3</xref>,<xref rid="R4" ref-type="bibr">4</xref>. In this study, we assessed the performance of a large number of published scRNA-seq protocols according to their ability to quantify the expression of spike-ins of known concentrations. An ideal protocol is both sensitive and accurate, as well as cost effective, where cost is at least partially reflected in sequencing depth.</p><p id="P3">We define sensitivity of a method as the minimum number of input RNA molecules required for a spike-in to be detected as expressed, and accuracy as the closeness of estimated relative abundances to ground truth (<italic>a priori</italic> known abundances of input molecules). High sensitivity permits detection of very lowly expressed genes, while high accuracy implies that detected expression variations reflect true biological differences in mRNA abundance across cells, rather than technical factors.</p><p id="P4">The standardized ERCC (External RNA Controls Consortium)<xref rid="R5" ref-type="bibr">5</xref> spike-in collections consist of a set of 92 RNA molecule species of varying lengths and GC contents, mixed at known concentrations, and represent 22 abundance levels that are spaced one fold change apart from each other (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 1</xref>). Previously, such spike-ins have been applied to assess standard RNA-sequencing protocol reproducibility<xref rid="R6" ref-type="bibr">6</xref> and performance of differential expression tests in RNA-sequencing data<xref rid="R7" ref-type="bibr">7</xref>. In the context of single cell RNA-sequencing protocols, ERCC spike-ins were first published as part of the description of the CEL-seq protocol<xref rid="R8" ref-type="bibr">8</xref>.</p><p id="P5">Here, we exploit spike-ins as a means to calculate technical sensitivity and accuracy of different scRNA-seq protocol across various platforms in a comparable manner, independent of the biological cell type investigated (<xref ref-type="fig" rid="F1">Figure 1A-B</xref>). Leveraging the known number of input spike-in molecules allows calculation of the lower molecular detection limit of each sample in each experiment (<xref ref-type="fig" rid="F1">Figure 1C</xref>). By comparing to overall sequencing depth, we ascertain sensitivity of the protocols. The spike-ins also provide a direct way to assess accuracy by comparing <italic>a priori</italic> input concentration to the measured expression levels by sequencing (<xref ref-type="fig" rid="F1">Figure 1D</xref>). Thus we obtain a unified framework for comparing sensitivities and accuracies of the various protocols at different sequencing depths.</p><p id="P6">Our analysis leveraging spike-in information from published datasets is subject to limitations (explored in depth in the <xref ref-type="sec" rid="S12">Discussions</xref>). We rely on accurate reporting of spike-in volumes and dilution by original authors, and have reconfirmed in few cases (personal communication). In addition, spike-in molecules may not truly reflect endogenous mRNA capture efficiency in scRNA-seq owing to deviation from natural mRNA sequence features such as shorter polyA tails and mRNA binding proteins. Nevertheless, the scale and number of different protocols and platforms with published spike-in data provide a rich resource for mining their comparative performance. In our comprehensive analysis, most protocols are replicated across at least two different cell types and different laboratories (<xref ref-type="supplementary-material" rid="SD4">Supplementary Table 1</xref>). This reduces potential bias due to a specific cell type or study.</p></sec><sec sec-type="results" id="S2"><title>Results</title><p id="P7">We retrieved and analyzed published scRNA-seq data sets that used ERCC spike-ins for quality control or normalization, and compared both <italic>sensitivity</italic> and <italic>accuracy</italic> performance metrics. Our analysis spans 15 distinct experimental protocols encompassing 28 single-cell studies, including 17 studies with traditional whole-transcript coverage based strategy for measuring expression levels and 11 that used strategies based on UMI&#8217;s for digital quantification of transcripts (<xref ref-type="supplementary-material" rid="SD4">Supplementary Table 1</xref>). We additionally performed 4 different scRNA-seq protocols across 3 platforms using dedicated batch-matched mouse embryonic stem cells (mESC) across two replicates, leveraging both ERCC and Spike-in RNA Variant (SIRV) spike-ins. We performed SMARTer and Smart-Seq2 protocols in the first replicate, and performed SMARTer, Smart-Seq2 and STRT-Seq in the second replicate on the Fluidigm C1 platform. We also include a high throughput droplet based 10X Genomics Chromium dataset using ERCC spike-ins and Human Brain Total RNA. All coverage-based datasets have been sequenced using Illumina paired-end sequencing, with read lengths between 75 and 150 base pairs. In total, our analysis consists of 18,123 publicly available samples of 30x10<sup>9</sup> sequencing reads.</p><p id="P8">For each data set, the concentration of spike-ins was noted either through the original study or by personal communication with the original authors, including relevant dilution and volumes (<xref ref-type="supplementary-material" rid="SD4">Supplementary Table 1</xref>). This allowed us to calculate the absolute number of spike-in RNA molecules at different abundance levels across individual cell samples. Thus, permitting comparison of the different experimental data sets on the same scale.</p><sec id="S3"><title>Technical accuracy of quantification of different scRNA-seq protocols</title><p id="P9">To effectively assess the accuracy of quantification by different protocols, we first used 92 ERCC spike-in RNAs spanning 22 abundance levels with two-fold difference between each level. The Pearson correlation between estimated expression levels and actual input RNA molecule concentration (ground truth) provides a direct measure for quantifying accuracy (<xref ref-type="fig" rid="F1">Figure 1D</xref>). We computed the Pearson product-moment correlation coefficient (<italic>R</italic>) between log transformed values for estimated expression and input concentration for each individual cell (or sample) and compared these values across all protocols (<xref ref-type="fig" rid="F2">Figure 2A</xref>).</p><p id="P10">The accuracy of conventional bulk RNA-sequencing is higher than scRNA-seq protocols. Remarkably, the accuracy of scRNA-seq protocols is still high, and rarely do individual samples have a Pearson correlation lower than 0.6. The lower accuracy and variable Pearson correlations for individual cells (samples) within protocols (GnT-Seq, CEL-Seq, MARS-Seq), might be indicative of variable success rates of protocols.</p></sec><sec id="S4"><title>Technical sensitivity of different scRNA-seq protocols</title><p id="P11">To investigate the technical sensitivity of each sample and quantify inter-sample variability, we devise a logistic regression model for detection, with detection of expression as the dependant variable. Our measure of sensitivity is the molecular spike-in input level where probability of detection reaches 50% (<xref ref-type="fig" rid="F1">Figure 1C</xref>). This allows us to measure sensitivity of each sample individually for every protocol investigated, avoiding biases due to uneven batch sizes. Our approach avoids using detected spike-ins ratios at each abundance level which would give poor resolution, because at most seven spike-ins share one abundance level.</p><p id="P12">Applying logistic regression to all samples, we observe that scRNA-seq protocols are more sensitive than bulk RNA-sequencing and can detect very low numbers of input molecules (<xref ref-type="fig" rid="F2">Figure 2B</xref>). The sensitivity of scRNA-seq protocols varied over four orders of magnitude, and several protocols have the potential to detect as little as single digit input spike-in molecules (SMARTer (C1), CEL-Seq2 (C1), STRT-Seq, and inDrop). We observe high within-protocol variability of sensitivity for protocols. This can be attributed to sequencing depth, which we quantify in a section below to rank the protocols.</p></sec><sec id="S5"><title>UMI efficiency of tag-counting protocols</title><p id="P13">The majority of single cell RNA-sequencing protocols utilise a UMI-tag counting strategy to achieve digital quantification of mRNA transcripts. In this strategy, a single tag from a single mRNA molecule is reverse transcribed, and an additional probabilistically unique random identifier sequence is added. These protocols create cDNA libraries with extremely low complexity, which may lead to extreme amplification biases. The UMI on each tag should allow one to remove these biases, as it is added prior to amplification<xref rid="R9" ref-type="bibr">9</xref>. The question then remains as to how <italic>efficient</italic> the entire scRNA-seq process is.</p><p id="P14">If <italic>E</italic> is the <italic>UMI (counting) efficiency</italic>, the underlying assumption is that the number of UMIs of a gene <italic>U</italic> = <italic>E</italic>&#183;<italic>M</italic>, where 0 &lt; <italic>E</italic> &lt; 1 (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2A</xref>) and <italic>M</italic> is the number of RNA molecules of a gene. We fitted this model for every UMI-tag sample and stratified the results across different protocols (<xref ref-type="fig" rid="F2">Figure 2C</xref>). The results recapitulate the logistic regression based measure for sensitivity, as samples with high efficiency have a low molecule detection limit (with the exception of MARS-Seq data, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2B</xref>).</p><p id="P15">However, more in depth analysis shows this measure might not be as appropriate as it appears. If we extend the model to be <italic>U = E&#183;M<sup>c</sup></italic>, the best fit should give values of the <italic>molecular exponent c</italic> close to 1, if the underlying UMI counting assumption is correct. Instead, we find that the best fit is systematically lower than 1, with a mode of around 0.8 (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2C</xref>). This implies a saturation of UMI counts as a function of input molecules. This can be explained partially (but not fully) by differences in UMI length between the different protocols (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2D</xref>). For example, UMIs with length of 4 base pairs can only count up to 256 unique molecules, and have on average a molecular exponent of 0.6. However, even in protocols with longer UMI&#8217;s of 10 base pairs (which can count over a million unique molecules), the molecular exponent is still 0.8 per sample on average, and rarely reaches 1.</p><p id="P16">In conclusion, while UMIs should provide a way of removing amplification biases, the assumed absolute quantification does not seem to hold perfectly.</p></sec><sec id="S6"><title>Endogenous transcripts are more efficiently captured than ERCC spike-ins</title><p id="P17">It is unclear to what extent the sensitivity and accuracy calculated based on exogenous spike-ins corresponds to the same metrics for endogenous mRNA. On the one hand, ERCC spike-ins have shorter poly(A) tails than typical mRNA from mammalian cells<xref rid="R10" ref-type="bibr">10</xref>, making them harder to capture by poly(T) priming. On the other hand, endogenous mRNA have intricate secondary structures and can be bound to proteins, potentially reducing the efficiency of reverse transcription.</p><p id="P18">To investigate the relationship between scRNA-seq measurements of endogenous mRNA and ERCC spike-ins, we analysed single molecule fluorescent in-situ hybridization (smFISH) data and CEL-seq data from the same mESC line and culture conditions<xref rid="R11" ref-type="bibr">11</xref> (molecule counts from personal communication). Based on smFISH data for 9 endogenous genes, CEL-Seq UMI counts correspond to 5-10% of smFISH counts. This clearly contrasts with the ERCC spike-ins in the same samples, where the average UMI counts correspond to 0.5-1% of input molecule counts (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2E</xref>).</p><p id="P19">This data suggests that endogenous RNA is much more efficiently captured and amplified than ERCC spike-in molecules. Overall, this comparison implies that our sensitivity estimates are conservative, and are likely to underestimate rather than overestimate. The accuracy metric is based on relative abundances, and is not affected by this. This difference in efficiency is important to consider if absolute molecule counts are to be inferred based on ERCC spike-ins.</p></sec><sec id="S7"><title>Sensitivity is more dependent on sequencing depth than accuracy</title><p id="P20">The results of the per-sample accuracy and sensitivity analysis shows a large amount of within-protocol heterogeneity (<xref ref-type="fig" rid="F2">Figure 2A-B</xref>). Seeking to explain performance by technical factors, we find a relation with sequencing depth per sample. This becomes especially relevant from a cost perspective for scRNA-seq experiments, since researchers can control read depth to fit their budgets and needs. We used a linear model that considers a global effect of sequencing depth, including diminishing returns (see <xref ref-type="sec" rid="S17">Online Methods</xref>). The model includes an individual corrected performance parameter for each protocol, which allows protocols to be ranked while accounting for the substantial technical factor of sequencing depth.</p><p id="P21">We find that accuracy does not strongly depend on sequencing depth, supporting the theory that heterogeneity of accuracy within a protocol relates to the general reliability of a protocol (<xref ref-type="fig" rid="F3">Figure 3A</xref>). We found that the best performing protocols in terms of accuracy are SUPeR-Seq (<italic>R</italic>=0.95), the only total-RNA protocol for single cells to date, and CEL-Seq2 (<italic>R</italic>=0.94), which uses In Vitro Transcription (IVT) rather than PCR to amplify cDNA.</p><p id="P22">Since the model considers diminishing returns on the sequencing depth, we can identify when the performance metrics saturate from the model parameters. We find that accuracy becomes saturated at a depth as low as 250,000 reads, illustrating that it is not strongly dependent on sequencing depth.This also suggests that for detected mRNAs in scRNA-seq, the expression levels are generally accurate and quantitatively meaningful.</p><p id="P23">We find that the technical sensitivity is critically dependent on sequencing depth, and sensitivity comparisons without accounting for differences in depth would be misleading (<xref ref-type="fig" rid="F3">Figure 3B</xref>). The sensitivity parameter of the model accounts for sequencing depth to allow for fair comparison, and we used this to rank protocols. The three protocols implemented in a C1 microfluidics system (CEL-Seq2 (C1), STRT-Seq (C1), and SMARTer (C1); number of molecules at a million reads,#<italic>M</italic> = 2,3,and4respectively) were the top performing protocols in terms of molecule detection. The matched microwell plate implementation of CEL-Seq2 has poorer sensitivity than the C1 implementation (#<italic>M</italic> = 13).</p><p id="P24">Based on the model, we find that sensitivity saturates at about 4.5 million reads per sample. The increase in read depth from 1 million reads to 4.5 million reads per sample results in marginally increased sensitivity; less than a fold change. However the increase from 100,000 reads to 1 million reads per sample results in increased sensitivity of an order of magnitude. Thus, we recommend considering 1 million reads per sample as a good target for saturated gene detection.</p><p id="P25">It should be noted that not all studies need to saturate detection, especially in cases where the genes of interest are highly expressed. It is equally important to note that sequencing depth is a technical feature, and the number of genes detected depend on the depth. Therefore, sequencing depth must be taken into account when performing and computationally analyzing scRNA-seq, even for compositional expression units such as TPM (Transcripts Per Million).</p></sec><sec id="S8"><title>Degradation of spike-ins does not explain performance variation between experiments</title><p id="P26">The analyzed performance metrics of the scRNA-seq protocols inherently assumes the gold standard annotation of the spike-ins to be correct. However, due to the labile nature of RNA, it can get degraded during the course of normal reagent handling. To quantify the impact of degradation, we subjected spike-in molecules (both ERCCs and SIRVs) to repeated freeze-thaw cycles (<xref ref-type="sec" rid="S17">Online Methods</xref>). Additionally, as a measure of complete/full degradation, we left the spike-ins either at room temperature or at 37&#176;C overnight. The freeze-thaw cycles emulate normal handling and comparing these to our in-house protocols, we observed that accuracy metric had an overall small effect and was similar between protocols (<xref ref-type="fig" rid="F4">Figure 4A</xref>).</p><p id="P27">The degradation of spike-ins directly affected the spike-in dilution in a sample, which is a central factor for calculating the technical sensitivity. We observed that normal handling accounts for molecule limit differences within an order of magnitude, even when spike-ins are subjected to as many as six freeze-thaw cycles. The sensitivity metric for samples subjected to conditions as extreme as overnight degradation (room temperature or 37&#176;C) had two orders of magnitude difference compared to other samples, similar to the difference between protocols (<xref ref-type="fig" rid="F4">Figure 4A</xref>).</p></sec><sec id="S9"><title>SIRV spike-ins recapitulate accuracy results based on ERCC spike-ins</title><p id="P28">All the studies mentioned above are based on the ERCC spike-ins, which have bacterial sequence composition. To ensure that our conclusions are generally applicable to spike-ins, we also analysed an alternative spike-in set: the SIRV spike-in mix consisting of 69 artificial transcripts that are produced to mimic the splicing patterns of 7 human genes and allow RNA isoform assessment. The SIRV mix E2 contains these isoforms across four abundance levels. To assess the accuracy between ERCC and SIRV spike-ins, we performed two matched scRNA-seq comparisons (Smart-seq2, SMARTer and STRT-seq on C1 system) using mESCs with both ERCC and SIRV spike-ins.</p><p id="P29">We focused on a comparison of accuracies using both sets of spike-ins, as SIRVs only span four abundance levels and are not compatible with sensitivity analysis (<xref ref-type="fig" rid="F4">Figure 4B</xref>). We observe that accuracy is systematically lower when using SIRVs. This is expected, since the ambiguous read assignment to the isoforms introduces a noise element. Overall, we observed a similar pattern of relative accuracy based on SIRV&#8217;s and ERCC&#8217;s between our SMARTer and Smart-Seq2 experiments. The STRT-Seq samples had very poor accuracy, as expected since the 5&#8217; transcript tags alone cannot distinguish between different mRNA isoforms.</p><p id="P30">This experiment provides quantitative evidence that mRNA splice form variation can be inferred at the single cell level using the appropriate protocol. Comparing the protocols, accuracy calculated based on SIRV&#8217;s recapitulates accuracy based on ERCC&#8217;s, indicating that spike-in batch variability does not in general explain differences between protocols.</p></sec><sec id="S10"><title>Endogenous mRNA amount does not affect performance metrics based on spike-ins</title><p id="P31">Typically, when generating a cDNA library for sequencing, material is created from both endogenous mRNA and spike-in RNA. If the amount of mRNA is higher, we are less likely to sample cDNA fragments from spike-ins during sequencing. To verify that discrepancy in endogenous mRNA levels (due to e.g. cell type differences) does not affect the performance metrics, we investigated published data where information on empty (spike-in RNA alone) and non-empty (mRNA and spike-ins present) samples, was provided for the same batch of cells. We compared accuracy and sensitivity between empty and non-empty samples from three different studies and found equivalent results, confirming that endogenous mRNA content does not affect the performance metrics (<xref ref-type="fig" rid="F4">Figure 4C</xref>). We quantified the equivalence using 95% Confidence Interval (CI) based equivalence analysis<xref rid="R12" ref-type="bibr">12</xref> (<xref ref-type="sec" rid="S17">Online Methods</xref>). We found that empty median CI is 100% contained within the non-empty median CI for accuracy, and 84% for sensitivity.</p></sec><sec id="S11"><title>Impact of freeze-thaw cycles on spike-in abundance</title><p id="P32">Repeated freeze-thaw cycles degrade RNA, and we set out to quantify the RNA degradation rates from our freeze-thaw experiment. In our investigation of spike-in degradation after repeated freeze-thaw cycles, we added single mESCs to individual wells and performed the Smart-seq2 scRNA-seq protocol. We compared the spike-in content to the endogenous mRNA content within each well, and related this to the number of freeze-thaw cycles.</p><p id="P33">We made a predictive Bayesian model of mRNA degradation (see <xref ref-type="sec" rid="S17">Online Methods</xref>) with a degradation rate parameter <italic>p</italic>. Sampling from the posterior distribution of <italic>p</italic> when applying the model to ERCC spike-ins, we found a degradation rate of 19&#177;0.7% per freeze-thaw cycle (95% CI, <xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 3</xref>). We also applied the mRNA degradation model to SIRV&#8217;s, and found a degradation rate of 18.5&#177;0.1%, which recapitulates ERCC degradation rates. However the SIRVs measurements were more noisy, likely due to mapping uncertainty (Also mentioned in <xref ref-type="sec" rid="S12">Discussion</xref>). The posterior predictions for both ERCC and SIRV degradation are shown in <xref ref-type="fig" rid="F4">Figure 4D</xref>. Overall, our data approximates a 20% degradation rate of spike-ins in each freeze-thaw cycle during normal sample handling.</p><p id="P34">While we did not observe a large variation in molecular detection limit or accuracy due to normal handling, the relative abundance of spike-ins in a sampling is strongly affected by freeze-thaw cycles. This means inference of total mRNA in cells based on spike-ins might prove challenging. As we also found that the degradation rate was conserved between ERCC and SIRV spike-ins, the approximately 20% degradation rate per freeze-thaw cycle may hold for RNA in general.</p></sec></sec><sec sec-type="discussion" id="S12"><title>Discussion</title><p id="P35">A previous study showed<xref rid="R13" ref-type="bibr">13</xref> that read alignment to ERCC spike-ins varies widely between libraries and platforms, with some spike-ins having reproducibly poor behavior. This raises the question of suitability of spike-ins for calibration of absolute expression values. The ERCC spike-ins have short poly-A tails ranging from 20 to 26 bases long (the majority are 24 bases) in comparison to eukaryotic mRNAs of 250 base long poly-A tails<xref rid="R10" ref-type="bibr">10</xref>. This suggests that poly-T priming of ERCC spike-ins might be less efficient than for endogenous mRNA, possibly making all protocols seem less sensitive than they actually are for endogenous mRNAs. Furthermore, the ERCC spike-ins are not capped at the 5&#8217; end, which may further lead to reduced template switching efficiency (used in several protocols) as compared to endogenous mRNAs<xref rid="R14" ref-type="bibr">14</xref>. Lastly, unlike endogenous mRNAs, spike-in RNA are not naturally bound by mRNA-binding proteins or have secondary structures.</p><p id="P36">To assess these trade-offs between the spike-in and endogenous RNA, we compared smFISH values (gold standard for absolute mRNA quantification per cell) to the calculated number of spike-in molecules per cell (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figure 2E</xref>). This comparison also suggests more efficient capture and amplification of endogenous RNA than spike-ins by about one order of magnitude, and lower sensitivity of protocols than actual. Therefore, it is important to highlight that the &#8220;spike-in molecule detection limit&#8221; is used only a relative sensitivity measure to rank protocols, and not in absolute terms. For example, the ability to detect 10 spike-in molecules might correspond to a greater sensitivity for endogenous mRNAs. Nevertheless, the global ranking of the protocols remains relevant. The accuracy metric remains unaffected by these issues, as all ERCC spike-ins within a sample are equally affected.</p><p id="P37">A perfect protocol comparison would be between multiple laboratories implementing each protocol using a single stock of reagents and mRNA dilutions ladders as standards. Having many different scientists carrying out each protocol would allow one to exclude a skill effect on the performance. A control ladder of mRNA would eliminate issues arising from differences between synthetic spike-ins and mRNA. While the majority of the protocols we have investigated here have been reproduced by at least two distinct laboratories (<xref ref-type="supplementary-material" rid="SD4">Supplementary Table 1</xref>), we cannot completely rule out the impact of technical proficiency on the protocol performance.</p><p id="P38">We showed that handling and batch variations in ERCC dilutions leads to smaller variations in performance than we see between protocols (<xref ref-type="fig" rid="F4">Figure 4A</xref>). Nevertheless, one needs to be aware that in certain published experiments, spike-ins may have been greatly degraded with an impact on our performance metrics.</p><p id="P39">These caveats are important when considering the performance metrics of accuracy and sensitivity in our study. Our comparison and assessment is performed on the currently available data across protocols and their performances. A protocol showing poor performance in our comparison does not restrict its suitability and it is indeed possible to get better performance for the same protocol. Our study is the first to provide a detailed comparison across the large number of currently available scRNA-seq protocols.</p><p id="P40">The different scRNA-seq protocols analyzed provide tremendously powerful and high resolution techniques for unbiased genome-wide dissection of cell populations and their transcriptional regulation. In summary, we show that while these protocols vary widely in their detection sensitivity, with lower limits between 1 and 1,000 molecules per cell, their accuracy in quantification of gene expression is generally high.</p><p id="P41">While sensitivity critically depends on sequencing depth, this is less critical for accuracy. However, both sensitivity and accuracy are closely dependent on the scRNA-seq protocol used to generate the data. The protocols with high sensitivity are more suitable for analysis of lowly expressed genes, while for other applications, this might be less relevant. The protocols with lower detection limit also allow additional insights into more subtle gene expression differences affecting individual cell states.</p><p id="P42">Overall, our comparison suggests that miniaturized reaction volumes in scRNA-seq protocols increases sensitivity and provides a good return on investment when sequencing around a million reads per sample. Future improvements of protocols and decreases in the price of sequencing will further boost our ability to answer new questions in biology using single cell transcriptomics.</p></sec><sec id="S13"><title>Accession codes</title><sec id="S14"><title>Primary accessions</title><p id="P43"><bold>ArrayExpress</bold></p><list list-type="bullet" id="L1"><list-item><p id="P44">E-MTAB-5480</p></list-item><list-item><p id="P45">E-MTAB-5481</p></list-item><list-item><p id="P46">E-MTAB-5482</p></list-item><list-item><p id="P47">E-MTAB-5483</p></list-item><list-item><p id="P48">E-MTAB-5484</p></list-item><list-item><p id="P49">E-MTAB-5485</p></list-item><list-item><p id="P50">E-MTAB-5486</p></list-item></list></sec><sec id="S15"><title>Referenced accessions</title><p id="P51"><bold>Gene Expression Omnibus</bold></p><list list-type="bullet" id="L2"><list-item><p id="P52"><bold>GSE53334</bold><xref rid="R15" ref-type="bibr">15</xref></p></list-item><list-item><p id="P53"><bold>GSE65785</bold><xref rid="R16" ref-type="bibr">16</xref></p></list-item><list-item><p id="P54"><bold>GSE67833</bold><xref rid="R17" ref-type="bibr">17</xref></p></list-item><list-item><p id="P55"><bold>GSE53386</bold><xref rid="R18" ref-type="bibr">18</xref></p></list-item><list-item><p id="P56"><bold>GSE71318</bold><xref rid="R19" ref-type="bibr">19</xref></p></list-item><list-item><p id="P57"><bold>GSE46980</bold><xref rid="R9" ref-type="bibr">9</xref></p></list-item><list-item><p id="P58"><bold>GSE60361</bold><xref rid="R20" ref-type="bibr">20</xref></p></list-item><list-item><p id="P59"><bold>GSE60768</bold><xref rid="R21" ref-type="bibr">21</xref></p></list-item><list-item><p id="P60"><bold>GSE54695</bold><xref rid="R11" ref-type="bibr">11</xref></p></list-item><list-item><p id="P61"><bold>GSE78779</bold><xref rid="R22" ref-type="bibr">22</xref></p></list-item><list-item><p id="P62"><bold>GSE54006</bold><xref rid="R23" ref-type="bibr">23</xref></p></list-item><list-item><p id="P63"><bold>GSE72857</bold><xref rid="R24" ref-type="bibr">24</xref></p></list-item><list-item><p id="P64"><bold>GSE63473</bold><xref rid="R25" ref-type="bibr">25</xref></p></list-item><list-item><p id="P65"><bold>GSE65525</bold><xref rid="R26" ref-type="bibr">26</xref></p></list-item></list><p id="P66"><bold>European Genome-phenome Archive</bold></p><list list-type="bullet" id="L3"><list-item><p id="P67"><bold>EGAS00001001204</bold><xref rid="R27" ref-type="bibr">27</xref></p></list-item></list><p id="P68"><bold>European Nucleotide Archive</bold></p><list list-type="bullet" id="L4"><list-item><p id="P69"><bold>ERP010108</bold><xref rid="R27" ref-type="bibr">27</xref></p></list-item><list-item><p id="P70"><bold>ERP005640</bold><xref rid="R28" ref-type="bibr">28</xref></p></list-item><list-item><p id="P71"><bold>ERP006670</bold><xref rid="R29" ref-type="bibr">29</xref></p></list-item><list-item><p id="P72"><bold>ERP010952</bold><xref rid="R30" ref-type="bibr">30</xref></p></list-item><list-item><p id="P73"><bold>ERP013160</bold><xref rid="R27" ref-type="bibr">27</xref></p></list-item></list><p id="P74"><bold>Sequence Read Archiva</bold></p><list list-type="bullet" id="L5"><list-item><p id="P75"><bold>SRP030617</bold><xref rid="R3" ref-type="bibr">3</xref></p></list-item><list-item><p id="P76"><bold>SRP041736</bold><xref rid="R31" ref-type="bibr">31</xref></p></list-item><list-item><p id="P77"><bold>SRP033209</bold><xref rid="R32" ref-type="bibr">32</xref></p></list-item><list-item><p id="P78"><bold>SRP055153</bold><xref rid="R33" ref-type="bibr">33</xref></p></list-item><list-item><p id="P79"><bold>SRP045422</bold><xref rid="R34" ref-type="bibr">34</xref></p></list-item><list-item><p id="P80"><bold>SRP047290</bold><xref rid="R35" ref-type="bibr">35</xref></p></list-item><list-item><p id="P81"><bold>SRP025171</bold><xref rid="R36" ref-type="bibr">36</xref></p></list-item><list-item><p id="P82"><bold>SRP050499</bold><xref rid="R37" ref-type="bibr">37</xref></p></list-item><list-item><p id="P83"><bold>SRP073767</bold><xref rid="R38" ref-type="bibr">38</xref></p></list-item></list><p id="P84"><bold>ArrayExpress</bold></p><list list-type="bullet" id="L6"><list-item><p id="P85"><bold>E-MTAB-3346</bold><xref rid="R39" ref-type="bibr">39</xref></p></list-item><list-item><p id="P86"><bold>E-MTAB-3624</bold><xref rid="R39" ref-type="bibr">39</xref></p></list-item></list></sec></sec><sec id="S16"><title>Data Availability</title><p id="P87">All data used in this study have been deposited at ArrayExpress, and summary tables are provided as supplementary files.</p></sec><sec sec-type="methods" id="S17" specific-use="web-only"><title>Online Methods</title><sec id="S18"><title>Mouse embryonic stem (mES) cells culture</title><p id="P88">Wildtype E14 mouse ES cells (kindly provided by Pentao Liu, Wellcome Trust Sanger Institute) were cultured on gelatin coated dishes using Knockout DMEM (#10829; Gibco), 15% Fetal Calf Serum (FB-1001/500; batch tested from Labtech), 1x Penicillin-Streptomycin-Glutamine (#10378-016; Gibco), 1x MEM NEAA (11140-035; Gibco), 2-mercaptoethanol (31350-010; Gibco) and 1000U Leukemia Inhibitory Factor (LIF; #ESG1107). Mycoplasma-free tested mESC were passaged every 2-3 days.</p></sec><sec id="S19"><title>SMARTer, Smart-Seq2 and STRT-Seq on C1</title><p id="P89">E14 mESCs were trypsinized to obtain single cell suspension and passed through 30&#181;m filter (CellTrics; #04-0042-2316). Cells were processed using the C1 Single Cell Auto Prep System (Fluidigm; #100-7000 and #100-6209) following the manufacturers protocol (#100-5950 B1). Briefly, we perform SMARTer, Smart-seq2 and STRT-Seq each across three small C1 Open App IFCs (5-10&#181;m; #100- 5759). The specific sample preparation steps for the three protocols (SMARTer<xref rid="R3" ref-type="bibr">3</xref>,<xref rid="R28" ref-type="bibr">28</xref>,<xref rid="R29" ref-type="bibr">29</xref>,<xref rid="R31" ref-type="bibr">31</xref>,<xref rid="R32" ref-type="bibr">32</xref>, Smart-seq2<xref rid="R40" ref-type="bibr">40</xref> and STRT-Seq<xref rid="R9" ref-type="bibr">9</xref>,<xref rid="R11" ref-type="bibr">11</xref>,<xref rid="R20" ref-type="bibr">20</xref>,<xref rid="R23" ref-type="bibr">23</xref>) were downloaded from Fluidigm Script Hub. Dissociated single cells were loaded and captured on C1 Open App IFCs, followed by manual inspection to demarcate empty well, doublets or debris containing wells. Two different spike-in RNA control sets were used for batch-matched comparison of different protocols, 92 ERCC spike-ins (#4456740; Lot# 1411014; Ambion) and 69 SIRV spike-ins (#SKU025.03; E2 Spike-in RNA Variant Control Mixes; Lexogen), were mixed (0.5&#181;l 1:500 diluted ERCCs + 0.6&#181;l 1:500 diluted SIRVs) and added to respective lysis buffer master mixes for SMARTer (20&#956;l), Smart-Seq2 (27&#956;l) and STRT-seq (20&#956;l). 9&#956;l of the respective lysis master mix is added to each Open App C1 IFCs. The subsequent steps (cell lysis, cDNA synthesis by reverse transcription and PCR reaction) are performed as described on Fluidigm Script Hub.</p></sec><sec id="S20"><title>SMARTer and Smart-Seq2 on C1</title><p id="P90">E14 mESCs were trypsinized to obtain single cell suspension and passed through 30&#181;m filter (CellTrics; #04-0042-2316). Single cell suspension was processed using SMARTer and Smart-seq2 in parallel across two C1 Single Cell Auto Prep System (Fluidigm; #100-7000 and #100-6209) following the manufacturer's protocol (#100-5950 B1). Smart-seq2 protocol was downloaded from Fluidigm Script Hub. The cells were loaded, captured on C1 Open App IFCs, followed by manually inspection. Both ERCC and SIRV spike-ins were mixed (0.5&#181;l 1:500 diluted ERCCs + 0.6&#181;l 1:500 diluted SIRVs) and added to respective Lysis buffer master mixes for SMARTer (20&#956;l) and Smart-Seq2 (27&#956;l). The subsequent steps (cell lysis, cDNA synthesis by reverse transcription and PCR reaction) are performed as described on Fluidigm Script Hub.</p></sec><sec id="S21"><title>Spike-in degradation experiment using Smart-Seq2 on plates</title><p id="P91">We used new tube of Spike-ins, ERCC (#4456740; Lot# 1412014; Ambion) and SIRV (E2 mix; #SKU025.03; Lot#216651530; Lexogen) for this experiment. Briefly, 1:100 dilutions of ERCCs and SIRVs were mixed together resulting in spike-in master mix (1:200 final dilution; termed &#8216;x2 Freeze-thaw&#8217;). The spike-in master mix was split between three tubes; one left overnight at 37&#176;C (Condition 1), one left overnight at room temperature (Condition 2) and third kept overnight at -80&#176;C. The following day the third tube (from -80&#176;C) was subjected to multiple freeze-thaw cycle wherein the tube was thawed at room temperature for 2-5minutes, an aliquot was taken and re-freezed in dry ice. We repeated this freeze-thaw cycle an additional 5 times (Condition 3 to Condition 7). All the spike-in mixes (Condition 1-7) were subsequently diluted to a final 1:1000,000 dilution. A 96-well plate for Smart-seq2 was prepared by dispensing 2 &#956;l Smart-Seq2 lysis buffer (0.2%Triton, 1:20 RNAse inhibitor, 10mM Oligo-dT<sub>30</sub>VN, 10mM dNTPs) across each well. 1&#956;l of spike-in mix per condition (Condition 1-7) was added to each well column-wise such that each column represented a single condition with 8 replicate wells. E14 mESCs were filtered through a 30&#956;m filter and FACS sorted (BD Influx; BD Biosciences) into 96-well plate. The first three wells (row-wise) across the 96-well plate received matched bulk 500, 50 and 5 cells, and all other wells received a single cell. The 96-well plate was immediately spun and frozen on dry-ice prior to Smart-seq2 protocol as previously described<xref rid="R40" ref-type="bibr">40</xref>.</p></sec><sec id="S22"><title>Library preparation and Sequencing</title><p id="P92">Representative cDNA from single cells across three C1 runs and Smart-Seq2 (on plates) were assessed using High Sensitivity DNA chips for Bioanalyzer (5067-4626 and 5067-4627; Agilent Technologies). Single cell cDNA from SMARTer<xref rid="R3" ref-type="bibr">3</xref>,<xref rid="R28" ref-type="bibr">28</xref>,<xref rid="R29" ref-type="bibr">29</xref>,<xref rid="R31" ref-type="bibr">31</xref>,<xref rid="R32" ref-type="bibr">32</xref> and Smart-Seq2 C1 IFCs and Smart-seq2 (on plates) was tagmented and pooled to make libraries using Illumina Nextera XT DNA sample preparation kit (Illumina; FC-131-1096) with 96 dual barcoded indices (Illumina; FC-131-1002). The library clean-up and sample pooling was performed using AMPure XP beads (Agencourt Biosciences; A63880). All protocols are described in the Fluidigm protocol (100-5950), Fluidigm Script Hub and Smart-seq2 protocol<xref rid="R40" ref-type="bibr">40</xref>. The STRT-Seq libraries were made and sequenced at Karolinska Institutet as previously described<xref rid="R9" ref-type="bibr">9</xref>,<xref rid="R20" ref-type="bibr">20</xref>. The Single cell libraries from SMARTer and Smart-Seq2 C1 IFCs and Smart-seq2 (on plates) was sequenced across 1 lane of HiSeq V4 (Illumina) using 75bp/125bp paired-end sequencing.</p></sec><sec id="S23"><title>10x Genomics Chromium experiment</title><p id="P93">The Single Cell Gel Bead kit (#120217), Single cell chip kit (#120219) and Single cell library kit (#120218) were used along with 10x GemCode Single Cell Instrument as per manufacturer specifications and manuals (Document # CG00011; Revision B). Equal volumes of control brain RNA (3&#956;l; FirstChoice Human Brain Total RNA; #AM7962) and ERCC spikes (3&#956;l 1:4 dilution; #4456653) were mixed to form a &#8216;2x Control RNA+ERCC&#8217; master mix. We further diluted this to &#8216;1x Control RNA+ERCC&#8217; with PCR grade water. We made two single cell master mix preparation using 3&#956;l of &#8216;2x Control RNA+ERCC&#8217; and &#8216;1x Control RNA+ERCC&#8217; respectively instead of single cell suspension (adjusted with 34.4 &#956;l Nuclease-Free water). The remaining protocol was followed as per manufacturer's manual (Document # CG00011; Revision B). Each 10x library was sequenced across HiSeq2500 (2x lanes; Rapid Run) as per Wellcome Trust Sanger Institute sequencing guidelines.</p></sec><sec id="S24"><title>Data Sources</title><p id="P94">Raw read data from published studies was downloaded from either ENA or SRA, as listed with accession numbers in <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 1</xref>. Information regarding concentration and volume of ERCC mix in each sample was gathered from the original publications (also indicated in <xref ref-type="supplementary-material" rid="SD4">Supplementary Table 1</xref>) or through direct communication with authors in ambiguous cases.</p><p id="P95">The expression table for mESC-STRT had non-standard names annotating the ERCC spike-ins, and through personal communication with the authors we were given a table for converting these to the names as provided by Life Technologies. Additionally we were informed by the authors that the final spike-in dilution noted as 1:50000 in Islam et al<xref rid="R9" ref-type="bibr">9</xref> had actually been 1:20000.</p><p id="P96">The concentrations of the ERCC solution in the Dendritic-MARS table was ambiguous as there were two different values in the GEO table and in the text of the paper. Communication with the authors clarified that these referred to different volumes. The volume and dilution described in the GEO table was used. Thirty samples were excluded as they were annotated as not having had ERCC spike-ins added to them.</p><p id="P97">For the K562-SMART data it was unclear which data sets had used spike-ins, and personal communication with the authors provided the names of the two batches which had spike-ins added.</p><p id="P98">A table with notes on individual data sets is provided (<xref ref-type="supplementary-material" rid="SD4">Supplementary Table 1</xref>).</p></sec><sec id="S25"><title>RNA-Seq data processing</title><p id="P99">For coverage based data, relative abundances were quantified using Salmon<xref rid="R41" ref-type="bibr">41</xref> 0.6.0, with library type parameter -l IU and the optional flag --biasCorrect. The Salmon transcriptome indices were built by adding ERCC sequences to cDNA sequences from Ensembl. For samples with mouse background, this was Ensembl 83 cDNA annotation of GRCm38.p4. For samples with human background, this was cDNA annotation from Ensembl 78 of GRCh38, and for samples with zebrafish background, the Ensembl 77 annotation of Zv9. Finally, for samples with frog background, this was Ensembl 84 annotation of JGI4.2.</p><p id="P100">In order to process all UMI-based data in a coherent way, we developed a quantification strategy based on pseudo-mapping, and counting up evidence for (transcript, UMI) pairs.</p><p id="P101">The principle is to transfer information from a (UMI, tag) pair to a (transcript, UMI) pair based on which transcript the tag maps to. Since UMI-based methods only use 3&#8217; or 5&#8217; end tags of cDNA, which can be as short as 25bp, mapping of these tags are commonly ambiguous. Our strategy for this is to weight a (UMI, tag) pair by the number of transcripts the tag maps to. After (UMI, tag) pairs were mapped with either RapMap<xref rid="R42" ref-type="bibr">42</xref> or Kallisto<xref rid="R43" ref-type="bibr">43</xref> in pseudobam mode, only (transcript, UMI) pairs with a user specified minimum amount of evidence are counted (default 1). This can be either on the gene or transcript level. In the 10x Genomics Chromium data we detected 70,000 and 45,000 droplets with respect to the samples. For the sake of computational memory efficiency we uniformly sampled 2000 droplets out of all detected droplets to count the umi tags per droplet.</p></sec><sec id="S26"><title>Code Availability</title><p id="P102">We implemented the UMI counting strategy in a publicly available command line tool which we call &#8216;umis&#8217;. The tool as available at <ext-link ext-link-type="uri" xlink:href="https://github.com/vals/umis/">https://github.com/vals/umis/</ext-link> as well as in the Python Package Index, and in Bioconda. Version 0.3.0, used for this paper, is submitted as <xref ref-type="supplementary-material" rid="SD3">Supplementary Software</xref>.</p></sec><sec id="S27"><title>Analysis</title><p id="P103">An ERCC spike-in was considered detected when the estimated TPM of that ERCC was greater than zero. For UMI-based data, a spike-in is detected when at least one copy of an ERCC molecule is inferred.</p><p id="P104">The amount of input spike-in molecules for each spike, for each sample, in each experiment was calculated from the final concentration of ERCC spike-in mix in the sample.</p><p id="P105">Calculation of the accuracy of an individual sample was done by the Pearson correlation between input concentration of the spike-ins and the measured expression values. If less than 8 spike-ins were observed, the accuracy was set to infinity, as we consider this to be insufficient evidence to estimate the accuracy.</p><p id="P106">For the logistic regression model of each sample&#8217;s detection limit, the probability of detecting a spike-in at a given input level is modeled by the logistic function: <disp-formula id="FD1"><mml:math display="block" id="M1" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#8722;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>&#8901;</mml:mo><mml:mtext mathvariant="italic">log</mml:mtext><mml:mo>&#8289;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>&#8714;</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P107">We used the LogisticRegression class from the linear_model module of the machine learning package scikit-learn<xref rid="R44" ref-type="bibr">44</xref>. The fit was performed with the liblinear solver and the optional argument fit_intercept=True. The logistic regression analysis was limited to samples with at least eight spike-ins detected. The detection limit was chosen as the molecular abundance where the logistic regression model passes 50% detection probability: <disp-formula id="FD2"><mml:math display="block" id="M2" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.3em"/><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P108">To investigate the UMI efficiency of UMI based protocols, we used a linear model where the only parameter was the efficiency: <disp-formula id="FD3"><mml:math display="block" id="M3" overflow="scroll"><mml:mrow><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>&#8901;</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>&#8714;</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P109">As we mention in the text though, the data fits a model much better where there is a non-one exponent parameter on the number of input molecules: <disp-formula id="FD4"><mml:math display="block" id="M4" overflow="scroll"><mml:mrow><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>&#8901;</mml:mo><mml:mrow><mml:msup><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>c</mml:mi></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mi>&#8714;</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P110">When we model the relation between read depth and performance metrics for individual protocols, we use a linear model with a quadratic term for read depth to capture diminishing returns on investment. The model considers the read depth effect to be global, and has a categorical performance parameter for each protocol: <disp-formula id="FD5"><mml:math display="block" id="M5" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#8901;</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="italic">log</mml:mtext></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>&#8901;</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="italic">log</mml:mtext></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>&#8714;</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P111">Here the performance metric will plateau and saturate when <disp-formula id="FD6"><mml:math display="block" id="M6" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="italic">log</mml:mtext></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>&#8722;</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P112">The linear models were fitted and analysed using the OLS regression function in the statsmodels Python package.</p><p id="P113">In the spike-in degradation model the degradation rate p and the cellular fraction F were inferred by a Bayesian approach using Stan<xref rid="R45" ref-type="bibr">45</xref> (R package rstan v 2.10.1). The model was specified as the following: p was sampled from a uniform distribution between 0 and 1, F<sub>i</sub> for each spike-in i was drawn from a normal distribution with mean 0.5 and standard deviation 1. F<sub>ij</sub> was estimated by a normal distribution with mean F<sub>i</sub> *(1-p)<sup>j</sup>, where j was the j-th freeze-thaw cycle and standard deviation sigma sampled from a uniform distribution between 0 and 20. The model was run with 5000 iteration steps, 1000 warm up steps and 4 chains.</p><p id="P114">Confidence intervals with regard to accuracy and sensitivity for non-empty and empty wells were estimated by bootstrapping. Therefore, study SRP055153, ERP010952 and SRP070989 were pooled together separating non-empty and empty wells, respectively. For each group, sample sizes of 20 were randomly picked with replacement and median of the bootstrapped samples was determined. This process was repeated with a number of 1,000 iterations. Having sorted the bootstrapped estimates, we determined the median and the 2.5th and 97.5th percentiles of the distributions for non-empty and empty wells. All data needed for our analysis is provided as <xref ref-type="supplementary-material" rid="SD5">Supplementary Table 2</xref>.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Supplementary Figures</label><media xlink:href="NIHMS71488-supplement-Supplementary_Figures.docx" mimetype="application" mime-subtype="octet-stream" orientation="portrait" xlink:type="simple" id="d36e1340" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>Supplementary Information</label><media xlink:href="NIHMS71488-supplement-Supplementary_Information.doc" mimetype="application" mime-subtype="msword" orientation="portrait" xlink:type="simple" id="d36e1344" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>Supplementary Software</label><media xlink:href="NIHMS71488-supplement-Supplementary_Software.zip" mimetype="application" mime-subtype="zip" orientation="portrait" xlink:type="simple" id="d36e1348" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD4"><label>Supplementary Table 1</label><media xlink:href="NIHMS71488-supplement-Supplementary_Table_1.xlsx" mimetype="application" mime-subtype="octet-stream" orientation="portrait" xlink:type="simple" id="d36e1352" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD5"><label>Supplementary Table 2</label><media xlink:href="NIHMS71488-supplement-Supplementary_Table_2.csv" mimetype="text" mime-subtype="x-comma-separated-values" orientation="portrait" xlink:type="simple" id="d36e1356" position="anchor"/></supplementary-material></sec></body><back><ack id="S28"><title>Acknowledgements</title><p>We are grateful to O Stegle and J K Kim for helpful discussions and comments on the manuscript. We thank M Lynch for support with the C1 experiments, X Chen for spike-in discussions and M Quail for help with 10x Chromium experiments. We extend our gratitude to S Linnarsson and A Zeisel for invaluable support in implementing STRT-Seq in our lab and help with sequencing the STRT-library. We also thank D Grun for sharing smFISH molecule counts. Finally we thank R Kirchner for many improvements to the umis tool. The study was supported by Cancer Research UK grant number C45041/A14953 to A Cvejic and C Labalette, European Research Council project 677501 - ZF_Blood to A Cvejic and a core support grant from the Wellcome Trust and MRC to the Wellcome Trust &#8211; Medical Research Council Cambridge Stem Cell Institute. The ERC grant ThSWITCH to S A Teichmann (grant no. 260507) and a Lister Institute Research Prize to S A Teichmann. K N Natarajan was supported by the Wellcome Trust Strategic Award &#8220;Single cell genomics of mouse gastrulation&#8221;.</p></ack><fn-group><fn fn-type="con" id="FN1"><p id="P115"><bold>Author Contributions</bold></p><p id="P116">VS and SAT conceived the study. VS and LL annotated and processed all data. VS conceived and implemented the umis tool. VS conceived and performed the performance modeling of the data. VS, RJM, and KNN. designed the in-house experiments. KNN optimised and implemented the protocols. The degradation experiments were designed by VS, ICM, RJM, and KNN, who performed the experiments. IM and CL performed zebrafish experiments under the supervision of AC. VS and LL designed the degradation model, and LL implemented the model. VS, KNN, and SAT wrote the manuscript.</p></fn><fn fn-type="COI-statement" id="FN2"><p id="P117"><bold>Competing financial interests</bold></p><p id="P118">The authors declare no competing financial interests.</p></fn></fn-group><ref-list><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macaulay</surname><given-names>IC</given-names></name><name><surname>Voet</surname><given-names>T</given-names></name></person-group><article-title>Single cell genomics: advances and future perspectives</article-title><source>PLoS Genet</source><year>2014</year><volume>10</volume><fpage>e1004126</fpage><pub-id pub-id-type="pmid">24497842</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Teichmann</surname><given-names>SA</given-names></name><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>Computational and analytical challenges in single-cell transcriptomics</article-title><source>Nat Rev Genet</source><year>2015</year><volume>16</volume><fpage>133</fpage><lpage>145</lpage><pub-id pub-id-type="pmid">25628217</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>AR</given-names></name><etal/></person-group><article-title>Quantitative assessment of single-cell RNA-sequencing methods</article-title><source>Nat Methods</source><year>2014</year><volume>11</volume><fpage>41</fpage><lpage>46</lpage><pub-id pub-id-type="pmid">24141493</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziegenhain</surname><given-names>C</given-names></name><etal/></person-group><article-title>Comparative analysis of single-cell RNA sequencing methods</article-title><source>bioRxiv</source><year>2016</year><fpage>035758</fpage><pub-id pub-id-type="doi">10.1101/035758</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><collab>External RNA Controls Consortium</collab><article-title>Proposed methods for testing and selecting the ERCC external RNA controls</article-title><source>BMC Genomics</source><year>2005</year><volume>6</volume><fpage>150</fpage><pub-id pub-id-type="pmid">16266432</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>L</given-names></name><etal/></person-group><article-title>Synthetic spike-in standards for RNA-seq experiments</article-title><source>Genome Res</source><year>2011</year><volume>21</volume><fpage>1543</fpage><lpage>1551</lpage><pub-id pub-id-type="pmid">21816910</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Munro</surname><given-names>SA</given-names></name><etal/></person-group><article-title>Assessing technical performance in differential gene expression experiments with external spike-in RNA control ratio mixtures</article-title><source>Nat Commun</source><year>2014</year><volume>5</volume><fpage>5125</fpage><pub-id pub-id-type="pmid">25254650</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hashimshony</surname><given-names>T</given-names></name><name><surname>Wagner</surname><given-names>F</given-names></name><name><surname>Sher</surname><given-names>N</given-names></name><name><surname>Yanai</surname><given-names>I</given-names></name></person-group><article-title>CEL-Seq: single-cell RNA-Seq by multiplexed linear amplification</article-title><source>Cell Rep</source><year>2012</year><volume>2</volume><fpage>666</fpage><lpage>673</lpage><pub-id pub-id-type="pmid">22939981</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Islam</surname><given-names>S</given-names></name><etal/></person-group><article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title><source>Nat Methods</source><year>2014</year><volume>11</volume><fpage>163</fpage><lpage>166</lpage><pub-id pub-id-type="pmid">24363023</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Viphakone</surname><given-names>N</given-names></name><name><surname>Voisinet-Hakil</surname><given-names>F</given-names></name><name><surname>Minvielle-Sebastia</surname><given-names>L</given-names></name></person-group><article-title>Molecular dissection of mRNA poly(A) tail length control in yeast</article-title><source>Nucleic Acids Res</source><year>2008</year><volume>36</volume><fpage>2418</fpage><lpage>2433</lpage><pub-id pub-id-type="pmid">18304944</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gr&#252;n</surname><given-names>D</given-names></name><name><surname>Kester</surname><given-names>L</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><article-title>Validation of noise models for single-cell transcriptomics</article-title><source>Nat Methods</source><year>2014</year><volume>11</volume><fpage>637</fpage><lpage>640</lpage><pub-id pub-id-type="pmid">24747814</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walker</surname><given-names>E</given-names></name><name><surname>Nowacki</surname><given-names>AS</given-names></name></person-group><article-title>Understanding equivalence and noninferiority testing</article-title><source>J Gen Intern Med</source><year>2011</year><volume>26</volume><fpage>192</fpage><lpage>196</lpage><pub-id pub-id-type="pmid">20857339</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><collab>SEQC/MAQC-III Consortium</collab><article-title>A comprehensive assessment of RNA-seq accuracy, reproducibility and information content by the Sequencing Quality Control Consortium</article-title><source>Nat Biotechnol</source><year>2014</year><volume>32</volume><fpage>903</fpage><lpage>914</lpage><pub-id pub-id-type="pmid">25150838</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kapteyn</surname><given-names>J</given-names></name><name><surname>He</surname><given-names>R</given-names></name><name><surname>McDowell</surname><given-names>ET</given-names></name><name><surname>Gang</surname><given-names>DR</given-names></name></person-group><article-title>Incorporation of non-natural nucleotides into template-switching oligonucleotides reduces background and improves cDNA synthesis from very small RNA samples</article-title><source>BMC Genomics</source><year>2010</year><volume>11</volume><fpage>413</fpage><pub-id pub-id-type="pmid">20598146</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ferreira</surname><given-names>T</given-names></name><etal/></person-group><article-title>Silencing of odorant receptor genes by G protein &#946;&#947; signaling ensures the expression of one odorant receptor per olfactory sensory neuron</article-title><source>Neuron</source><year>2014</year><volume>81</volume><fpage>847</fpage><lpage>859</lpage><pub-id pub-id-type="pmid">24559675</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Owens</surname><given-names>NDL</given-names></name><etal/></person-group><article-title>Measuring Absolute RNA Copy Numbers at High Temporal Resolution Reveals Transcriptome Kinetics in Development</article-title><source>Cell Rep</source><year>2016</year><volume>14</volume><fpage>632</fpage><lpage>647</lpage><pub-id pub-id-type="pmid">26774488</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Llorens-Bobadilla</surname><given-names>E</given-names></name><etal/></person-group><article-title>Single-Cell Transcriptomics Reveals a Population of Dormant Neural Stem Cells that Become Activated upon Brain Injury</article-title><source>Cell Stem Cell</source><year>2015</year><volume>17</volume><fpage>329</fpage><lpage>340</lpage><pub-id pub-id-type="pmid">26235341</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fan</surname><given-names>X</given-names></name><etal/></person-group><article-title>Single-cell RNA-seq transcriptome analysis of linear and circular RNAs in mouse preimplantation embryos</article-title><source>Genome Biol</source><year>2015</year><volume>16</volume><fpage>148</fpage><pub-id pub-id-type="pmid">26201400</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dang</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Tracing the expression of circular RNAs in human pre-implantation embryos</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><fpage>130</fpage><pub-id pub-id-type="pmid">27315811</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zeisel</surname><given-names>A</given-names></name><etal/></person-group><article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title><source>Science</source><year>2015</year><volume>347</volume><fpage>1138</fpage><lpage>1142</lpage><pub-id pub-id-type="pmid">25700174</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Velten</surname><given-names>L</given-names></name><etal/></person-group><article-title>Single-cell polyadenylation site mapping reveals 3&#8217; isoform choice variability</article-title><source>Mol Syst Biol</source><year>2015</year><volume>11</volume><fpage>812</fpage><pub-id pub-id-type="pmid">26040288</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hashimshony</surname><given-names>T</given-names></name><etal/></person-group><article-title>CEL-Seq2: sensitive highly-multiplexed single-cell RNA-Seq</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><fpage>77</fpage><pub-id pub-id-type="pmid">27121950</pub-id></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaitin</surname><given-names>DA</given-names></name><etal/></person-group><article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of tissues into cell types</article-title><source>Science</source><year>2014</year><volume>343</volume><fpage>776</fpage><lpage>779</lpage><pub-id pub-id-type="pmid">24531970</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paul</surname><given-names>F</given-names></name><etal/></person-group><article-title>Transcriptional Heterogeneity and Lineage Commitment in Myeloid Progenitors</article-title><source>Cell</source><year>2015</year><volume>163</volume><fpage>1663</fpage><lpage>1677</lpage><pub-id pub-id-type="pmid">26627738</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macosko</surname><given-names>EZ</given-names></name><etal/></person-group><article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title><source>Cell</source><year>2015</year><volume>161</volume><fpage>1202</fpage><lpage>1214</lpage><pub-id pub-id-type="pmid">26000488</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>AM</given-names></name><etal/></person-group><article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title><source>Cell</source><year>2015</year><volume>161</volume><fpage>1187</fpage><lpage>1201</lpage><pub-id pub-id-type="pmid">26000487</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Macaulay</surname><given-names>IC</given-names></name><etal/></person-group><article-title>G&amp;T-seq: parallel sequencing of single-cell genomes and transcriptomes</article-title><source>Nat Methods</source><year>2015</year><volume>12</volume><fpage>519</fpage><lpage>522</lpage><pub-id pub-id-type="pmid">25915121</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahata</surname><given-names>B</given-names></name><etal/></person-group><article-title>Single-cell RNA sequencing reveals T helper cells synthesizing steroids de novo to contribute to immune homeostasis</article-title><source>Cell Rep</source><year>2014</year><volume>7</volume><fpage>1130</fpage><lpage>1142</lpage><pub-id pub-id-type="pmid">24813893</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buettner</surname><given-names>F</given-names></name><etal/></person-group><article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title><source>Nat Biotechnol</source><year>2015</year><pub-id pub-id-type="doi">10.1038/nbt.3102</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scialdone</surname><given-names>A</given-names></name><etal/></person-group><article-title>Computational assignment of cell-cycle stage from single-cell transcriptome data</article-title><source>Methods</source><year>2015</year><volume>85</volume><fpage>54</fpage><lpage>61</lpage><pub-id pub-id-type="pmid">26142758</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollen</surname><given-names>AA</given-names></name><etal/></person-group><article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title><source>Nat Biotechnol</source><year>2014</year><volume>32</volume><fpage>1053</fpage><lpage>1058</lpage><pub-id pub-id-type="pmid">25086649</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treutlein</surname><given-names>B</given-names></name><etal/></person-group><article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title><source>Nature</source><year>2014</year><volume>509</volume><fpage>371</fpage><lpage>375</lpage><pub-id pub-id-type="pmid">24739965</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Padovan-Merhar</surname><given-names>O</given-names></name><etal/></person-group><article-title>Single mammalian cells compensate for differences in cellular volume and DNA copy number through independent global transcriptional mechanisms</article-title><source>Mol Cell</source><year>2015</year><volume>58</volume><fpage>339</fpage><lpage>352</lpage><pub-id pub-id-type="pmid">25866248</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sansom</surname><given-names>SN</given-names></name><etal/></person-group><article-title>Population and single-cell genomics reveal the Aire dependency, relief from Polycomb silencing, and distribution of self-antigen expression in thymic epithelia</article-title><source>Genome Res</source><year>2014</year><volume>24</volume><fpage>1918</fpage><lpage>1931</lpage><pub-id pub-id-type="pmid">25224068</pub-id></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>NK</given-names></name><etal/></person-group><article-title>Combined Single-Cell Functional and Gene Expression Analysis Resolves Heterogeneity within Stem Cell Populations</article-title><source>Cell Stem Cell</source><year>2015</year><volume>16</volume><fpage>712</fpage><lpage>724</lpage><pub-id pub-id-type="pmid">26004780</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Streets</surname><given-names>AM</given-names></name><etal/></person-group><article-title>Microfluidic single-cell whole-transcriptome sequencing</article-title><source>Proc Natl Acad Sci U S A</source><year>2014</year><volume>111</volume><fpage>7048</fpage><lpage>7053</lpage><pub-id pub-id-type="pmid">24782542</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>F</given-names></name><etal/></person-group><article-title>The Transcriptome and DNA Methylome Landscapes of Human Primordial Germ Cells</article-title><source>Cell</source><year>2015</year><volume>161</volume><fpage>1437</fpage><lpage>1452</lpage><pub-id pub-id-type="pmid">26046443</pub-id></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>GXY</given-names></name><etal/></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title><source>bioRxiv</source><year>2016</year><fpage>065912</fpage><pub-id pub-id-type="doi">10.1101/065912</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brennecke</surname><given-names>P</given-names></name><etal/></person-group><article-title>Single-cell transcriptome analysis reveals coordinated ectopic gene-expression patterns in medullary thymic epithelial cells</article-title><source>Nat Immunol</source><year>2015</year><volume>16</volume><fpage>933</fpage><lpage>941</lpage><pub-id pub-id-type="pmid">26237553</pub-id></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picelli</surname><given-names>S</given-names></name><etal/></person-group><article-title>Smart-seq2 for sensitive full-length transcriptome profiling in single cells</article-title><source>Nat Methods</source><year>2013</year><volume>10</volume><fpage>1096</fpage><lpage>1098</lpage><pub-id pub-id-type="pmid">24056875</pub-id></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patro</surname><given-names>R</given-names></name><name><surname>Duggal</surname><given-names>G</given-names></name><name><surname>Kingsford</surname><given-names>C</given-names></name></person-group><article-title>Salmon: Accurate, Versatile and Ultrafast Quantification from RNA-seq Data using Lightweight-Alignment</article-title><source>bioRxiv</source><year>2015</year><fpage>021592</fpage><pub-id pub-id-type="doi">10.1101/021592</pub-id></element-citation></ref><ref id="R42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srivastava</surname><given-names>A</given-names></name><name><surname>Sarkar</surname><given-names>H</given-names></name><name><surname>Gupta</surname><given-names>N</given-names></name><name><surname>Patro</surname><given-names>R</given-names></name></person-group><article-title>RapMap: a rapid, sensitive and accurate tool for mapping RNA-seq reads to transcriptomes</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><fpage>i192</fpage><lpage>i200</lpage><pub-id pub-id-type="pmid">27307617</pub-id></element-citation></ref><ref id="R43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bray</surname><given-names>NL</given-names></name><name><surname>Pimentel</surname><given-names>H</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name></person-group><article-title>Near-optimal probabilistic RNA-seq quantification</article-title><source>Nat Biotechnol</source><year>2016</year><volume>34</volume><fpage>525</fpage><lpage>527</lpage><pub-id pub-id-type="pmid">27043002</pub-id></element-citation></ref><ref id="R44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>Varoquaux</surname><given-names>G</given-names></name><name><surname>Gramfort</surname><given-names>A</given-names></name><name><surname>Michel</surname><given-names>V</given-names></name><name><surname>Thirion</surname><given-names>B</given-names></name><name><surname>Grisel</surname><given-names>O</given-names></name><name><surname>Blondel</surname><given-names>M</given-names></name><name><surname>Prettenhofer</surname><given-names>P</given-names></name><name><surname>Weiss</surname><given-names>R</given-names></name><name><surname>Dubourg</surname><given-names>V</given-names></name><name><surname>Vanderplas</surname><given-names>J</given-names></name><etal/></person-group><article-title>Scikit-learn: Machine Learning in Python</article-title><source>Journal of Machine Learning Research</source><year>2011</year><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="R45"><label>45</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carpenter</surname><given-names>B</given-names></name><name><surname>Gelman</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name><name><surname>Goodrich</surname><given-names>B</given-names></name></person-group><article-title>Stan: A probabilistic programming language</article-title><source>J Stat Softw</source><year>2016</year></element-citation></ref></ref-list></back><floats-group><fig id="F1" orientation="portrait" position="float"><label>Figure 1</label><caption><title>Illustration of protocol comparison strategy.</title><p><bold>(A)</bold> Schematic illustration highlighting our spike-in comparison strategy of public data sets. <bold>(B)</bold> The different protocols are compared based on the same standard spike-in molecules and not the endogenous mRNA from the diverse cell types used in these studies. We define two global technical performance metrics based on spike-ins: <bold>(C)</bold> Sensitivity: the number of input spike-in molecules at the point where the probability of detection reaches 50%. <bold>(D)</bold> Accuracy: the Pearson product-moment correlation (<italic>R</italic>) between estimated expression levels and actual input RNA molecule concentration (ground truth).</p></caption><graphic xlink:href="emss-71488-f001"/></fig><fig id="F2" orientation="portrait" position="float"><label>Figure 2</label><caption><title>Comparison of performance metrics for different protocols.</title><p><bold>(A) Accuracy.</bold> Distributions of Pearson correlations (<italic>R</italic>) of all samples stratified by protocol investigated (without accounting for sequencing depth). <bold>(B) Sensitivity.</bold> Distributions of molecule detection limits of all samples stratified by protocol (without accounting for sequencing depth). The number of samples (n) is highlighted above the protocols. The implementation platforms and quantification strategies are indicated below the protocols. <bold>(C) UMI Efficiency.</bold> Distributions of UMI counting efficiencies in UMI-tag counting based samples, stratified by protocols. For the analysed UMI based data, the UMI efficiency recapitulates the logistic regression based molecule detection limit.</p></caption><graphic xlink:href="emss-71488-f002"/></fig><fig id="F3" orientation="portrait" position="float"><label>Figure 3</label><caption><title>Performance metrics after accounting for sequencing depth.</title><p>Both accuracy and sensitivity are modeled with a global dependency on sequencing depth considering diminishing returns, with a distinct corrected performance parameter for each protocol. Both models (one for accuracy and one for sensitivity) has 26 parameters, and are fitted to n=20,717 observations (the number of samples). (Bulk data in pink triangles are only displayed for context). Solid curves show the predicted dependence on sequencing depth. <bold>(A)</bold> Accuracy is only marginally dependent on sequencing depth. Saturation occurs at 270,000 reads per cell in the model (dashed red line). Protocol names are ordered by performance based on predicted correlation <italic>R</italic> at 1 million reads. <bold>(B)</bold> Sensitivity is critically dependent on sequencing depth and accounting for read depth is key for fair comparison of protocols. Saturation identified by the model occurs at 4.6 million reads per cell (dashed red line). The gain from 1 to 4 million reads per sample is marginal, while we note that moving from 100,000 reads to 1 millions reads corresponds to an order of magnitude gain in sensitivity (dashed black lines). Protocols are ordered by performance based on predicted detection limit (#<italic>M</italic>, number of molecules at 1 million reads).</p></caption><graphic xlink:href="emss-71488-f003"/></fig><fig id="F4" orientation="portrait" position="float"><label>Figure 4</label><caption><title>Investigation of factors with potential impact on performance metrics.</title><p><bold>(A) Batch effects and RNA degradation</bold>. Performance distributions for three protocols implemented as a single batch, on the Fluidigm C1 platform (left) and on the 10x Chromium (far-left; different batch). Performance distributions of spike-ins measured after freeze-thaw cycles, normal (2-3 cycles) to critical degradation (6 cycles, left overnight at room temperature). <bold>(B) Accuracy estimates across both ERCC and SIRV spike-ins are similar.</bold> Accuracy (Pearson correlation <italic>R</italic>) of both spike-ins (ERCC&#8217;s and SIRV&#8217;s) inferred across two replicates using multiple protocols. <bold>(C) Endogenous mRNA amount does not affect performance metrics</bold>. Comparison of performance metrics between empty (lacking endogenous mRNA) and non-empty samples from 3 published datasets shows similar performance and no bias due to presence of endogenous mRNA. Red dot shows median, and red bar shows 95% confidence interval of median, estimated with bootstraps. Empty accuracy CI is 100% contained in non-empty CI, and empty sensitivity CI is 84% contained in non-empty CI. <bold>(D) Model of relative spike-in abundance degradation during normal handling</bold>. Posterior predictions from Bayesian exponential decay model, for both ERCC&#8217;s and SIRV&#8217;s. The decay parameter was 19% and 18.5%, respectively. Confidence bands correspond to 95% confidence interval from posterior parameter distribution.</p></caption><graphic xlink:href="emss-71488-f004"/></fig></floats-group></article>